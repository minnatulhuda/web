import{r as o,j as e,t as ze}from"./index-D1TsKtu7.js";import{e as Xe}from"./index-DfBlkqaH.js";import{f as De,W as ke,I as C,D as Re,a as j,u as Me,b as qe,c as la,d as ra,e as na}from"./AdminShared-6s04GBeO.js";const Ue="https://api-sekolah-minnatulhuda.halo-minnatulhuda.workers.dev",ne={calendar:()=>e.jsx("svg",{className:"w-5 h-5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),check:()=>e.jsx("svg",{className:"w-3.5 h-3.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})}),trash:()=>e.jsx("svg",{className:"w-4 h-4 text-red-400 hover:text-red-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),edit:()=>e.jsx("svg",{className:"w-4 h-4 text-slate-400 hover:text-blue-500 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),pin:({active:M})=>e.jsx("svg",{className:`w-4 h-4 transition-colors ${M?"text-amber-500 fill-amber-500":"text-slate-300 hover:text-amber-500"}`,viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",fill:"none",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),plus:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),chevronLeft:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),chevronRight:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),chevronDown:({open:M})=>e.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${M?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})}),close:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),userCard:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"})}),copy:()=>e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})}),mapPin:()=>e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),phone:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),mail:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),cake:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 15.546c-.523 0-1.046.151-1.5.454a2.704 2.704 0 01-3 0 2.704 2.704 0 00-3 0 2.704 2.704 0 01-3 0 2.704 2.704 0 00-3 0 2.704 2.704 0 01-3 0 2.701 2.701 0 00-1.5-.454M9 6v2m3-2v2m3-2v2M9 3h.01M12 3h.01M15 3h.01M21 21v-7a2 2 0 00-2-2H5a2 2 0 00-2 2v7h18zm-3-9v-2a2 2 0 00-2-2H8a2 2 0 00-2 2v2h12z"})}),idCard:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"})}),gender:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),key:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),eye:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0zM2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})}),eyeOff:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})},sa=({user:M,language:n,studentProfile:w})=>{var P,he,we,Ce,Fe,Ne,Ae,Ie,pe,Oe,Ye,Ze;const c=(M==null?void 0:M.id)||"GUEST",[E,h]=o.useState([]),[K,q]=o.useState([]),[H,Q]=o.useState([]),[W,Y]=o.useState(!1),[U,te]=o.useState(!1),[F,V]=o.useState(!1),[O,D]=o.useState(!1),[u,A]=o.useState("calendar"),[se,z]=o.useState(null),[p,N]=o.useState(null),[I,_]=o.useState(""),[B,g]=o.useState(new Date),[oe,X]=o.useState(null),[le,m]=o.useState(""),[ae,re]=o.useState(""),[de,ce]=o.useState(""),[b,T]=o.useState(""),[v,ee]=o.useState(""),[ie,me]=o.useState("08:00"),be=l=>{const k=l.toLowerCase();return k==="student"||k==="parrent"||k==="ws"?"Wali Santri":k==="teacher"||k==="gr"?"Pengajar":k==="staff"||k==="st"?"Staff TU":k==="admin"||k==="administrator"||k==="ad"?"Administrator":"Pengunjung"},ue=()=>{navigator.clipboard.writeText(M.id),alert("ID Akun disalin!")},fe=l=>{l.stopPropagation(),w!=null&&w.nisn&&(navigator.clipboard.writeText(w.nisn),alert("NISN disalin!"))},r=l=>{if(!l)return"-";try{return new Date(l).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})}catch{return l}},i=async()=>{if(c!=="GUEST"){Y(!0);try{const[l,k,J]=await Promise.all([fetch(`${Ue}/api/data?type=notes&id=${c}`),fetch(`${Ue}/api/data?type=todolist&id=${c}`),fetch(`${Ue}/api/data?type=calendar&id=${c}`)]),Se=await l.json(),Pe=await k.json(),_e=await J.json();Se.notes&&h(Se.notes),Pe.todolist&&q(Pe.todolist),_e.calendar&&Q(_e.calendar)}catch(l){console.error("Failed to fetch dashboard data",l)}finally{Y(!1)}}},d=async(l,k)=>{try{await fetch(`${Ue}/api/data?type=${l}&id=${c}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({[l]:k,idAccount:c})})}catch(J){console.error(`Failed to save ${l}`,J),alert("Gagal menyimpan data ke server.")}};o.useEffect(()=>{i()},[c]);const L=l=>{const k=l.getFullYear(),J=l.getMonth(),Se=new Date(k,J+1,0).getDate(),Pe=new Date(k,J,1).getDay(),_e=[];for(let Be=0;Be<Pe;Be++)_e.push(null);for(let Be=1;Be<=Se;Be++)_e.push(new Date(k,J,Be));return _e},R=l=>{const k=new Date(B.getFullYear(),B.getMonth()+l,1);g(k)},G=async()=>{if(!oe||!b.trim())return;const l={scheduleId:`SCH-${Date.now()}`,title:b,description:v,time:ie};let k=[...H];const J=k.findIndex(Se=>Se.date===oe);J>=0?k[J].schedule.push(l):k.push({date:oe,schedule:[l]}),Q(k),T(""),ee(""),await d("calendar",k)},ve=async(l,k)=>{let J=H.map(Se=>Se.date===l?{...Se,schedule:Se.schedule.filter(Pe=>Pe.scheduleId!==k)}:Se).filter(Se=>Se.schedule.length>0);Q(J),await d("calendar",J)},xe=async()=>{if(!le.trim()&&!ae.trim())return;let l=[...E];se?(l=l.map(k=>k.noteId===se.noteId?{...k,title:le,content:ae,timestamp:new Date().toISOString()}:k),z(null)):l=[{noteId:`NOTE-${Date.now()}`,timestamp:new Date().toISOString(),title:le.trim()||"Tanpa Judul",content:ae,pinned:!1},...l],h(l),m(""),re(""),await d("notes",l)},je=l=>{z(l),m(l.title),re(l.content)},ye=async l=>{const k=E.filter(J=>J.noteId!==l);h(k),await d("notes",k)},Te=async l=>{const k=E.map(J=>J.noteId===l?{...J,pinned:!J.pinned}:J);h(k),await d("notes",k)},$e=async l=>{if(!de.trim())return;const J=[{todoId:`TODO-${Date.now()}`,timestamp:new Date().toISOString(),title:de,completed:!1,pinned:!1},...K];q(J),ce(""),await d("todolist",J)},t=l=>{N(l.todoId),_(l.title)},S=async l=>{if(!I.trim())return;const k=K.map(J=>J.todoId===l?{...J,title:I}:J);q(k),N(null),await d("todolist",k)},Z=async l=>{const k=K.map(J=>J.todoId===l?{...J,completed:!J.completed}:J);q(k),await d("todolist",k)},a=async l=>{const k=K.filter(J=>J.todoId!==l);q(k),await d("todolist",k)},x=async l=>{const k=K.map(J=>J.todoId===l?{...J,pinned:!J.pinned}:J);q(k),await d("todolist",k)},y=[...E].sort((l,k)=>Number(k.pinned)-Number(l.pinned)),s=[...K].sort((l,k)=>Number(k.pinned)-Number(l.pinned)),$=oe?(l=>{var k;return((k=H.find(J=>J.date===l))==null?void 0:k.schedule)||[]})(oe):[];return e.jsxs("div",{className:"flex flex-col gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl overflow-hidden shadow-lg border border-slate-100 dark:border-slate-800 relative group",children:[e.jsx("div",{className:"h-28 bg-gradient-to-r from-emerald-600 to-teal-700 relative overflow-hidden",children:e.jsx("div",{className:"absolute -bottom-10 -right-10 w-40 h-40 bg-white/10 rounded-full blur-2xl"})}),e.jsxs("div",{className:"px-6 pb-6 relative",children:[e.jsx("div",{className:"relative -mt-12 mb-4 flex justify-center",children:e.jsxs("div",{className:"w-24 h-24 rounded-full bg-white dark:bg-slate-800 p-1.5 shadow-lg relative z-10",children:[e.jsx("div",{className:"w-full h-full rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center text-emerald-600 dark:text-emerald-400 font-bold text-3xl overflow-hidden border-2 border-slate-50 dark:border-slate-600",children:M.name.charAt(0).toUpperCase()}),e.jsx("div",{className:"absolute bottom-1 right-1 w-5 h-5 bg-emerald-500 border-4 border-white dark:border-slate-800 rounded-full"})]})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"font-bold text-slate-800 dark:text-slate-100 text-xl font-lora leading-tight mb-1",children:M.name}),e.jsx("span",{className:"inline-block px-3 py-1 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 text-[10px] font-bold uppercase tracking-wider rounded-full border border-emerald-100 dark:border-emerald-800/50",children:be(M.role)}),e.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 bg-slate-50 dark:bg-slate-800/50 py-2 px-3 rounded-lg border border-slate-100 dark:border-slate-700 mx-4 cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors group/id",onClick:ue,children:[e.jsx("span",{className:"text-xs text-slate-400 font-mono",children:"ID:"}),e.jsx("span",{className:"text-xs font-bold text-slate-600 dark:text-slate-300 font-mono tracking-wide",children:M.id}),e.jsx("span",{className:"text-slate-400 opacity-0 group-hover/id:opacity-100 transition-opacity",children:e.jsx(ne.copy,{})})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-dashed border-slate-200 dark:border-slate-700",children:[e.jsx("button",{onClick:()=>V(!F),className:`w-full bg-gradient-to-br rounded-xl p-4 border relative overflow-hidden group/card hover:shadow-lg transition-all duration-300 ${F?"from-blue-50 to-white dark:from-slate-800 dark:to-slate-800/50 border-blue-200 dark:border-blue-800":"from-slate-50 to-white dark:from-slate-800 dark:to-slate-800/50 border-slate-200 dark:border-slate-700"}`,children:e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg shadow-sm text-blue-600 dark:text-blue-400 border border-slate-100 dark:border-slate-600 transition-colors ${F?"bg-blue-100 dark:bg-blue-900/40":"bg-white dark:bg-slate-700"}`,children:e.jsx(ne.idCard,{})}),e.jsxs("div",{className:"text-left flex-grow",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-0.5",children:"Informasi Akun"}),e.jsx("h5",{className:"font-bold text-slate-700 dark:text-slate-200 text-sm leading-tight transition-colors",children:"Detail Akun Saya"})]}),e.jsx("div",{className:`text-slate-400 transition-transform duration-300 ${F?"rotate-180 text-blue-500":""}`,children:e.jsx(ne.chevronDown,{open:F})})]})})}),e.jsx("div",{className:`overflow-hidden transition-all duration-500 ease-in-out ${F?"max-h-[800px] opacity-100 mt-4":"max-h-0 opacity-0 mt-0"}`,children:e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl border border-slate-100 dark:border-slate-700 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 text-slate-400",children:e.jsx(ne.mail,{})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-bold",children:"Email"}),e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200 break-all",children:M.email})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 text-slate-400",children:e.jsx(ne.phone,{})}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-bold",children:"No. Telepon"}),e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:M.telpon})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 text-slate-400",children:e.jsx(ne.key,{})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-bold",children:"Password"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200 font-mono",children:O?M.password:"••••••••"}),e.jsx("button",{onClick:()=>D(!O),className:"text-slate-400 hover:text-blue-500 transition-colors",children:O?e.jsx(ne.eyeOff,{}):e.jsx(ne.eye,{})})]})]})]}),M.uniquecode&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 text-slate-400",children:e.jsx(ne.userCard,{})}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-bold",children:"Kode Unik / NISN"}),e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200 font-mono",children:M.uniquecode})]})]}),e.jsxs("div",{className:"pt-2 border-t border-slate-200 dark:border-slate-700 flex items-center gap-2 text-[10px] text-slate-400",children:[e.jsx(ne.calendar,{})," Terdaftar sejak: ",r(M.createdAt)]})]})})]}),w&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-dashed border-slate-200 dark:border-slate-700",children:[e.jsxs("button",{onClick:()=>te(!U),className:`w-full bg-gradient-to-br rounded-xl p-4 border relative overflow-hidden group/card hover:shadow-lg transition-all duration-300 ${U?"from-emerald-50 to-white dark:from-slate-800 dark:to-slate-800/50 border-emerald-200 dark:border-emerald-800":"from-slate-50 to-white dark:from-slate-800 dark:to-slate-800/50 border-slate-200 dark:border-slate-700"}`,children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-emerald-100 dark:bg-emerald-900/20 rounded-bl-full -mr-8 -mt-8 transition-transform group-hover/card:scale-110"}),e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg shadow-sm text-emerald-600 dark:text-emerald-400 border border-slate-100 dark:border-slate-600 transition-colors ${U?"bg-emerald-100 dark:bg-emerald-900/40":"bg-white dark:bg-slate-700"}`,children:e.jsx(ne.userCard,{})}),e.jsxs("div",{className:"text-left flex-grow",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-0.5",children:"Data Siswa Terkait"}),e.jsx("h5",{className:"font-bold text-slate-700 dark:text-slate-200 text-sm leading-tight group-hover/card:text-emerald-700 dark:group-hover/card:text-emerald-400 transition-colors",children:(P=w.identitas)==null?void 0:P.nama})]}),e.jsx("div",{className:`text-slate-400 transition-transform duration-300 ${U?"rotate-180 text-emerald-500":""}`,children:e.jsx(ne.chevronDown,{open:U})})]})})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-500 ease-in-out ${U?"max-h-[800px] opacity-100 mt-4":"max-h-0 opacity-0 mt-0"}`,children:e.jsxs("div",{className:"space-y-4 px-1",children:[e.jsx("div",{className:"text-center bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl border border-slate-100 dark:border-slate-700",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 bg-white dark:bg-slate-800 rounded-full text-slate-500 dark:text-slate-400 text-sm font-mono cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors group/nisn border border-slate-100 dark:border-slate-700 shadow-sm",title:"Salin NISN",onClick:fe,children:[e.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400",children:w.nisn}),e.jsx("span",{className:"opacity-0 group-hover/nisn:opacity-100 transition-opacity",children:e.jsx(ne.copy,{})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-3 rounded-xl border border-slate-100 dark:border-slate-700 text-center",children:[e.jsx("span",{className:"text-[9px] text-slate-400 uppercase font-bold block mb-1",children:"Kelas"}),e.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:(he=w.status)==null?void 0:he.kelas})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-3 rounded-xl border border-slate-100 dark:border-slate-700 text-center",children:[e.jsx("span",{className:"text-[9px] text-slate-400 uppercase font-bold block mb-1",children:"Sekolah"}),e.jsx("span",{className:"text-sm font-bold text-emerald-600 dark:text-emerald-400 uppercase",children:(we=w.status)==null?void 0:we.sekolah})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl border border-slate-100 dark:border-slate-700 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 text-slate-400",children:e.jsx(ne.cake,{})}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-bold",children:"TTL"}),e.jsxs("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:[(Ce=w.identitas)==null?void 0:Ce.tempat_lahir,", ",(Fe=w.identitas)==null?void 0:Fe.tanggal_lahir]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 text-slate-400",children:e.jsx(ne.gender,{})}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-bold",children:"Jenis Kelamin"}),e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:((Ne=w.identitas)==null?void 0:Ne.jenis_kelamin)==="L"?"Laki-laki":"Perempuan"})]})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl border border-slate-100 dark:border-slate-700 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-300",children:[e.jsx(ne.phone,{})," ",((Ae=w.identitas)==null?void 0:Ae.telpon)||"-"]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-300",children:[e.jsx(ne.mail,{})," ",((Ie=w.identitas)==null?void 0:Ie.email)||"-"]}),e.jsx("div",{className:"pt-2 mt-2 border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"mt-0.5 text-slate-400 flex-shrink-0",children:e.jsx(ne.mapPin,{})}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 leading-relaxed",children:[(pe=w.alamat)==null?void 0:pe.detail,", ",(Oe=w.alamat)==null?void 0:Oe.desa,", ",(Ye=w.alamat)==null?void 0:Ye.kec,", ",(Ze=w.alamat)==null?void 0:Ze.kota]})]})})]})]})})]})]})]}),e.jsx("div",{className:"md:hidden flex justify-center mb-2",children:e.jsx("div",{className:"bg-white dark:bg-slate-900 p-1.5 rounded-full shadow-sm border border-slate-100 dark:border-slate-800 inline-flex flex-wrap justify-center gap-1",children:[{id:"all",label:"Semua"},{id:"calendar",label:"Kalender"},{id:"notes",label:"Catatan"},{id:"todos",label:"To Do List"}].map(l=>e.jsx("button",{onClick:()=>A(l.id),className:`px-4 py-2 rounded-full text-xs font-bold transition-all duration-300 whitespace-nowrap ${u===l.id?"bg-emerald-600 text-white shadow-md":"text-slate-500 hover:text-emerald-600"}`,children:l.label},l.id))})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:`bg-white dark:bg-slate-900 rounded-3xl p-6 shadow-sm border border-slate-100 dark:border-slate-800 flex-col h-[500px] ${u==="all"||u==="notes"?"flex":"hidden md:flex"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-slate-100 dark:border-slate-800 pb-3",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-amber-400"})," Catatan (",E.length,")"]}),se&&e.jsx("span",{className:"text-xs text-amber-500 font-bold animate-pulse",children:"Mode Edit"})]}),e.jsxs("div",{className:"space-y-2 mb-4 bg-slate-50 dark:bg-slate-800/50 p-3 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("input",{className:"w-full bg-transparent text-sm font-bold placeholder-slate-400 text-slate-700 dark:text-slate-200 outline-none",placeholder:"Judul Catatan...",value:le,onChange:l=>m(l.target.value)}),e.jsx("div",{className:"h-px bg-slate-200 dark:bg-slate-700 w-full"}),e.jsx("textarea",{className:"w-full bg-transparent text-xs text-slate-600 dark:text-slate-300 outline-none resize-none h-16",placeholder:"Isi catatan disini...",value:ae,onChange:l=>re(l.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[se&&e.jsx("button",{onClick:()=>{z(null),m(""),re("")},className:"text-slate-400 hover:text-slate-600 text-xs font-bold px-2",children:"Batal"}),e.jsxs("button",{onClick:xe,className:"bg-amber-500 hover:bg-amber-600 text-white text-xs font-bold px-3 py-1.5 rounded-lg flex items-center gap-1 transition-colors shadow-sm active:scale-95",children:[e.jsx(ne.plus,{})," ",se?"Update":"Simpan"]})]})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto scrollbar-hide space-y-3 pr-1",children:[y.length===0&&e.jsx("div",{className:"h-full flex items-center justify-center text-slate-400 text-xs",children:"Belum ada catatan"}),y.map(l=>e.jsxs("div",{onClick:()=>je(l),className:"bg-yellow-50 dark:bg-slate-800 p-3 rounded-xl border border-yellow-100 dark:border-slate-700 relative group transition-all hover:shadow-sm cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h5",{className:"font-bold text-xs text-slate-800 dark:text-slate-200 line-clamp-1",children:l.title}),e.jsx("span",{className:"text-[10px] text-slate-400",children:new Date(l.timestamp).toLocaleDateString("id-ID")})]}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 leading-relaxed whitespace-pre-wrap line-clamp-3",children:l.content}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity bg-white/80 dark:bg-slate-900/80 p-1 rounded-md shadow-sm",onClick:k=>k.stopPropagation(),children:[e.jsx("button",{onClick:()=>Te(l.noteId),children:e.jsx(ne.pin,{active:l.pinned})}),e.jsx("button",{onClick:()=>ye(l.noteId),children:e.jsx(ne.trash,{})})]})]},l.noteId))]})]}),e.jsxs("div",{className:`bg-white dark:bg-slate-900 rounded-3xl p-5 shadow-sm border border-slate-100 dark:border-slate-800 flex-col h-[500px] ${u==="all"||u==="calendar"?"flex":"hidden md:flex"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>R(-1),className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full",children:e.jsx(ne.chevronLeft,{})}),e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2 text-sm",children:[e.jsx(ne.calendar,{})," ",B.toLocaleString("default",{month:"long",year:"numeric"})]}),e.jsx("button",{onClick:()=>R(1),className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full",children:e.jsx(ne.chevronRight,{})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-center mb-2",children:["M","S","S","R","K","J","S"].map((l,k)=>e.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:l},k))}),e.jsx("div",{className:"grid grid-cols-7 gap-1 auto-rows-fr flex-grow",children:L(B).map((l,k)=>{if(!l)return e.jsx("div",{className:"aspect-square"},k);const J=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}-${String(l.getDate()).padStart(2,"0")}`,Se=H.some(Be=>Be.date===J&&Be.schedule.length>0),Pe=new Date,_e=l.getDate()===Pe.getDate()&&l.getMonth()===Pe.getMonth()&&l.getFullYear()===Pe.getFullYear();return e.jsxs("button",{onClick:()=>X(J),className:`aspect-square flex flex-col items-center justify-center rounded-lg text-xs font-medium transition-all relative group 
                                ${_e?"bg-emerald-600 text-white shadow-md":"bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-400 hover:bg-emerald-50 dark:hover:bg-slate-700"}`,children:[l.getDate(),Se&&e.jsx("span",{className:`w-1.5 h-1.5 rounded-full mt-1 ${_e?"bg-white":"bg-emerald-500"}`})]},k)})})]}),e.jsxs("div",{className:`bg-white dark:bg-slate-900 rounded-3xl p-6 shadow-sm border border-slate-100 dark:border-slate-800 flex-col h-[500px] ${u==="all"||u==="todos"?"flex":"hidden md:flex"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-4 border-b border-slate-100 dark:border-slate-800 pb-3",children:e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"})," To-Do List (",K.filter(l=>!l.completed).length,")"]})}),e.jsxs("div",{className:"space-y-2 mb-4 bg-slate-50 dark:bg-slate-800/50 p-3 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx("input",{className:"flex-grow bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg border border-slate-200 dark:border-slate-700 text-xs outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500/20 dark:text-white transition-all",placeholder:"Nama Tugas...",value:de,onChange:l=>ce(l.target.value)})}),e.jsx("div",{className:"flex justify-end pt-1",children:e.jsxs("button",{onClick:()=>$e(),className:"bg-blue-500 hover:bg-blue-600 text-white text-xs font-bold px-3 py-1.5 rounded-lg flex items-center gap-1 transition-colors shadow-sm active:scale-95",children:[e.jsx(ne.plus,{})," Tambah"]})})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto scrollbar-hide space-y-2 pr-1",children:[s.length===0&&e.jsx("div",{className:"h-full flex items-center justify-center text-slate-400 text-xs",children:"Semua tugas selesai!"}),s.map(l=>e.jsx("div",{className:`p-3 rounded-xl border transition-all hover:shadow-sm ${l.completed?"bg-slate-50 border-slate-100 opacity-60":"bg-white dark:bg-slate-800 border-slate-100 dark:border-slate-700"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{onClick:()=>Z(l.todoId),className:`flex-shrink-0 w-5 h-5 rounded-md border flex items-center justify-center transition-colors mt-0.5 ${l.completed?"bg-emerald-500 border-emerald-500":"border-slate-300 dark:border-slate-600 hover:border-emerald-500"}`,children:l.completed&&e.jsx(ne.check,{})}),e.jsx("div",{className:"flex-grow min-w-0",children:p===l.todoId?e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("input",{value:I,onChange:k=>_(k.target.value),className:"flex-grow bg-slate-100 dark:bg-slate-900 px-2 py-1 rounded text-xs outline-none border border-blue-400",autoFocus:!0,onBlur:()=>S(l.todoId),onKeyDown:k=>k.key==="Enter"&&S(l.todoId)})}):e.jsxs("div",{className:"flex justify-between items-start group",children:[e.jsx("h5",{className:`text-xs font-bold truncate ${l.completed?"text-slate-500 line-through":"text-slate-700 dark:text-slate-200"}`,children:l.title}),e.jsxs("div",{className:"flex gap-1 ml-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>t(l),children:e.jsx(ne.edit,{})}),e.jsx("button",{onClick:()=>x(l.todoId),children:e.jsx(ne.pin,{active:l.pinned})}),e.jsx("button",{onClick:()=>a(l.todoId),className:"text-slate-300 hover:text-red-500",children:e.jsx(ne.trash,{})})]})]})})]})},l.todoId))]})]})]}),oe&&e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in-fast",onClick:()=>X(null),children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-sm rounded-3xl shadow-2xl p-6 relative animate-slide-in-up",onClick:l=>l.stopPropagation(),children:[e.jsx("button",{onClick:()=>X(null),className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600",children:e.jsx(ne.close,{})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:new Date(oe).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})}),e.jsx("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 font-bold uppercase tracking-wider mt-1",children:"Agenda Harian"})]}),e.jsx("div",{className:"space-y-3 mb-6 max-h-48 overflow-y-auto scrollbar-hide",children:$.length===0?e.jsx("p",{className:"text-center text-sm text-slate-400 italic py-4",children:"Belum ada agenda."}):$.map(l=>e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-3 rounded-xl border-l-4 border-emerald-500 flex justify-between items-start group",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-bold text-emerald-600 dark:text-emerald-400 block mb-0.5",children:l.time}),e.jsx("h4",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:l.title}),l.description&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:l.description})]}),e.jsx("button",{onClick:()=>ve(oe,l.scheduleId),className:"text-slate-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(ne.trash,{})})]},l.scheduleId))}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl border border-slate-100 dark:border-slate-800",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 mb-3 uppercase",children:"Tambah Agenda"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"time",value:ie,onChange:l=>me(l.target.value),className:"w-20 px-2 py-2 text-xs rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 outline-none focus:ring-1 focus:ring-emerald-500"}),e.jsx("input",{type:"text",placeholder:"Judul...",value:b,onChange:l=>T(l.target.value),className:"flex-grow px-3 py-2 text-xs rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 outline-none focus:ring-1 focus:ring-emerald-500"})]}),e.jsx("input",{type:"text",placeholder:"Keterangan...",value:v,onChange:l=>ee(l.target.value),className:"w-full px-3 py-2 text-xs rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 outline-none focus:ring-1 focus:ring-emerald-500"}),e.jsx("button",{onClick:G,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white py-2 rounded-lg text-xs font-bold shadow-sm transition-colors active:scale-95",children:"Simpan Agenda"})]})]})]})})]})},Ke="https://api-sekolah-minnatulhuda.halo-minnatulhuda.workers.dev",Ee={Close:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Check:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),Download:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),Building:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),Clock:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),Wallet:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),ChevronRight:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})},Ge=M=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(M),oa=M=>M.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()),da=(M,n)=>{let w=[];const c=["tetap","semesteran","bulanan"],E={tetap:"fixed",semesteran:"semester",bulanan:"monthly"};return c.forEach(h=>{M[h]&&Array.isArray(M[h])&&M[h].forEach(K=>{let q=0;if(n&&n[h]){const Y=n[h].find(U=>U.biaya===K.biaya);Y&&(q=Y.amount||0)}const H=K.amount||0;q===0&&H>0&&(q=H);const Q=q-H;let W=0;q>0?W=Q/q*100:H===0&&(W=100),w.push({id:K.biaya,keyName:K.biaya,item:oa(K.biaya),amount:Ge(q),rawAmount:q,paid:Ge(Q<0?0:Q),rawPaid:Q<0?0:Q,remaining:Ge(H),rawRemaining:H,progress:Math.min(Math.max(W,0),100),date:K.timestamp?new Date(K.timestamp).toLocaleDateString("id-ID"):"-",status:K.status||"Belum Lunas",category:E[h]})})}),w},ia=({user:M,language:n,onLogout:w,setHideNav:c})=>{const E=ze[n].dashboard,[h,K]=o.useState([]),[q,H]=o.useState(null),[Q,W]=o.useState(!1),[Y,U]=o.useState("all"),[te,F]=o.useState("all"),[V,O]=o.useState(null),[D,u]=o.useState(!1),[A,se]=o.useState(!0);o.useEffect(()=>{z()},[M]),o.useEffect(()=>(document.body.style.overflow=V?"hidden":"",()=>{document.body.style.overflow=""}),[V]);const z=async()=>{var m;W(!0);try{const ae=M.uniquecode?fetch(`${Ke}/api/data?type=student_profile&nisn=${M.uniquecode}`).then(T=>T.json()):Promise.resolve(null),re=fetch(`${Ke}/api/data?type=transaction&id=${M.id}`).then(T=>T.json()),[de,ce]=await Promise.all([ae,re]);de&&!de.error&&H(de);let b=null;if(de&&((m=de.status)!=null&&m.sekolah)){let T=de.status.sekolah.toLowerCase().replace(/\s/g,"");T.includes("mi")?T="mi":T.includes("mts")?T="mtsn":T.includes("smp")?T="smpbp":T.includes("smk")?T="smksit":T.includes("ma")&&(T="ma");const v=await fetch(`${Ke}/api/data?type=template_biaya_${T}`);if(v.ok){const ee=await v.json();b=Array.isArray(ee)?ee[0]:ee}}if(ce&&!ce.error){const T=da(ce,b);K(T)}}catch(ae){console.error("Fetch error",ae)}finally{W(!1)}},p=m=>{O(m),c&&c(!0)},N=()=>{u(!0),setTimeout(()=>{O(null),u(!1),c&&c(!1)},300)},I=async()=>{if(!V)return;const m=V;W(!0);try{const ae={idAccount:M.id,biaya:m.keyName,category:m.category},re=await fetch(`${Ke}/api/confirm-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)}),de=await re.json();re.ok?(alert(n==="id"?"Konfirmasi berhasil!":"Confirmation successful!"),N(),z()):alert(`Gagal: ${de.details||de.error}`)}catch{alert("Error connection")}finally{W(!1)}},_=()=>{const m=document.createElement("a");m.href="https://drive.google.com/uc?export=download&id=1QaWwMafKnUG9c65zOHaLsBXIp5whkszP",m.target="_blank",m.rel="noopener noreferrer",document.body.appendChild(m),m.click(),document.body.removeChild(m)},B=h.filter(m=>{const ae=Y==="all"||m.category===Y,re=te==="all"||(m.status||"").toLowerCase()===te;return ae&&re}),g=V?(V.status||"").toLowerCase()==="lunas":!1,oe=V?!g:!1,X=m=>{const ae=(m||"").toLowerCase();return ae==="lunas"?"bg-emerald-100 text-emerald-700 border-emerald-200":ae==="proses"?"bg-blue-50 text-blue-600 border-blue-100":ae==="diterima sebagian"?"bg-purple-50 text-purple-600 border-purple-100":"bg-amber-50 text-amber-600 border-amber-100"},le=m=>{switch(m){case"fixed":return{icon:Ee.Building,color:"text-purple-600",bg:"bg-purple-50 dark:bg-purple-900/20"};case"semester":return{icon:Ee.Clock,color:"text-blue-600",bg:"bg-blue-50 dark:bg-blue-900/20"};default:return{icon:Ee.Wallet,color:"text-amber-600",bg:"bg-amber-50 dark:bg-amber-900/20"}}};return e.jsx("div",{className:"bg-transparent min-h-screen pt-24 pb-20 px-4",dir:n==="ar"?"rtl":"ltr",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:[E.welcome," ",M.name]}),e.jsx("p",{className:"text-emerald-600 dark:text-emerald-400 font-medium",children:E.portal_parent})]}),e.jsx("button",{onClick:w,className:"px-6 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-full font-bold text-sm transition-colors",children:ze[n].nav.logout})]}),A&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 p-4 rounded-2xl mb-8 relative animate-fade-in-down",children:[e.jsx("button",{onClick:()=>se(!1),className:"absolute top-2 right-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 p-1",children:e.jsx(Ee.Close,{})}),e.jsxs("h4",{className:"font-bold text-blue-700 dark:text-blue-300 text-sm mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"w-5 h-5 bg-blue-100 rounded-full flex items-center justify-center text-xs",children:"i"})," ",E.guide_title]}),e.jsxs("ul",{className:"text-xs text-slate-600 dark:text-slate-300 space-y-1 list-disc pl-5",children:[e.jsx("li",{children:E.guide_step_1}),e.jsx("li",{children:E.guide_step_2}),e.jsx("li",{children:E.guide_step_3})]})]}),e.jsx(sa,{user:M,language:n,studentProfile:q}),e.jsxs("div",{className:"mt-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:E.finance_history}),e.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Pantau status pembayaran SPP dan biaya lainnya."})]}),e.jsx("div",{className:"flex bg-white dark:bg-slate-900 p-1 rounded-xl border border-slate-100 dark:border-slate-800 overflow-x-auto max-w-full",children:["all","fixed","semester","monthly"].map(m=>e.jsx("button",{onClick:()=>U(m),className:`px-4 py-2 rounded-lg text-xs font-bold transition-all whitespace-nowrap ${Y===m?"bg-slate-100 dark:bg-slate-800 text-emerald-600 shadow-sm":"text-slate-500"}`,children:E[`tab_${m}`]||m},m))})]}),e.jsx("div",{className:"space-y-3",children:Q&&!V?e.jsx("div",{className:"text-center py-12",children:e.jsx("span",{className:"text-slate-400 font-medium animate-pulse",children:E.processing})}):B.length===0?e.jsx("div",{className:"text-center py-12 bg-white dark:bg-slate-900 rounded-3xl border border-slate-100 dark:border-slate-800",children:e.jsx("p",{className:"text-slate-400 italic",children:"Tidak ada data transaksi ditemukan."})}):B.map((m,ae)=>{const re=le(m.category);return e.jsxs("div",{onClick:()=>p(m),className:"group relative bg-white dark:bg-slate-900 rounded-2xl p-4 md:p-5 border border-slate-100 dark:border-slate-800 hover:border-emerald-200 dark:hover:border-emerald-800 hover:shadow-md transition-all cursor-pointer overflow-hidden",children:[e.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-slate-100 dark:bg-slate-800 w-full",children:e.jsx("div",{className:`h-full transition-all duration-1000 ${m.status.toLowerCase()==="lunas"?"bg-emerald-500":"bg-amber-400"}`,style:{width:`${m.progress}%`}})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 ${re.bg} ${re.color}`,children:e.jsx(re.icon,{})}),e.jsxs("div",{className:"flex-grow min-w-0 grid grid-cols-1 md:grid-cols-12 gap-4 items-center",children:[e.jsxs("div",{className:"md:col-span-5",children:[e.jsx("h4",{className:"font-bold text-slate-800 dark:text-slate-100 text-sm md:text-base truncate group-hover:text-emerald-600 transition-colors",children:m.item}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-[10px] bg-slate-100 dark:bg-slate-800 text-slate-500 px-2 py-0.5 rounded font-mono",children:m.date}),e.jsxs("span",{className:"text-[10px] text-slate-400 truncate hidden md:inline",children:["ID: ",m.id.slice(0,8),"..."]})]})]}),e.jsxs("div",{className:"hidden md:block md:col-span-4",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-slate-500",children:"Terbayar"}),e.jsxs("span",{className:"font-bold font-mono text-slate-700 dark:text-slate-300",children:[m.paid," ",e.jsxs("span",{className:"text-slate-400 font-normal",children:["/ ",m.amount]})]})]}),e.jsx("div",{className:"w-full bg-slate-100 dark:bg-slate-800 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${m.progress>=100?"bg-emerald-500":"bg-amber-400"}`,style:{width:`${m.progress}%`}})})]}),e.jsxs("div",{className:"md:col-span-3 flex justify-between md:justify-end items-center gap-4",children:[e.jsx("div",{className:"text-right",children:m.rawRemaining>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold",children:"Sisa Tagihan"}),e.jsx("p",{className:"text-sm font-bold font-mono text-red-500",children:m.remaining})]}):e.jsxs("span",{className:"text-xs font-bold text-emerald-600 flex items-center gap-1",children:[e.jsx(Ee.Check,{})," Lunas"]})}),e.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wide border ${X(m.status)}`,children:m.status}),e.jsx("div",{className:"text-slate-300 group-hover:text-emerald-500 transition-colors",children:e.jsx(Ee.ChevronRight,{})})]})]})]})]},ae)})})]}),V&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed inset-0 z-[200] bg-black/60 backdrop-blur-sm transition-opacity duration-300 ${D?"opacity-0":"opacity-100"}`,onClick:N}),e.jsxs("div",{className:`fixed bottom-0 left-0 right-0 z-[201] bg-white dark:bg-slate-900 rounded-t-3xl shadow-[0_-10px_40px_rgba(0,0,0,0.2)] flex flex-col max-h-[90vh] transform transition-transform duration-300 ${D?"translate-y-full":"translate-y-0 animate-slide-in-up"}`,onClick:m=>m.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Rincian Pembayaran"}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["ID: ",V.id]})]}),e.jsx("button",{onClick:N,className:"p-2 bg-slate-100 dark:bg-slate-800 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors",children:e.jsx(Ee.Close,{})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto",children:[e.jsx("div",{className:`p-4 rounded-xl flex items-center justify-between mb-6 ${g?"bg-emerald-50 border border-emerald-100 text-emerald-800":"bg-amber-50 border border-amber-100 text-amber-800"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${g?"bg-emerald-200":"bg-amber-200"}`,children:g?e.jsx(Ee.Check,{}):e.jsx("svg",{className:"w-6 h-6 text-amber-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold opacity-70 uppercase tracking-wider",children:"Status Transaksi"}),e.jsx("p",{className:"font-bold text-lg capitalize",children:V.status})]})]})}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h4",{className:"font-bold text-slate-800 dark:text-slate-100 text-sm border-l-4 border-emerald-500 pl-3",children:"Informasi Tagihan"}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl border border-slate-100 dark:border-slate-800 space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:"Jenis Pembayaran"}),e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:V.item})]}),e.jsx("div",{className:"border-t border-slate-200 dark:border-slate-700 my-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:"Total Tagihan"}),e.jsx("span",{className:"font-bold font-mono",children:V.amount})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:"Sudah Dibayar"}),e.jsx("span",{className:"font-bold font-mono text-emerald-600",children:V.paid})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("span",{className:"font-bold",children:"Sisa Tagihan"}),e.jsx("span",{className:"text-xl font-bold font-mono text-red-500",children:V.remaining})]}),e.jsxs("div",{className:"mt-4 pt-2",children:[e.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 mb-1",children:[e.jsx("span",{children:"Progres Pembayaran"}),e.jsxs("span",{children:[Math.round(V.progress),"%"]})]}),e.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${g?"bg-emerald-500":"bg-amber-400"}`,style:{width:`${V.progress}%`}})})]})]})]}),oe&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-bold text-slate-800 dark:text-slate-100 text-sm border-l-4 border-emerald-500 pl-3",children:"Metode Pembayaran"}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"inline-block p-4 bg-white rounded-xl border border-slate-100 shadow-sm mb-4",children:e.jsx("img",{src:"https://imgur.com/FPmggp4.png",alt:"QRIS",className:"w-64 h-64 object-contain mx-auto"})}),e.jsxs("button",{onClick:_,className:"mb-4 text-xs font-bold text-emerald-600 hover:text-emerald-700 flex items-center justify-center gap-1 mx-auto py-1 px-3 rounded-full hover:bg-emerald-50 transition-colors",children:[e.jsx(Ee.Download,{})," Download QRIS"]})]})]})]}),oe&&e.jsx("div",{className:"p-4 border-t border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-900 pb-8 md:pb-6",children:e.jsx("button",{onClick:I,disabled:Q,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-4 rounded-xl shadow-lg transition-transform active:scale-95 flex justify-center items-center gap-2",children:Q?e.jsx("span",{children:"Memproses..."}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Saya Sudah Transfer"}),e.jsx(Ee.Check,{})]})})})]})]})]})})},ca=({language:M,setHideNav:n})=>{const[w,c]=o.useState([]),[E,h]=o.useState([]),[K,q]=o.useState([]),[H,Q]=o.useState([]),[W,Y]=o.useState({}),[U,te]=o.useState(!1),[F,V]=o.useState("all"),[O,D]=o.useState(""),[u,A]=o.useState(""),[se,z]=o.useState(""),[p,N]=o.useState(null),[I,_]=o.useState(!1),[B,g]=o.useState(!1),[oe,X]=o.useState([]);o.useEffect(()=>{le()},[]);const le=async()=>{te(!0);try{const b=["template_biaya_mi","template_biaya_mtsn","template_biaya_smpbp","template_biaya_smksit","template_biaya_ma"],[T,v,ee,ie,...me]=await Promise.all([De(`${ke}/api/data?type=notification_transaction`),De(`${ke}/api/data?type=all_transactions`),De(`${ke}/api/accounts`),De(`${ke}/api/data?type=siswa`),...b.map(ue=>De(`${ke}/api/data?type=${ue}`))]);if(T){const ue=Array.isArray(T)?T.sort((fe,r)=>new Date(r.timestamp).getTime()-new Date(fe.timestamp).getTime()):[];c(ue)}v&&h(Array.isArray(v)?v:[]),ee&&q(ee),ie&&Q(Array.isArray(ie)?ie:[]);const be={};b.forEach((ue,fe)=>{me[fe]&&(be[ue]=Array.isArray(me[fe])?me[fe][0]:me[fe])}),Y(be)}catch(b){console.error("Init Error",b)}finally{te(!1)}};o.useEffect(()=>{const b=p||B;return document.body.style.overflow=b?"hidden":"",n&&n(b),()=>{document.body.style.overflow="",n&&n(!1)}},[p,B,n]);const m=()=>{_(!0),setTimeout(()=>{N(null),_(!1)},300)},ae=async()=>{if(p){te(!0);try{const b={idTransaction:p.idTransaction,idAccount:p.idAccount,biaya:p.biaya,status:p.status,amount:p.amount};(await fetch(`${ke}/api/admin/update-transaction`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(b)})).ok?(alert("Transaksi berhasil diperbarui!"),m(),le()):alert("Gagal memperbarui transaksi.")}catch{alert("Terjadi kesalahan koneksi.")}finally{te(!1)}}},re=b=>{var ue,fe,r,i;const T=K.find(d=>d.idAccount===b.idAccount),v=T?H.find(d=>String(d.nisn).trim()===String(T.uniquecode).trim()):null;let ee=0,ie=0,me=0;if(v&&((ue=v.status)!=null&&ue.sekolah)){let d=v.status.sekolah.toLowerCase().replace(/\s/g,"");d.includes("mi")?d="mi":d.includes("mts")?d="mtsn":d.includes("smp")?d="smpbp":d.includes("smk")?d="smksit":d.includes("ma")&&(d="ma");const L=`template_biaya_${d}`,R=W[L];R&&["tetap","semesteran","bulanan"].forEach(G=>{var xe;const ve=(xe=R[G])==null?void 0:xe.find(je=>je.biaya===b.biaya);ve&&(ee=ve.amount||0)})}const be=E.find(d=>d.idAccount===b.idAccount);return be?(["tetap","semesteran","bulanan"].forEach(d=>{var R;const L=(R=be[d])==null?void 0:R.find(G=>G.biaya===b.biaya);L&&(ie=L.amount)}),ie===void 0&&(ie=ee)):ie=ee,me=Math.max(0,ee-ie),{parentName:T?T.nama:"Unknown",studentName:v?(fe=v.identitas)==null?void 0:fe.nama:"-",school:v?(r=v.status)==null?void 0:r.sekolah:"-",kelas:v?(i=v.status)==null?void 0:i.kelas:"-",bill:ee,paid:me,remaining:ie}},de=w.filter(b=>{const T=F==="all"?!0:(b.status||"").toLowerCase()===F.toLowerCase(),v=new Date(b.timestamp).getTime();let ee=!0;u&&(ee=ee&&v>=new Date(u).setHours(0,0,0,0)),se&&(ee=ee&&v<=new Date(se).setHours(23,59,59,999));let ie=!0;if(O){const me=O.toLowerCase(),be=re(b);ie=be.studentName&&be.studentName.toLowerCase().includes(me)||be.parentName&&be.parentName.toLowerCase().includes(me)||b.idAccount&&b.idAccount.toLowerCase().includes(me)||b.biaya&&b.biaya.toLowerCase().includes(me)}return T&&ee&&ie}),ce=()=>{const b=new Set;de.forEach(T=>{const v=new Date(T.timestamp);isNaN(v.getTime())||b.add(v.toLocaleDateString("id-ID",{month:"long",year:"numeric"}))}),X(Array.from(b)),g(!0)};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"Verifikasi Pembayaran"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:ce,className:"p-2 rounded-lg bg-emerald-50 text-emerald-600 hover:bg-emerald-100 transition-colors flex items-center gap-1",title:"Download PDF",children:[e.jsx(C.Download,{})," ",e.jsx("span",{className:"text-xs font-bold hidden md:inline",children:"Laporan PDF"})]}),e.jsx("button",{onClick:le,className:"p-2 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-600 transition-colors",children:e.jsx(C.Refresh,{})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-3",children:[e.jsx("div",{className:"md:col-span-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Cari Nama / ID / Tagihan...",value:O,onChange:b=>D(b.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-emerald-500 transition-all"}),e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:e.jsx(C.Filter,{})})]})}),e.jsxs("div",{className:"md:col-span-3 flex items-center gap-2",children:[e.jsx("input",{type:"date",value:u,onChange:b=>A(b.target.value),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border rounded-lg text-xs outline-none"}),e.jsx("span",{className:"text-slate-400 text-xs",children:"-"}),e.jsx("input",{type:"date",value:se,onChange:b=>z(b.target.value),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border rounded-lg text-xs outline-none"})]}),e.jsx("div",{className:"md:col-span-3",children:e.jsxs("select",{value:F,onChange:b=>V(b.target.value),className:"w-full bg-slate-50 dark:bg-slate-800 border px-4 py-2 rounded-lg text-sm outline-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"Semua Status"}),e.jsx("option",{value:"belum lunas",children:"Belum Lunas"}),e.jsx("option",{value:"proses",children:"Proses"}),e.jsx("option",{value:"diterima sebagian",children:"Diterima Sebagian"}),e.jsx("option",{value:"lunas",children:"Lunas"}),e.jsx("option",{value:"gagal",children:"Gagal"}),e.jsx("option",{value:"dikembalikan",children:"Dikembalikan"})]})}),e.jsx("div",{className:"md:col-span-2 text-right flex items-center justify-end",children:e.jsxs("span",{className:"text-xs text-slate-400 font-medium",children:["Total: ",de.length]})})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800/50 text-slate-500 uppercase font-bold text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4 rounded-tl-xl",children:"Tanggal"}),e.jsx("th",{className:"px-4 py-4",children:"Wali Santri"}),e.jsx("th",{className:"px-4 py-4",children:"Siswa"}),e.jsx("th",{className:"px-4 py-4",children:"Item Bayar"}),e.jsx("th",{className:"px-4 py-4 text-right",children:"Tagihan"}),e.jsx("th",{className:"px-4 py-4 text-right",children:"Terbayar"}),e.jsx("th",{className:"px-4 py-4 text-right",children:"Sisa"}),e.jsx("th",{className:"px-4 py-4 text-center rounded-tr-xl",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:U?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-6 py-8 text-center text-slate-400 animate-pulse",children:"Memuat Data..."})}):de.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-6 py-8 text-center text-slate-400 italic",children:"Tidak ada data."})}):de.map((b,T)=>{const v=re(b);return e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors cursor-pointer group",onClick:()=>N({...b,...v}),children:[e.jsx("td",{className:"px-4 py-4 text-slate-500 text-xs whitespace-nowrap",children:new Date(b.timestamp).toLocaleDateString("id-ID")}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:v.parentName}),e.jsx("span",{className:"text-[10px] text-slate-500",children:b.idAccount})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-emerald-600",children:v.studentName}),e.jsx("span",{className:"text-[10px] text-slate-500",children:v.school.toUpperCase()})]})}),e.jsx("td",{className:"px-4 py-4 font-bold text-slate-800 dark:text-slate-200 text-xs",children:b.biaya?b.biaya.replace(/_/g," ").toUpperCase():"-"}),e.jsx("td",{className:"px-4 py-4 text-right font-mono text-slate-500 text-xs",children:new Intl.NumberFormat("id-ID").format(v.bill)}),e.jsx("td",{className:"px-4 py-4 text-right font-mono font-bold text-emerald-600 text-xs",children:new Intl.NumberFormat("id-ID").format(v.paid)}),e.jsx("td",{className:"px-4 py-4 text-right font-mono font-bold text-red-500 text-xs",children:new Intl.NumberFormat("id-ID").format(v.remaining)}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-[9px] font-bold uppercase tracking-wide border ${(b.status||"").toLowerCase()==="lunas"?"bg-emerald-100 text-emerald-700 border-emerald-200":(b.status||"").toLowerCase()==="gagal"?"bg-red-50 text-red-700 border-red-200":"bg-amber-50 text-amber-600 border-amber-100"}`,children:b.status})})]},T)})})]})}),p&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed inset-0 z-[200] bg-black/60 backdrop-blur-sm transition-opacity duration-300 ${I?"opacity-0":"opacity-100"}`,onClick:m}),e.jsxs("div",{className:`fixed bottom-0 left-0 right-0 z-[201] bg-white dark:bg-slate-900 rounded-t-3xl shadow-[0_-10px_40px_rgba(0,0,0,0.2)] flex flex-col max-h-[90vh] transform transition-transform duration-300 ${I?"translate-y-full":"translate-y-0 animate-slide-in-up"}`,onClick:b=>b.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-100 dark:border-slate-800",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"Konfirmasi Transaksi"}),e.jsx("button",{onClick:m,className:"p-2 bg-slate-100 dark:bg-slate-800 rounded-full",children:e.jsx(C.Close,{})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl border border-slate-100 mb-6 text-sm space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:"Tagihan:"})," ",e.jsxs("span",{className:"font-mono",children:["Rp ",new Intl.NumberFormat("id-ID").format(p.bill||0)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:"Sisa:"})," ",e.jsxs("span",{className:"font-bold text-red-500 font-mono",children:["Rp ",new Intl.NumberFormat("id-ID").format(p.remaining||0)]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-2",children:"Status"}),e.jsxs("select",{value:p.status,onChange:b=>N({...p,status:b.target.value}),className:"w-full px-4 py-3 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 outline-none",children:[e.jsx("option",{value:"belum lunas",children:"Belum lunas"}),e.jsx("option",{value:"proses",children:"Proses"}),e.jsx("option",{value:"diterima sebagian",children:"Diterima Sebagian"}),e.jsx("option",{value:"lunas",children:"Lunas"}),e.jsx("option",{value:"gagal",children:"Gagal"}),e.jsx("option",{value:"dikembalikan",children:"Dikembalikan"})]})]}),(p.status==="diterima sebagian"||p.status==="lunas")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-2",children:"Nominal Diterima (Rp)"}),e.jsx("input",{type:"number",value:p.amount,onChange:b=>N({...p,amount:b.target.value}),className:"w-full px-4 py-3 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 outline-none",placeholder:"0"})]})]})]}),e.jsx("div",{className:"p-4 border-t border-slate-100 dark:border-slate-800",children:e.jsx("button",{onClick:ae,disabled:U,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white py-3.5 rounded-xl font-bold flex justify-center items-center gap-2",children:U?"Menyimpan...":"Simpan Perubahan"})})]})]})]})},xa=({language:M})=>{var ae,re,de,ce,b,T,v,ee,ie,me,be,ue,fe,r,i,d,L,R,G,ve,xe,je,ye,Te,$e,t,S,Z;const[n,w]=o.useState("general"),[c,E]=o.useState(Re),[h,K]=o.useState(!1),q=o.useRef(null),[H,Q]=o.useState(!1),[W,Y]=o.useState(null),[U,te]=o.useState(null),[F,V]=o.useState(null),[O,D]=o.useState(6),u=[{id:"general",label:"Umum"},{id:"visimisi",label:"Visi Misi"},{id:"curriculum",label:"Kurikulum"},{id:"stats",label:"Statistik"},{id:"team",label:"Tim"},{id:"gallery",label:"Galeri"},{id:"news",label:"Berita"},{id:"testimonials",label:"Testimoni"},{id:"faq",label:"FAQ"}];o.useEffect(()=>{A()},[]),o.useEffect(()=>{D(6)},[n]),o.useEffect(()=>(H?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[H]);const A=async()=>{const a=await De(`${ke}/api/data?type=beranda`);if(a)if(Array.isArray(a)){const x=a.reduce((y,s)=>({...y,...s}),{});E({...Re,...x})}else E({...Re,...a})},se=async()=>{K(!0);try{const a={youtube:c.youtube,profile:c.profile,vision:c.vision,mission:c.mission,coreValues:c.coreValues,curriculum:c.curriculum},x={stats:c.stats,team:c.team,gallery:c.gallery,news:c.news,testimonials:c.testimonials,faq:c.faq};await fetch(`${ke}/api/data?type=beranda`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([a,x])}),alert("Data Beranda Disimpan!")}catch{alert("Gagal menyimpan.")}finally{K(!1)}},z=(a,x)=>{E(y=>Me(y,a,x))},p=(a,x)=>{Y(a),te(null),V(x),Q(!0)},N=(a,x,y)=>{Y(a),te(x),V(JSON.parse(JSON.stringify(y))),Q(!0)},I=(a,x)=>{V(y=>Me(y,a,x))},_=()=>{!W||!F||(E(a=>{const x=[...a[W]||[]];return U!==null?x[U]=F:x.push(F),W==="curriculum_pillars"?Me(a,"curriculum.pillars",x):{...a,[W]:x}}),Q(!1),V(null),Y(null),te(null))},B=(a,x)=>{confirm("Hapus item ini?")&&E(y=>{var $;let s;a==="curriculum_pillars"?s=[...(($=y.curriculum)==null?void 0:$.pillars)||[]]:s=[...y[a]||[]];const f=s.filter((P,he)=>he!==x);return a==="curriculum_pillars"?Me(y,"curriculum.pillars",f):{...y,[a]:f}})},g=()=>{const a=JSON.stringify(c,null,2),x="data:application/json;charset=utf-8,"+encodeURIComponent(a),y="beranda-data.json",s=document.createElement("a");s.setAttribute("href",x),s.setAttribute("download",y),s.click()},oe=a=>{const x=new FileReader;a.target.files&&a.target.files[0]&&(x.readAsText(a.target.files[0],"UTF-8"),x.onload=y=>{var s;if((s=y.target)!=null&&s.result)try{const f=JSON.parse(y.target.result);E({...Re,...f}),alert("Data Beranda berhasil diimpor!")}catch(f){alert("Format file JSON tidak valid."),console.error(f)}})},X=(a,x,y,s,f)=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl p-4 flex gap-4 items-center group relative hover:shadow-md transition-shadow",children:[y&&e.jsx("div",{className:"w-16 h-16 rounded-lg bg-slate-100 overflow-hidden flex-shrink-0 border border-slate-100",children:e.jsx("img",{src:y,alt:"Thumbnail",className:"w-full h-full object-cover",onError:$=>$.target.style.display="none"})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("h5",{className:"font-bold text-slate-800 dark:text-slate-100 text-sm truncate",children:a||"(Tanpa Judul)"}),e.jsx("p",{className:"text-xs text-slate-500 truncate",children:x||"-"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:s,className:"p-2 text-blue-500 hover:bg-blue-50 rounded-lg transition-colors text-xs font-bold border border-blue-100",children:"Edit"}),e.jsx("button",{onClick:f,className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors text-xs font-bold border border-red-100",children:e.jsx(C.Trash,{})})]})]}),le=a=>a>O?e.jsxs("button",{onClick:()=>D(x=>x+6),className:"w-full py-3 bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-400 font-bold rounded-xl hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors mt-6 text-xs flex items-center justify-center gap-2",children:[e.jsx(C.Refresh,{})," Muat Lebih Banyak (",a-O," lagi)"]}):null,m=({label:a,pathPrefix:x,type:y="text"})=>{var s,f,$;return e.jsxs("div",{className:"border-t border-slate-100 dark:border-slate-700 my-3 pt-3",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 mb-2 uppercase tracking-wider",children:a}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{label:"Bahasa Indonesia",value:(s=F[x])==null?void 0:s.id,onChange:P=>I(`${x}.id`,P),type:y}),e.jsx(j,{label:"English",value:(f=F[x])==null?void 0:f.en,onChange:P=>I(`${x}.en`,P),type:y}),e.jsx(j,{label:"Bahasa Arab",value:($=F[x])==null?void 0:$.ar,onChange:P=>I(`${x}.ar`,P),type:y})]})]})};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 p-6 min-h-[600px]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 border-b border-slate-100 dark:border-slate-800 pb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Manajemen Beranda"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Sesuaikan konten yang tampil di halaman utama."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:g,className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-lg text-xs font-bold transition-colors",children:[e.jsx(C.Download,{})," Export JSON"]}),e.jsxs("button",{onClick:()=>{var a;return(a=q.current)==null?void 0:a.click()},className:"flex items-center gap-2 px-4 py-2 bg-emerald-50 text-emerald-600 hover:bg-emerald-100 rounded-lg text-xs font-bold transition-colors",children:[e.jsx(C.Upload,{})," Import JSON"]}),e.jsx("input",{type:"file",ref:q,onChange:oe,accept:".json",className:"hidden"})]})]}),e.jsx("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-xl overflow-x-auto max-w-full no-scrollbar mb-6",children:u.map(a=>e.jsx("button",{onClick:()=>w(a.id),className:`px-5 py-2 rounded-lg text-sm font-bold transition-all whitespace-nowrap ${n===a.id?"bg-white dark:bg-slate-700 text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:a.label},a.id))}),e.jsxs("div",{className:"pb-20",children:[n==="general"&&e.jsxs("div",{className:"space-y-4 animate-fade-in-up",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-red-500 rounded-full"})," Youtube Hero"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"Video URL",value:(ae=c.youtube)==null?void 0:ae.url,onChange:a=>z("youtube.url",a)}),e.jsx(j,{label:"Thumbnail URL",value:(re=c.youtube)==null?void 0:re.thumbnail,onChange:a=>z("youtube.thumbnail",a),isImage:!0})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Profil Sekolah"]}),e.jsx(j,{label:"Bahasa Indonesia",value:(de=c.profile)==null?void 0:de.id,onChange:a=>z("profile.id",a),type:"textarea"}),e.jsx(j,{label:"English",value:(ce=c.profile)==null?void 0:ce.en,onChange:a=>z("profile.en",a),type:"textarea"}),e.jsx(j,{label:"Bahasa Arab",value:(b=c.profile)==null?void 0:b.ar,onChange:a=>z("profile.ar",a),type:"textarea"})]})]}),n==="visimisi"&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Visi"]}),e.jsx(j,{label:"Bahasa Indonesia",value:(T=c.vision)==null?void 0:T.id,onChange:a=>z("vision.id",a),type:"textarea"}),e.jsx(j,{label:"English",value:(v=c.vision)==null?void 0:v.en,onChange:a=>z("vision.en",a),type:"textarea"}),e.jsx(j,{label:"Bahasa Arab",value:(ee=c.vision)==null?void 0:ee.ar,onChange:a=>z("vision.ar",a),type:"textarea"})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Misi"]}),e.jsxs("button",{onClick:()=>p("mission",{id:"",en:"",ar:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"space-y-3",children:(ie=c.mission)==null?void 0:ie.map((a,x)=>X(`Poin Misi ${x+1}`,a.id,"",()=>N("mission",x,a),()=>B("mission",x)))})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Core Values"]}),e.jsxs("button",{onClick:()=>p("coreValues",{title:{id:"",en:"",ar:""},icon:"",description:{id:"",en:"",ar:""}}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:(me=c.coreValues)==null?void 0:me.map((a,x)=>{var y,s;return X((y=a.title)==null?void 0:y.id,(s=a.description)==null?void 0:s.id,"",()=>N("coreValues",x,a),()=>B("coreValues",x))})})]})]}),n==="curriculum"&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Intro Kurikulum"]}),e.jsx(j,{label:"Bahasa Indonesia",value:(ue=(be=c.curriculum)==null?void 0:be.intro)==null?void 0:ue.id,onChange:a=>z("curriculum.intro.id",a),type:"textarea"}),e.jsx(j,{label:"English",value:(r=(fe=c.curriculum)==null?void 0:fe.intro)==null?void 0:r.en,onChange:a=>z("curriculum.intro.en",a),type:"textarea"}),e.jsx(j,{label:"Bahasa Arab",value:(d=(i=c.curriculum)==null?void 0:i.intro)==null?void 0:d.ar,onChange:a=>z("curriculum.intro.ar",a),type:"textarea"})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Pilar Kurikulum"]}),e.jsxs("button",{onClick:()=>p("curriculum_pillars",{title:{id:"",en:"",ar:""},icon:"",description:{id:"",en:"",ar:""}}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"space-y-3",children:(R=(L=c.curriculum)==null?void 0:L.pillars)==null?void 0:R.map((a,x)=>{var y,s;return X((y=a.title)==null?void 0:y.id,(s=a.description)==null?void 0:s.id,"",()=>N("curriculum_pillars",x,a),()=>B("curriculum_pillars",x))})})]})]}),n==="stats"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 animate-fade-in-up",children:["students","alumni","teachers","awards"].map(a=>{var x,y,s,f,$,P,he,we,Ce,Fe,Ne,Ae,Ie;return e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsx("h5",{className:"font-bold mb-4 text-slate-800 dark:text-slate-200 capitalize",children:a}),e.jsx(j,{label:"Label Indonesia",value:(s=(y=(x=c.stats)==null?void 0:x[a])==null?void 0:y.label)==null?void 0:s.id,onChange:pe=>z(`stats.${a}.label.id`,pe)}),e.jsx(j,{label:"Label English",value:(P=($=(f=c.stats)==null?void 0:f[a])==null?void 0:$.label)==null?void 0:P.en,onChange:pe=>z(`stats.${a}.label.en`,pe)}),e.jsx(j,{label:"Label Arabic",value:(Ce=(we=(he=c.stats)==null?void 0:he[a])==null?void 0:we.label)==null?void 0:Ce.ar,onChange:pe=>z(`stats.${a}.label.ar`,pe)}),e.jsx("div",{className:"border-t my-4 border-slate-200 dark:border-slate-600"}),e.jsx(j,{label:"Nilai Saat Ini",value:(Ne=(Fe=c.stats)==null?void 0:Fe[a])==null?void 0:Ne.value,onChange:pe=>z(`stats.${a}.value`,parseInt(pe)),type:"number"}),e.jsx(j,{label:"Target / Maksimal",value:(Ie=(Ae=c.stats)==null?void 0:Ae[a])==null?void 0:Ie.max,onChange:pe=>z(`stats.${a}.max`,parseInt(pe)),type:"number"})]},a)})}),n==="team"&&e.jsxs("div",{className:"animate-fade-in-up bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Tim Pengelola"]}),e.jsxs("button",{onClick:()=>p("team",{name:{id:"",en:"",ar:""},role:{id:"",en:"",ar:""},image:"",bio:{id:"",en:"",ar:""},quote:{id:"",en:"",ar:""}}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(G=c.team)==null?void 0:G.slice(0,O).map((a,x)=>{var y,s;return X((y=a.name)==null?void 0:y.id,(s=a.role)==null?void 0:s.id,a.image,()=>N("team",x,a),()=>B("team",x))})}),le(((ve=c.team)==null?void 0:ve.length)||0)]}),n==="gallery"&&e.jsxs("div",{className:"animate-fade-in-up bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Galeri Foto"]}),e.jsxs("button",{onClick:()=>p("gallery",{category:{id:"",en:"",ar:""},title:{id:"",en:"",ar:""},description:{id:"",en:"",ar:""},image:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:(xe=c.gallery)==null?void 0:xe.slice(0,O).map((a,x)=>{var y,s;return X((y=a.title)==null?void 0:y.id,(s=a.category)==null?void 0:s.id,a.image,()=>N("gallery",x,a),()=>B("gallery",x))})}),le(((je=c.gallery)==null?void 0:je.length)||0)]}),n==="news"&&e.jsxs("div",{className:"animate-fade-in-up bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Berita"]}),e.jsxs("button",{onClick:()=>p("news",{title:{id:"",en:"",ar:""},category:{id:"",en:"",ar:""},date:"",description:{id:"",en:"",ar:""},image:"",author:"",source:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(ye=c.news)==null?void 0:ye.slice(0,O).map((a,x)=>{var y;return X((y=a.title)==null?void 0:y.id,a.date,a.image,()=>N("news",x,a),()=>B("news",x))})}),le(((Te=c.news)==null?void 0:Te.length)||0)]}),n==="testimonials"&&e.jsxs("div",{className:"animate-fade-in-up bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Testimoni"]}),e.jsxs("button",{onClick:()=>p("testimonials",{name:{id:"",en:"",ar:""},role:{id:"",en:"",ar:""},quote:{id:"",en:"",ar:""},image:"",rating:5}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:($e=c.testimonials)==null?void 0:$e.slice(0,O).map((a,x)=>{var y,s;return X((y=a.name)==null?void 0:y.id,(s=a.role)==null?void 0:s.id,a.image,()=>N("testimonials",x,a),()=>B("testimonials",x))})}),le(((t=c.testimonials)==null?void 0:t.length)||0)]}),n==="faq"&&e.jsxs("div",{className:"animate-fade-in-up bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," FAQ"]}),e.jsxs("button",{onClick:()=>p("faq",{q:{id:"",en:"",ar:""},a:{id:"",en:"",ar:""}}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"space-y-3",children:(S=c.faq)==null?void 0:S.slice(0,O).map((a,x)=>{var y;return X((y=a.q)==null?void 0:y.id,"","",()=>N("faq",x,a),()=>B("faq",x))})}),le(((Z=c.faq)==null?void 0:Z.length)||0)]})]}),H&&F&&e.jsx("div",{className:"fixed inset-0 z-[200] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-2xl rounded-3xl shadow-2xl relative flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-100 dark:border-slate-800",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora capitalize",children:U!==null?"Edit Data":"Tambah Data"}),e.jsx("button",{onClick:()=>Q(!1),className:"p-2 bg-slate-100 dark:bg-slate-800 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors",children:e.jsx(C.Close,{})})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-4",children:[W==="mission"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Bahasa Indonesia",value:F.id,onChange:a=>I("id",a),type:"textarea"}),e.jsx(j,{label:"English",value:F.en,onChange:a=>I("en",a),type:"textarea"}),e.jsx(j,{label:"Bahasa Arab",value:F.ar,onChange:a=>I("ar",a),type:"textarea"})]}),(W==="coreValues"||W==="curriculum_pillars")&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Icon Key",value:F.icon,onChange:a=>I("icon",a)}),e.jsx(m,{label:"Judul / Title",pathPrefix:"title"}),e.jsx(m,{label:"Deskripsi / Description",pathPrefix:"description",type:"textarea"})]}),W==="team"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Foto URL",value:F.image,onChange:a=>I("image",a),isImage:!0}),e.jsx(m,{label:"Nama",pathPrefix:"name"}),e.jsx(m,{label:"Role / Jabatan",pathPrefix:"role"}),e.jsx(m,{label:"Bio Singkat",pathPrefix:"bio",type:"textarea"}),e.jsx(m,{label:"Kutipan / Quote",pathPrefix:"quote",type:"textarea"})]}),W==="gallery"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Image URL",value:F.image,onChange:a=>I("image",a),isImage:!0}),e.jsx(m,{label:"Judul Foto",pathPrefix:"title"}),e.jsx(m,{label:"Kategori",pathPrefix:"category"}),e.jsx(m,{label:"Deskripsi",pathPrefix:"description",type:"textarea"})]}),W==="news"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Image URL",value:F.image,onChange:a=>I("image",a),isImage:!0}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"Tanggal",value:F.date,onChange:a=>I("date",a)}),e.jsx(j,{label:"Author",value:F.author,onChange:a=>I("author",a)})]}),e.jsx(j,{label:"Source Link",value:F.source,onChange:a=>I("source",a)}),e.jsx(m,{label:"Kategori",pathPrefix:"category"}),e.jsx(m,{label:"Judul Berita",pathPrefix:"title"}),e.jsx(m,{label:"Konten / Deskripsi",pathPrefix:"description",type:"textarea"})]}),W==="testimonials"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Image URL",value:F.image,onChange:a=>I("image",a),isImage:!0}),e.jsx(j,{label:"Rating (1-5)",value:F.rating,onChange:a=>I("rating",parseInt(a)),type:"number"}),e.jsx(m,{label:"Nama",pathPrefix:"name"}),e.jsx(m,{label:"Role / Status",pathPrefix:"role"}),e.jsx(m,{label:"Kutipan / Quote",pathPrefix:"quote",type:"textarea"})]}),W==="faq"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{label:"Pertanyaan (Q)",pathPrefix:"q"}),e.jsx(m,{label:"Jawaban (A)",pathPrefix:"a",type:"textarea"})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-100 dark:border-slate-800 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>Q(!1),className:"px-6 py-2 text-slate-500 font-bold hover:bg-slate-100 rounded-lg transition-colors",children:"Batal"}),e.jsxs("button",{onClick:_,className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-bold shadow-lg transition-transform active:scale-95 flex items-center gap-2",children:[e.jsx(C.Save,{})," Simpan"]})]})]})}),e.jsx("div",{className:"sticky bottom-0 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md p-4 border-t border-slate-100 dark:border-slate-800 flex justify-end -mx-6 -mb-6 rounded-b-3xl",children:e.jsxs("button",{onClick:se,disabled:h,className:"bg-emerald-600 hover:bg-emerald-700 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-emerald-200 dark:shadow-none transition-transform active:scale-95 flex items-center gap-2",children:[h?e.jsx(C.Refresh,{}):e.jsx(C.Save,{})," ",h?"Menyimpan...":"Simpan Perubahan"]})})]})},Le=({label:M,value:n,onChange:w,type:c="text"})=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:[M," (Multi-Bahasa)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsx("input",{type:c,placeholder:"Bahasa Indonesia",className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-sm outline-none",value:(n==null?void 0:n.id)||"",onChange:E=>w({...n,id:E.target.value})}),e.jsx("input",{type:c,placeholder:"English",className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-sm outline-none",value:(n==null?void 0:n.en)||"",onChange:E=>w({...n,en:E.target.value})}),e.jsx("input",{type:c,placeholder:"Bahasa Arab",className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-sm outline-none text-right",value:(n==null?void 0:n.ar)||"",onChange:E=>w({...n,ar:E.target.value})})]})]}),ma=({language:M})=>{var g,oe,X,le,m,ae,re,de,ce,b,T,v,ee,ie,me,be,ue,fe;const[n,w]=o.useState(qe),[c,E]=o.useState("global"),[h,K]=o.useState("mi_alhikmah_mustofa"),[q,H]=o.useState(!1),[Q,W]=o.useState(!1),Y=o.useRef(null),[U,te]=o.useState(6),F=[{id:"global",label:"Global"},{id:"units",label:"Unit"},{id:"achievements",label:"Prestasi"},{id:"articles",label:"Artikel"}];o.useEffect(()=>{V()},[]),o.useEffect(()=>{W(!1),te(6)},[h,c]);const V=async()=>{const r=await De(`${ke}/api/data?type=unit`);if(r){const i=Array.isArray(r)?r[0]:r;i&&(w({...qe,...i}),i.units&&Object.keys(i.units).length>0&&!Object.keys(i.units).includes(h)&&K(Object.keys(i.units)[0]))}},O=async()=>{H(!0);try{await fetch(`${ke}/api/data?type=unit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([n])}),alert("Data Unit Disimpan!"),W(!1)}catch{alert("Gagal menyimpan.")}finally{H(!1)}},D=(r,i)=>{w(d=>{let L=Me(d,r,i);if(i&&typeof i=="object"&&"id"in i){const R=r.split(".");let G=d;for(let je=0;je<R.length;je++)if(G[R[je]])G=G[R[je]];else{G=null;break}const ve=(G==null?void 0:G.id)||"",xe=i.id||"";ve!==xe&&(i.en="",i.ar=""),L=Me(d,r,i)}return L})},u=(r,i,d,L)=>{w(R=>{const G=[...R[r]||[]];return G[i]?(d?(L&&typeof L=="object"&&"id"in L&&(G[i][d]||{}).id!==L.id&&(L.en="",L.ar=""),d.includes(".")?G[i]=Me(G[i],d,L):G[i]={...G[i],[d]:L}):(L&&typeof L=="object"&&"id"in L&&(G[i]||{}).id!==L.id&&(L.en="",L.ar=""),G[i]=L),{...R,[r]:G}):R})},A=(r,i)=>{w(d=>({...d,[r]:[...d[r]||[],i]}))},se=(r,i)=>{w(d=>({...d,[r]:d[r].filter((L,R)=>R!==i)}))},z=(r,i,d,L,R)=>{w(G=>{const ve=G.units[r];if(!ve)return G;const xe=[...ve[i]||[]];if(R&&typeof R=="object"&&"id"in R){let je;L?je=xe[d][L]||{}:je=xe[d]||{},je.id!==R.id&&(R.en="",R.ar="")}return L?L.includes(".")?xe[d]=Me(xe[d],L,R):xe[d]={...xe[d],[L]:R}:xe[d]=R,Me(G,`units.${r}.${i}`,xe)})},p=(r,i,d)=>{w(L=>{var G;const R=((G=L.units[r])==null?void 0:G[i])||[];return Me(L,`units.${r}.${i}`,[...R,d])})},N=(r,i,d)=>{w(L=>{var G;const R=((G=L.units[r])==null?void 0:G[i])||[];return Me(L,`units.${r}.${i}`,R.filter((ve,xe)=>xe!==d))})},I=()=>{const r=JSON.stringify(n,null,2),i="data:application/json;charset=utf-8,"+encodeURIComponent(r),d="unit-data.json",L=document.createElement("a");L.setAttribute("href",i),L.setAttribute("download",d),L.click()},_=r=>{const i=new FileReader;r.target.files&&r.target.files[0]&&(i.readAsText(r.target.files[0],"UTF-8"),i.onload=d=>{var L;if((L=d.target)!=null&&L.result)try{const R=JSON.parse(d.target.result);w({...qe,...R}),alert("Data Unit berhasil diimpor!")}catch(R){alert("Format file JSON tidak valid."),console.error(R)}})},B=r=>r>U?e.jsxs("button",{onClick:()=>te(i=>i+6),className:"w-full py-3 bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-400 font-bold rounded-xl hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors mt-6 text-xs flex items-center justify-center gap-2",children:[e.jsx(C.Refresh,{})," Muat Lebih Banyak (",r-U," lagi)"]}):null;return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 p-6 min-h-[600px]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 border-b border-slate-100 dark:border-slate-800 pb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Manajemen Unit"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Kelola informasi setiap unit pendidikan."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:I,className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-lg text-xs font-bold transition-colors",children:[e.jsx(C.Download,{})," Export JSON"]}),e.jsxs("button",{onClick:()=>{var r;return(r=Y.current)==null?void 0:r.click()},className:"flex items-center gap-2 px-4 py-2 bg-emerald-50 text-emerald-600 hover:bg-emerald-100 rounded-lg text-xs font-bold transition-colors",children:[e.jsx(C.Upload,{})," Import JSON"]}),e.jsx("input",{type:"file",ref:Y,onChange:_,accept:".json",className:"hidden"})]})]}),e.jsx("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-xl overflow-x-auto max-w-full no-scrollbar mb-6",children:F.map(r=>e.jsx("button",{onClick:()=>E(r.id),className:`px-5 py-2 rounded-lg text-sm font-bold transition-all whitespace-nowrap ${c===r.id?"bg-white dark:bg-slate-700 text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:r.label},r.id))}),e.jsxs("div",{className:"pb-20",children:[c==="global"&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Main Settings"]}),e.jsx(j,{label:"Main Logo URL",value:n.logo,onChange:r=>D("logo",r),isImage:!0}),e.jsx(j,{label:"Hero Video URL",value:(g=n.hero)==null?void 0:g.videoUrl,onChange:r=>D("hero.videoUrl",r)})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Kategori"]}),e.jsxs("button",{onClick:()=>A("categories",{id:"",en:"",ar:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),(oe=n.categories)==null?void 0:oe.map((r,i)=>e.jsxs("div",{className:"mb-4 pb-2 border-b border-slate-200 dark:border-slate-700 last:border-0 relative",children:[e.jsx("button",{onClick:()=>se("categories",i),className:"absolute top-0 right-0 text-red-400 hover:text-red-600",children:e.jsx(C.Trash,{})}),e.jsx(Le,{label:`Category ${i+1}`,value:r,onChange:d=>u("categories",i,"",d)})]},i))]})]}),c==="units"&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{className:"w-full md:w-64",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 block mb-1",children:"Pilih Unit Pendidikan"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:h,onChange:r=>K(r.target.value),className:"w-full px-4 py-3 bg-slate-100 dark:bg-slate-800 rounded-xl border-none font-bold text-emerald-600 outline-none appearance-none cursor-pointer",children:Object.keys(n.units||{}).map(r=>{var i,d;return e.jsx("option",{value:r,children:((d=(i=n.units[r])==null?void 0:i.short)==null?void 0:d.id)||r},r)})}),e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]})}),n.units[h]&&e.jsxs(e.Fragment,{children:[!Q&&e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden animate-fade-in-up",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-700 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-slate-50 dark:bg-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white dark:bg-slate-700 rounded-2xl p-2 flex items-center justify-center border border-slate-200 dark:border-slate-600 shadow-sm",children:e.jsx("img",{src:n.units[h].logoImg||n.logo,alt:"Logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:((X=n.units[h].name)==null?void 0:X.id)||"Nama Unit"}),e.jsx("span",{className:"text-sm font-bold text-emerald-600 dark:text-emerald-400",children:((le=n.units[h].short)==null?void 0:le.id)||"Short Name"})]})]}),e.jsxs("button",{onClick:()=>W(!0),className:"px-6 py-2.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-bold shadow-lg transition-transform active:scale-95 flex items-center gap-2",children:[e.jsx(C.Edit,{})," Edit Unit Ini"]})]}),e.jsxs("div",{className:"p-6 md:p-8 space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-start",children:[e.jsxs("div",{className:"w-full md:w-1/3 flex flex-col items-center text-center p-6 bg-slate-50 dark:bg-slate-900 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden border-4 border-white dark:border-slate-700 shadow-md mb-4",children:e.jsx("img",{src:n.units[h].headmasterImg,alt:"Kepala Sekolah",className:"w-full h-full object-cover"})}),e.jsx("h5",{className:"font-bold text-slate-800 dark:text-slate-100 text-lg",children:n.units[h].headmasterName}),e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-widest font-bold mt-1",children:"Kepala Sekolah"})]}),e.jsxs("div",{className:"w-full md:w-2/3 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-slate-400 uppercase mb-2",children:"Deskripsi"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300 leading-relaxed text-sm",children:(m=n.units[h].desc)==null?void 0:m.id})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-slate-400 uppercase mb-2",children:"Visi"}),e.jsxs("p",{className:"text-slate-700 dark:text-slate-300 italic font-lora text-lg",children:['"',(ae=n.units[h].vision)==null?void 0:ae.id,'"']})]})]})]}),((re=n.units[h].profileMedia)==null?void 0:re.url)&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-slate-400 uppercase mb-3",children:"Media Profil"}),e.jsxs("div",{className:"aspect-video rounded-xl overflow-hidden bg-black relative group",children:[e.jsx("img",{src:n.units[h].profileMedia.thumbnail||n.units[h].profileMedia.url,className:"w-full h-full object-cover opacity-80",alt:"Media"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"bg-white/20 backdrop-blur-md p-3 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8.118v3.764a1 1 0 001.555.832l3.198-1.882a1 1 0 000-1.664l-3.198-1.882z",clipRule:"evenodd"})})})})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 pt-6 border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-slate-400 uppercase mb-4",children:"Misi"}),e.jsx("ul",{className:"space-y-2",children:(de=n.units[h].mission)==null?void 0:de.map((r,i)=>e.jsxs("li",{className:"flex gap-3 text-sm text-slate-600 dark:text-slate-300",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:i+1}),r.id]},i))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-slate-400 uppercase mb-4",children:"Program Unggulan"}),e.jsx("div",{className:"space-y-3",children:(ce=n.units[h].programs)==null?void 0:ce.map((r,i)=>{var d,L;return e.jsxs("div",{className:"flex gap-3 items-center bg-slate-50 dark:bg-slate-900 p-3 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"p-2 bg-white dark:bg-slate-800 rounded-lg shadow-sm",children:e.jsx("span",{className:"text-lg",children:"✨"})}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-bold text-sm text-slate-800 dark:text-slate-200",children:(d=r.title)==null?void 0:d.id}),e.jsx("p",{className:"text-xs text-slate-500",children:(L=r.desc)==null?void 0:L.id})]})]},i)})})]})]})]})]}),Q&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs("button",{onClick:()=>W(!1),className:"px-4 py-2 bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-200 rounded-lg font-bold text-sm hover:bg-slate-300 transition-colors flex items-center gap-2",children:[e.jsx(C.Close,{})," Batal Edit"]})}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Informasi Dasar"]}),e.jsx(Le,{label:"Nama Unit",value:n.units[h].name,onChange:r=>D(`units.${h}.name`,r)}),e.jsx(Le,{label:"Nama Pendek",value:n.units[h].short,onChange:r=>D(`units.${h}.short`,r)}),e.jsx(Le,{label:"Deskripsi",value:n.units[h].desc,onChange:r=>D(`units.${h}.desc`,r),type:"textarea"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsx(j,{label:"Nama Kepala Sekolah",value:n.units[h].headmasterName,onChange:r=>D(`units.${h}.headmasterName`,r)}),e.jsx(j,{label:"Foto Kepala Sekolah",value:n.units[h].headmasterImg,onChange:r=>D(`units.${h}.headmasterImg`,r),isImage:!0}),e.jsx(j,{label:"Logo Unit",value:n.units[h].logoImg,onChange:r=>D(`units.${h}.logoImg`,r),isImage:!0})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Media Profil & Visi"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Type"}),e.jsxs("select",{value:(b=n.units[h].profileMedia)==null?void 0:b.type,onChange:r=>D(`units.${h}.profileMedia.type`,r.target.value),className:"w-full px-3 py-2 bg-white dark:bg-slate-900 rounded-lg border border-slate-200 dark:border-slate-700 text-sm outline-none",children:[e.jsx("option",{value:"image",children:"Image"}),e.jsx("option",{value:"video",children:"Video"})]})]}),e.jsx(j,{label:"URL Media",value:(T=n.units[h].profileMedia)==null?void 0:T.url,onChange:r=>D(`units.${h}.profileMedia.url`,r),isImage:!0}),e.jsx(j,{label:"Thumbnail",value:(v=n.units[h].profileMedia)==null?void 0:v.thumbnail,onChange:r=>D(`units.${h}.profileMedia.thumbnail`,r),isImage:!0})]}),e.jsx(Le,{label:"Visi",value:n.units[h].vision,onChange:r=>D(`units.${h}.vision`,r),type:"textarea"})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Misi"]}),e.jsxs("button",{onClick:()=>p(h,"mission",{id:"",en:"",ar:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),(ee=n.units[h].mission)==null?void 0:ee.map((r,i)=>e.jsxs("div",{className:"mb-4 pb-2 border-b border-slate-200 dark:border-slate-700 last:border-0 relative",children:[e.jsx("button",{onClick:()=>N(h,"mission",i),className:"absolute top-0 right-0 text-red-400 hover:text-red-600",children:e.jsx(C.Trash,{})}),e.jsx(Le,{label:`Poin ${i+1}`,value:r,onChange:d=>z(h,"mission",i,"",d)})]},i))]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Program Unggulan"]}),e.jsxs("button",{onClick:()=>p(h,"programs",{title:{id:"",en:"",ar:""},desc:{id:"",en:"",ar:""},icon:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),(ie=n.units[h].programs)==null?void 0:ie.map((r,i)=>e.jsxs("div",{className:"mb-6 pb-4 border-b border-slate-200 dark:border-slate-700 last:border-0 relative",children:[e.jsx("button",{onClick:()=>N(h,"programs",i),className:"absolute top-0 right-0 text-red-400 hover:text-red-600",children:e.jsx(C.Trash,{})}),e.jsx(j,{label:"Icon Key",value:r.icon,onChange:d=>z(h,"programs",i,"icon",d)}),e.jsx(Le,{label:"Judul Program",value:r.title,onChange:d=>z(h,"programs",i,"title",d)}),e.jsx(Le,{label:"Deskripsi Program",value:r.desc,onChange:d=>z(h,"programs",i,"desc",d)})]},i))]})]})]})]}),c==="achievements"&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Daftar Prestasi"]}),e.jsxs("button",{onClick:()=>A("achievements",{name:{id:"",en:"",ar:""},title:{id:"",en:"",ar:""},category:{id:"",en:"",ar:""},story:{id:"",en:"",ar:""},image:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),(me=n.achievements)==null?void 0:me.slice(0,U).map((r,i)=>e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700 mb-4 relative",children:[e.jsx("button",{onClick:()=>se("achievements",i),className:"absolute top-4 right-4 text-red-400 hover:text-red-600",children:e.jsx(C.Trash,{})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{label:"Image URL",value:r.image,onChange:d=>u("achievements",i,"image",d),isImage:!0}),e.jsx(Le,{label:"Nama",value:r.name,onChange:d=>u("achievements",i,"name",d)}),e.jsx(Le,{label:"Judul Prestasi",value:r.title,onChange:d=>u("achievements",i,"title",d)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Le,{label:"Kategori",value:r.category,onChange:d=>u("achievements",i,"category",d)}),e.jsx(Le,{label:"Cerita / Deskripsi",value:r.story,onChange:d=>u("achievements",i,"story",d),type:"textarea"})]})]})]},i)),B(((be=n.achievements)==null?void 0:be.length)||0)]}),c==="articles"&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Artikel Cerita"]}),e.jsxs("button",{onClick:()=>A("articles",{title:{id:"",en:"",ar:""},teaser:{id:"",en:"",ar:""},content:{id:"",en:"",ar:""},image:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),(ue=n.articles)==null?void 0:ue.slice(0,U).map((r,i)=>e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700 mb-4 relative",children:[e.jsx("button",{onClick:()=>se("articles",i),className:"absolute top-4 right-4 text-red-400 hover:text-red-600",children:e.jsx(C.Trash,{})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{label:"Image URL",value:r.image,onChange:d=>u("articles",i,"image",d),isImage:!0}),e.jsx(Le,{label:"Judul",value:r.title,onChange:d=>u("articles",i,"title",d)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Le,{label:"Teaser",value:r.teaser,onChange:d=>u("articles",i,"teaser",d)}),e.jsx(Le,{label:"Konten",value:r.content,onChange:d=>u("articles",i,"content",d),type:"textarea"})]})]})]},i)),B(((fe=n.articles)==null?void 0:fe.length)||0)]})]}),e.jsx("div",{className:"sticky bottom-0 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md p-4 border-t border-slate-100 dark:border-slate-800 flex justify-end -mx-6 -mb-6 rounded-b-3xl",children:e.jsxs("button",{onClick:O,disabled:q,className:"bg-emerald-600 hover:bg-emerald-700 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-emerald-200 dark:shadow-none transition-transform active:scale-95 flex items-center gap-2",children:[q?e.jsx(C.Refresh,{}):e.jsx(C.Save,{})," ",q?"Menyimpan...":"Simpan Perubahan"]})})]})},ua=({language:M,setHideNav:n})=>{var le,m,ae,re,de,ce,b,T,v,ee,ie,me,be,ue,fe,r,i,d,L,R,G,ve,xe,je,ye,Te,$e;const[w,c]=o.useState("siswa"),[E,h]=o.useState([]),[K,q]=o.useState([]),[H,Q]=o.useState([]),[W,Y]=o.useState(!1),[U,te]=o.useState(""),[F,V]=o.useState(!1),[O,D]=o.useState("siswa"),[u,A]=o.useState(null),[se,z]=o.useState("identitas"),p=[{id:"siswa",label:"Data Siswa"},{id:"pegawai",label:"Data Pegawai"},{id:"akun",label:"Data Akun"}];o.useEffect(()=>{N()},[]),o.useEffect(()=>{te("")},[w]),o.useEffect(()=>(F?(document.body.style.overflow="hidden",n&&n(!0)):(document.body.style.overflow="",n&&n(!1)),()=>{document.body.style.overflow="",n&&n(!1)}),[F,n]);const N=async()=>{Y(!0);const[t,S,Z]=await Promise.all([De(`${ke}/api/data?type=siswa`),De(`${ke}/api/data?type=pegawai`),De(`${ke}/api/accounts`)]);t&&h(Array.isArray(t)?t:[]),S&&q(Array.isArray(S)?S:[]),Z&&Q(Array.isArray(Z)?Z:[]),Y(!1)},_=(()=>{const t=U.toLowerCase();return w==="siswa"?t?E.filter(S=>{var Z,a,x;return((Z=S.identitas)==null?void 0:Z.nama)&&S.identitas.nama.toLowerCase().includes(t)||S.nisn&&S.nisn.toLowerCase().includes(t)||((a=S.status)==null?void 0:a.kelas)&&S.status.kelas.toLowerCase().includes(t)||((x=S.status)==null?void 0:x.sekolah)&&S.status.sekolah.toLowerCase().includes(t)}):E:w==="pegawai"?t?K.filter(S=>{var Z,a;return((Z=S.identitas)==null?void 0:Z.nama)&&S.identitas.nama.toLowerCase().includes(t)||S.nip&&S.nip.toLowerCase().includes(t)||((a=S.statusKepegawaian)==null?void 0:a.jabatan)&&S.statusKepegawaian.jabatan.toLowerCase().includes(t)}):K:t?H.filter(S=>S.nama&&S.nama.toLowerCase().includes(t)||S.email&&S.email.toLowerCase().includes(t)||S.telpon&&S.telpon.toLowerCase().includes(t)||S.sebagai&&S.sebagai.toLowerCase().includes(t)||S.uniquecode&&S.uniquecode.toLowerCase().includes(t)):H})(),B=(t,S)=>{D(t),A(S?JSON.parse(JSON.stringify(S)):t==="siswa"?{...la}:t==="pegawai"?{...ra}:{...na}),z("identitas"),V(!0)},g=(t,S)=>{A(Z=>Me(Z,t,S))},oe=async()=>{if(!u)return;Y(!0);const t=O;let S,Z=t;if(t==="siswa")S=[...E.filter(x=>x.nisn!==u.nisn),u],h(S);else if(t==="pegawai")S=[...K.filter(x=>x.nip!==u.nip),u],q(S);else{Z="account";let a={...u};if(!a.idAccount){const s={parrent:"WS",teacher:"GR",staff:"ST",admin:"AD",user:"PG"}[a.sebagai]||"PG",f=Math.floor(1e3+Math.random()*9e3);a.idAccount=`MHAC-${s}-${f}-${Date.now().toString().slice(-4)}`,a.createdAt=new Date().toISOString()}S=[...H.filter(y=>y.idAccount!==a.idAccount),a],Q(S),A(a)}try{await fetch(`${ke}/api/data?type=${Z}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(S)}),alert("Data berhasil disimpan!"),V(!1),A(null)}catch(a){alert("Gagal menyimpan data."),console.error(a),N()}finally{Y(!1)}},X=async(t,S)=>{if(!confirm("Apakah Anda yakin ingin menghapus data ini?"))return;Y(!0);let Z,a=S;S==="siswa"?(Z=E.filter(x=>x.nisn!==t),h(Z)):S==="pegawai"?(Z=K.filter(x=>x.nip!==t),q(Z)):(a="account",Z=H.filter(x=>x.idAccount!==t),Q(Z));try{await fetch(`${ke}/api/data?type=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Z)})}catch{alert("Gagal menghapus data."),N()}finally{Y(!1)}};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 p-6 min-h-[600px]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 border-b border-slate-100 dark:border-slate-800 pb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Pusat Data"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Kelola data induk Siswa, Pegawai, dan Akun."})]}),e.jsx("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-xl overflow-x-auto max-w-full",children:p.map(t=>e.jsx("button",{onClick:()=>c(t.id),className:`px-5 py-2 rounded-lg text-sm font-bold transition-all whitespace-nowrap ${w===t.id?"bg-white dark:bg-slate-700 text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:t.label},t.id))})]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4 animate-fade-in-up",children:[e.jsxs("h4",{className:"font-bold text-lg text-slate-700 dark:text-slate-200",children:["Daftar ",w.charAt(0).toUpperCase()+w.slice(1)," ",e.jsxs("span",{className:"text-slate-400 text-sm font-normal",children:["(",_.length,")"]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2 w-full md:w-auto",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("input",{type:"text",placeholder:`Cari ${w}...`,value:U,onChange:t=>te(t.target.value),className:"w-full pl-9 pr-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-emerald-500 transition-all"}),e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>B(w),className:"bg-emerald-100 text-emerald-700 px-4 py-2 rounded-lg text-sm font-bold flex items-center justify-center gap-2 hover:bg-emerald-200 transition-colors shadow-sm whitespace-nowrap flex-grow md:flex-grow-0",children:[e.jsx(C.Plus,{})," ",e.jsx("span",{className:"hidden md:inline",children:"Tambah"})]}),e.jsx("button",{onClick:N,className:"p-2 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-600 transition-colors",children:e.jsx(C.Refresh,{})})]})]})]}),W&&e.jsx("div",{className:"flex justify-center py-10",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"})}),!W&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 animate-fade-in-up",children:[w==="siswa"&&(_.length===0?e.jsx("div",{className:"col-span-full text-center py-20 text-slate-400 italic",children:"Data siswa tidak ditemukan."}):_.map((t,S)=>{var Z,a,x,y,s;return e.jsxs("div",{className:"bg-white dark:bg-slate-800 border border-slate-100 dark:border-slate-700 hover:border-emerald-200 dark:hover:border-emerald-800 hover:shadow-lg rounded-2xl p-4 flex gap-4 transition-all duration-300 group relative",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-700 overflow-hidden flex-shrink-0 border-2 border-white dark:border-slate-600 shadow-sm",children:e.jsx("img",{src:((Z=t.identitas)==null?void 0:Z.foto)||`https://ui-avatars.com/api/?name=${(a=t.identitas)==null?void 0:a.nama}&background=random`,alt:"Foto",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100 truncate",children:(x=t.identitas)==null?void 0:x.nama}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-mono mb-2",children:t.nisn}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 text-[10px] font-bold rounded uppercase",children:(y=t.status)==null?void 0:y.sekolah}),e.jsx("span",{className:"px-2 py-0.5 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 text-[10px] font-bold rounded uppercase",children:(s=t.status)==null?void 0:s.kelas})]})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity bg-white/90 dark:bg-slate-800/90 p-1 rounded-lg shadow-sm",children:[e.jsx("button",{onClick:()=>B("siswa",t),className:"text-blue-500 hover:text-blue-700 p-1",children:e.jsx(C.Edit,{})}),e.jsx("button",{onClick:()=>X(t.nisn,"siswa"),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(C.Trash,{})})]})]},S)})),w==="pegawai"&&(_.length===0?e.jsx("div",{className:"col-span-full text-center py-20 text-slate-400 italic",children:"Data pegawai tidak ditemukan."}):_.map((t,S)=>{var Z,a,x,y,s,f,$;return e.jsxs("div",{className:"bg-white dark:bg-slate-800 border border-slate-100 dark:border-slate-700 hover:border-emerald-200 dark:hover:border-emerald-800 hover:shadow-lg rounded-2xl p-4 flex gap-4 transition-all duration-300 group relative",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-700 overflow-hidden flex-shrink-0 border-2 border-white dark:border-slate-600 shadow-sm",children:e.jsx("img",{src:((Z=t.identitas)==null?void 0:Z.foto)||`https://ui-avatars.com/api/?name=${(a=t.identitas)==null?void 0:a.nama}&background=random`,alt:"Foto",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsxs("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100 truncate",children:[(x=t.identitas)==null?void 0:x.gelar_depan," ",(y=t.identitas)==null?void 0:y.nama," ",(s=t.identitas)==null?void 0:s.gelar_belakang]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-mono mb-2",children:t.nip||"-"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 text-[10px] font-bold rounded uppercase",children:(f=t.statusKepegawaian)==null?void 0:f.jabatan}),e.jsx("span",{className:"px-2 py-0.5 bg-purple-50 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 text-[10px] font-bold rounded uppercase",children:($=t.statusKepegawaian)==null?void 0:$.jenisGuru})]})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity bg-white/90 dark:bg-slate-800/90 p-1 rounded-lg shadow-sm",children:[e.jsx("button",{onClick:()=>B("pegawai",t),className:"text-blue-500 hover:text-blue-700 p-1",children:e.jsx(C.Edit,{})}),e.jsx("button",{onClick:()=>X(t.nip,"pegawai"),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(C.Trash,{})})]})]},S)})),w==="akun"&&(_.length===0?e.jsx("div",{className:"col-span-full text-center py-20 text-slate-400 italic",children:"Data akun tidak ditemukan."}):_.map((t,S)=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 border border-slate-100 dark:border-slate-700 hover:border-emerald-200 dark:hover:border-emerald-800 hover:shadow-lg rounded-2xl p-4 flex gap-4 transition-all duration-300 group relative",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 flex items-center justify-center font-bold text-2xl flex-shrink-0 border-2 border-white dark:border-slate-600 shadow-sm",children:t.nama?t.nama.charAt(0).toUpperCase():"?"}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100 truncate",children:t.nama}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono mb-1 truncate",children:t.email||"-"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono mb-2 truncate",children:t.telpon}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:`px-2 py-0.5 text-[10px] font-bold rounded uppercase ${t.sebagai==="admin"?"bg-red-50 text-red-700":"bg-blue-50 text-blue-700"}`,children:t.sebagai}),t.uniquecode&&e.jsx("span",{className:"px-2 py-0.5 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 text-[10px] font-bold rounded font-mono",children:t.uniquecode})]})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity bg-white/90 dark:bg-slate-800/90 p-1 rounded-lg shadow-sm",children:[e.jsx("button",{onClick:()=>B("akun",t),className:"text-blue-500 hover:text-blue-700 p-1",children:e.jsx(C.Edit,{})}),e.jsx("button",{onClick:()=>X(t.idAccount,"akun"),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(C.Trash,{})})]})]},S)))]}),F&&u&&e.jsx("div",{className:"fixed inset-0 z-[200] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-2xl rounded-3xl shadow-2xl relative flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-100 dark:border-slate-800",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:(le=u.identitas)!=null&&le.nama||u.nama?`Edit ${O.charAt(0).toUpperCase()+O.slice(1)}`:`Tambah ${O.charAt(0).toUpperCase()+O.slice(1)}`}),e.jsx("button",{onClick:()=>V(!1),className:"p-2 bg-slate-100 dark:bg-slate-800 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors",children:e.jsx(C.Close,{})})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto p-6",children:[(O==="siswa"||O==="pegawai")&&e.jsx("div",{className:"flex gap-2 mb-6 border-b border-slate-100 pb-2 overflow-x-auto scrollbar-hide",children:["identitas","alamat",O==="siswa"?"status":"statusKepegawaian",O==="siswa"?"orangtua":"kontakDarurat"].map(t=>e.jsx("button",{onClick:()=>z(t),className:`px-4 py-2 rounded-lg text-sm font-bold capitalize whitespace-nowrap ${se===t?"bg-emerald-600 text-white":"bg-slate-100 text-slate-500"}`,children:t.replace(/([A-Z])/g," $1").trim()},t))}),e.jsxs("div",{className:"space-y-4",children:[se==="identitas"&&(O==="siswa"||O==="pegawai")&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Nama Lengkap",value:(m=u.identitas)==null?void 0:m.nama,onChange:t=>g("identitas.nama",t)}),O==="siswa"?e.jsx(j,{label:"NISN (Wajib & Unik)",value:u.nisn,onChange:t=>g("nisn",t)}):e.jsx(j,{label:"NIP (Jika ada)",value:u.nip,onChange:t=>g("nip",t)}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"Tempat Lahir",value:(ae=u.identitas)==null?void 0:ae.tempat_lahir,onChange:t=>g("identitas.tempat_lahir",t)}),e.jsx(j,{label:"Tanggal Lahir",type:"date",value:(re=u.identitas)==null?void 0:re.tanggal_lahir,onChange:t=>g("identitas.tanggal_lahir",t)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Jenis Kelamin"}),e.jsxs("select",{value:(de=u.identitas)==null?void 0:de.jenis_kelamin,onChange:t=>g("identitas.jenis_kelamin",t.target.value),className:"w-full px-3 py-2 bg-slate-50 rounded-lg border border-slate-200 text-sm outline-none",children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"L",children:"Laki-laki"}),e.jsx("option",{value:"P",children:"Perempuan"})]})]}),e.jsx(j,{label:"No. Telepon",value:(ce=u.identitas)==null?void 0:ce.telpon,onChange:t=>g("identitas.telpon",t)})]}),e.jsx(j,{label:"Email",type:"email",value:(b=u.identitas)==null?void 0:b.email,onChange:t=>g("identitas.email",t)}),e.jsx(j,{label:"Foto URL",value:(T=u.identitas)==null?void 0:T.foto,onChange:t=>g("identitas.foto",t),isImage:!0})]}),se==="alamat"&&(O==="siswa"||O==="pegawai")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"Provinsi",value:(v=u.alamat)==null?void 0:v.provinsi,onChange:t=>g("alamat.provinsi",t)}),e.jsx(j,{label:"Kota/Kab",value:(ee=u.alamat)==null?void 0:ee.kota,onChange:t=>g("alamat.kota",t)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"Kecamatan",value:(ie=u.alamat)==null?void 0:ie.kec,onChange:t=>g("alamat.kec",t)}),e.jsx(j,{label:"Desa/Kel",value:(me=u.alamat)==null?void 0:me.desa,onChange:t=>g("alamat.desa",t)})]}),e.jsx(j,{label:"Detail Alamat",type:"textarea",value:(be=u.alamat)==null?void 0:be.detail,onChange:t=>g("alamat.detail",t)})]}),se==="status"&&O==="siswa"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Sekolah"}),e.jsxs("select",{value:(ue=u.status)==null?void 0:ue.sekolah,onChange:t=>g("status.sekolah",t.target.value),className:"w-full px-3 py-2 bg-slate-50 rounded-lg border border-slate-200 text-sm outline-none",children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"mi",children:"MI Al-Hikmah"}),e.jsx("option",{value:"mtsn",children:"MTsN 2 Purwakarta"}),e.jsx("option",{value:"smpbp",children:"SMP BP"}),e.jsx("option",{value:"smksit",children:"SMKS IT"}),e.jsx("option",{value:"ma",children:"MA Minnatul Huda"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"Kelas",value:(fe=u.status)==null?void 0:fe.kelas,onChange:t=>g("status.kelas",t)}),e.jsx(j,{label:"Jurusan (SMK)",value:(r=u.status)==null?void 0:r.jurusan,onChange:t=>g("status.jurusan",t)})]}),e.jsx(j,{label:"Tinggal (Asrama/Pulang)",value:(i=u.status)==null?void 0:i.tinggal,onChange:t=>g("status.tinggal",t)})]}),se==="statusKepegawaian"&&O==="pegawai"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Jabatan",value:(d=u.statusKepegawaian)==null?void 0:d.jabatan,onChange:t=>g("statusKepegawaian.jabatan",t)}),e.jsx(j,{label:"Jenis Guru",value:(L=u.statusKepegawaian)==null?void 0:L.jenisGuru,onChange:t=>g("statusKepegawaian.jenisGuru",t)}),e.jsx(j,{label:"Mulai Bertugas",type:"date",value:(R=u.statusKepegawaian)==null?void 0:R.mulaiBertugas,onChange:t=>g("statusKepegawaian.mulaiBertugas",t)})]}),se==="orangtua"&&O==="siswa"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Nama Ayah",value:(G=u.orangtua)==null?void 0:G.nama_ayah,onChange:t=>g("orangtua.nama_ayah",t)}),e.jsx(j,{label:"Pekerjaan Ayah",value:(ve=u.orangtua)==null?void 0:ve.pekerjaan_ayah,onChange:t=>g("orangtua.pekerjaan_ayah",t)}),e.jsx(j,{label:"Nama Ibu",value:(xe=u.orangtua)==null?void 0:xe.nama_ibu,onChange:t=>g("orangtua.nama_ibu",t)}),e.jsx(j,{label:"No. Telpon Ortu",value:(je=u.orangtua)==null?void 0:je.telpon_ayah,onChange:t=>g("orangtua.telpon_ayah",t)})]}),se==="kontakDarurat"&&O==="pegawai"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Nama Kontak",value:(ye=u.kontakDarurat)==null?void 0:ye.nama,onChange:t=>g("kontakDarurat.nama",t)}),e.jsx(j,{label:"Hubungan",value:(Te=u.kontakDarurat)==null?void 0:Te.hubungan,onChange:t=>g("kontakDarurat.hubungan",t)}),e.jsx(j,{label:"Nomor Telepon",value:($e=u.kontakDarurat)==null?void 0:$e.telpon,onChange:t=>g("kontakDarurat.telpon",t)})]}),O==="akun"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Nama Akun",value:u.nama,onChange:t=>g("nama",t)}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Role"}),e.jsxs("select",{value:u.sebagai,onChange:t=>g("sebagai",t.target.value),className:"w-full px-3 py-2 bg-slate-50 rounded-lg border border-slate-200 text-sm outline-none",children:[e.jsx("option",{value:"user",children:"User / Pengunjung"}),e.jsx("option",{value:"parrent",children:"Wali Santri (WS)"}),e.jsx("option",{value:"teacher",children:"Guru (GR)"}),e.jsx("option",{value:"staff",children:"Staff (ST)"}),e.jsx("option",{value:"admin",children:"Administrator (AD)"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"No. Telepon",value:u.telpon,onChange:t=>g("telpon",t)}),e.jsx(j,{label:"Unique Code (NISN)",value:u.uniquecode,onChange:t=>g("uniquecode",t)})]}),e.jsx(j,{label:"Email",type:"email",value:u.email,onChange:t=>g("email",t)}),e.jsx(j,{label:"Password",value:u.password,onChange:t=>g("password",t)}),u.idAccount&&e.jsxs("div",{className:"mt-4 p-3 bg-slate-100 dark:bg-slate-800 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"ID Account (Auto-generated)"}),e.jsx("p",{className:"font-mono font-bold text-sm",children:u.idAccount})]})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-100 dark:border-slate-800 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>V(!1),className:"px-6 py-2 text-slate-500 font-bold hover:bg-slate-100 rounded-lg transition-colors",children:"Batal"}),e.jsxs("button",{onClick:oe,disabled:W,className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-bold shadow-lg transition-transform active:scale-95 flex items-center gap-2",children:[W?e.jsx(C.Refresh,{}):e.jsx(C.Save,{})," Simpan Data"]})]})]})})]})},ha=({language:M})=>{var z;const[n,w]=o.useState("mi"),[c,E]=o.useState(null),[h,K]=o.useState(!1),[q,H]=o.useState({tetap:!1,semesteran:!1,bulanan:!1}),[Q,W]=o.useState({}),Y=[{id:"mi",label:"MI"},{id:"smpbp",label:"SMPBP"},{id:"mtsn",label:"MTSN"},{id:"smksit",label:"SMKSIT"},{id:"ma",label:"MA"}];o.useEffect(()=>{U(),W({})},[n]);const U=async()=>{K(!0);const p=await De(`${ke}/api/data?type=template_biaya_${n}`);if(p){const N=Array.isArray(p)?p[0]:p;E(N||{tetap:[],semesteran:[],bulanan:[]})}else E({tetap:[],semesteran:[],bulanan:[]});K(!1)},te=p=>{H(N=>({...N,[p]:!N[p]}))},F=(p,N,I,_)=>{const g=(_[p]||[]).some((X,le)=>le!==N&&X.biaya.trim().toLowerCase()===I.trim().toLowerCase()),oe=`${p}-${N}`;W(X=>{const le={...X};return g?le[oe]="Pastikan keterangan Judul tidak sama agar mudah di identifikasi":delete le[oe],le})},V=(p,N,I)=>{E(_=>{if(!_)return _;const B=[..._[p]||[]];B[N]={...B[N],biaya:I};const g={..._,[p]:B};return F(p,N,I,g),g})},O=(p,N,I)=>{E(_=>{if(!_)return _;const B=[..._[p]||[]];return B[N]={...B[N],amount:parseInt(I)||0},{..._,[p]:B}})},D=p=>{E(N=>{const I=N||{tetap:[],semesteran:[],bulanan:[]};return{...I,[p]:[...I[p]||[],{biaya:"",amount:0}]}}),H(N=>({...N,[p]:!0}))},u=(p,N)=>{E(I=>{if(!I)return I;const _=[...I[p]||[]];return _.splice(N,1),{...I,[p]:_}}),W(I=>{const _={};return Object.keys(I).forEach(B=>{const[g,oe]=B.split("-"),X=parseInt(oe);if(g!==p){_[B]=I[B];return}X<N?_[B]=I[B]:X>N&&(_[`${g}-${X-1}`]=I[B])}),_})},A=async()=>{if(Object.keys(Q).length>0){alert("Terdapat duplikasi nama biaya. Harap perbaiki sebelum menyimpan.");return}K(!0);try{await fetch(`${ke}/api/data?type=template_biaya_${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([c])}),alert("Data Pembiayaan Disimpan!")}catch(p){alert("Gagal menyimpan data."),console.error(p)}finally{K(!1)}},se=(p,N)=>{const I=(c==null?void 0:c[N])||[],_=q[N];return e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-2xl border border-slate-100 dark:border-slate-700 mb-4 overflow-hidden transition-all duration-300",children:[e.jsxs("div",{onClick:()=>te(N),className:"flex justify-between items-center p-6 cursor-pointer bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-8 h-8 rounded-full flex items-center justify-center text-emerald-600 bg-emerald-50 dark:bg-emerald-900/30 transition-transform duration-300 ${_?"rotate-90":""}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-700 dark:text-slate-200 text-lg",children:p}),e.jsxs("p",{className:"text-xs text-slate-400 font-medium",children:[I.length," Item Biaya"]})]})]}),e.jsx("div",{className:"text-slate-400",children:_?"Sembunyikan":"Tampilkan"})]}),_&&e.jsxs("div",{className:"p-6 border-t border-slate-100 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/50 animate-fade-in-down",children:[e.jsx("div",{className:"space-y-3",children:I.length===0?e.jsx("p",{className:"text-center text-slate-400 text-sm italic py-4",children:"Belum ada data biaya."}):I.map((B,g)=>{const oe=Q[`${N}-${g}`];return e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm flex flex-col md:flex-row items-start md:items-center gap-4 group",children:[e.jsxs("div",{className:"flex-grow w-full md:w-auto",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider mb-1 block",children:"Nama Item Biaya"}),e.jsx("input",{type:"text",value:B.biaya,onChange:X=>V(N,g,X.target.value),className:`w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border rounded-lg text-slate-700 dark:text-slate-200 font-medium text-sm focus:ring-2 outline-none ${oe?"border-red-500 focus:ring-red-200":"border-slate-200 dark:border-slate-700 focus:ring-emerald-500"}`,placeholder:"Contoh: SPP Januari"}),oe&&e.jsxs("p",{className:"text-[10px] text-red-500 font-bold mt-1 flex items-center gap-1 animate-pulse",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),oe]})]}),e.jsxs("div",{className:"w-full md:w-48",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider mb-1 block",children:"Nominal (Rp)"}),e.jsx("input",{type:"number",value:B.amount,onChange:X=>O(N,g,X.target.value),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-emerald-600 font-mono font-bold text-sm focus:ring-2 focus:ring-emerald-500 outline-none",placeholder:"0"})]}),e.jsx("button",{type:"button",onClick:()=>u(N,g),className:"p-2 md:mt-5 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all",title:"Hapus Item",children:e.jsx(C.Trash,{})})]},`${N}-${g}`)})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsxs("button",{onClick:()=>D(N),className:"flex items-center gap-2 px-4 py-2 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 text-xs font-bold rounded-lg hover:bg-emerald-100 transition-colors",children:[e.jsx(C.Plus,{})," Tambah Item Baru"]})})]})]})};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 p-6 min-h-[600px]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 border-b border-slate-100 dark:border-slate-800 pb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Manajemen Pembiayaan"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Atur template biaya untuk setiap unit pendidikan."})]}),e.jsx("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-xl overflow-x-auto max-w-full",children:Y.map(p=>e.jsx("button",{onClick:()=>w(p.id),className:`px-5 py-2 rounded-lg text-sm font-bold transition-all whitespace-nowrap ${n===p.id?"bg-white dark:bg-slate-700 text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:p.label},p.id))})]}),h?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 border-4 border-emerald-100 border-t-emerald-600 rounded-full animate-spin"}),e.jsx("span",{className:"text-slate-400 text-sm font-bold animate-pulse",children:"Memuat Data..."})]})}):e.jsxs("div",{className:"animate-fade-in-up pb-20",children:[se("Biaya Tetap (Awal Masuk)","tetap"),se("Biaya Semesteran","semesteran"),se("Biaya Bulanan (SPP)","bulanan"),e.jsx("div",{className:"sticky bottom-0 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md p-4 border-t border-slate-100 dark:border-slate-800 flex justify-end -mx-6 -mb-6 rounded-b-3xl z-10",children:e.jsxs("button",{onClick:A,disabled:h,className:"bg-emerald-600 hover:bg-emerald-700 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-emerald-200 dark:shadow-none transition-transform active:scale-95 flex items-center gap-2",children:[e.jsx(C.Save,{})," Simpan Perubahan ",(z=Y.find(p=>p.id===n))==null?void 0:z.label]})})]})]})},ba=({user:M,language:n,onLogout:w,activeTab:c="overview",setAdminTab:E,setHideNav:h})=>{const[K,q]=o.useState({transactions:0,students:0,teachers:0,accounts:0}),[H,Q]=o.useState(!1);o.useEffect(()=>{c==="overview"&&W()},[c]);const W=async()=>{Q(!0);try{const[U,te,F,V]=await Promise.all([De(`${ke}/api/data?type=all_transactions`),De(`${ke}/api/data?type=siswa`),De(`${ke}/api/data?type=pegawai`),De(`${ke}/api/accounts`)]);let O=0;U&&Array.isArray(U)&&(O=U.length),q({transactions:O,students:Array.isArray(te)?te.length:0,teachers:Array.isArray(F)?F.length:0,accounts:Array.isArray(V)?V.length:0})}catch(U){console.error("Failed to fetch stats",U)}finally{Q(!1)}},Y=U=>{E&&(E(U),window.scrollTo(0,0))};return e.jsx("div",{className:"bg-transparent min-h-screen pt-24 pb-20 px-4",dir:n==="ar"?"rtl":"ltr",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[c==="overview"&&e.jsxs("div",{className:"animate-fade-in-up",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Ringkasan Dashboard"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Selamat datang kembali, Administrator."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 md:gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-3 md:p-6 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 flex flex-col md:flex-row items-center gap-2 md:gap-4 text-center md:text-left",children:[e.jsx("div",{className:"p-3 md:p-4 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 rounded-2xl flex-shrink-0",children:e.jsx(C.Money,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] md:text-xs font-bold text-slate-500 uppercase tracking-wider mb-0.5 md:mb-1",children:"Transaksi Aktif"}),e.jsx("h3",{className:"text-xl md:text-3xl font-bold text-slate-800 dark:text-slate-100",children:H?"...":K.transactions})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-3 md:p-6 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 flex flex-col md:flex-row items-center gap-2 md:gap-4 text-center md:text-left",children:[e.jsx("div",{className:"p-3 md:p-4 bg-amber-100 dark:bg-amber-900/30 text-amber-600 rounded-2xl flex-shrink-0",children:e.jsx(C.Key,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] md:text-xs font-bold text-slate-500 uppercase tracking-wider mb-0.5 md:mb-1",children:"Total Akun"}),e.jsx("h3",{className:"text-xl md:text-3xl font-bold text-slate-800 dark:text-slate-100",children:H?"...":K.accounts})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-3 md:p-6 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 flex flex-col md:flex-row items-center gap-2 md:gap-4 text-center md:text-left",children:[e.jsx("div",{className:"p-3 md:p-4 bg-blue-100 dark:bg-blue-900/30 text-blue-600 rounded-2xl flex-shrink-0",children:e.jsx(C.User,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] md:text-xs font-bold text-slate-500 uppercase tracking-wider mb-0.5 md:mb-1",children:"Total Siswa"}),e.jsx("h3",{className:"text-xl md:text-3xl font-bold text-slate-800 dark:text-slate-100",children:H?"...":K.students})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-3 md:p-6 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 flex flex-col md:flex-row items-center gap-2 md:gap-4 text-center md:text-left",children:[e.jsx("div",{className:"p-3 md:p-4 bg-purple-100 dark:bg-purple-900/30 text-purple-600 rounded-2xl flex-shrink-0",children:e.jsx(C.Briefcase,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] md:text-xs font-bold text-slate-500 uppercase tracking-wider mb-0.5 md:mb-1",children:"Total Pegawai"}),e.jsx("h3",{className:"text-xl md:text-3xl font-bold text-slate-800 dark:text-slate-100",children:H?"...":K.teachers})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-emerald-600 to-teal-700 rounded-3xl p-8 text-white shadow-lg relative overflow-hidden flex flex-col justify-between group h-full",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10 group-hover:opacity-20 transition-opacity",children:e.jsx("div",{className:"scale-150 transform",children:e.jsx(C.Database,{})})}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 backdrop-blur-md rounded-2xl flex items-center justify-center mb-6",children:e.jsx(C.Database,{})}),e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Pusat Data"}),e.jsx("p",{className:"text-emerald-100 mb-6 text-sm max-w-xs",children:"Kelola data siswa, pegawai, dan akun pengguna secara terpusat dan aman."})]}),e.jsx("button",{onClick:()=>Y("database"),className:"w-full bg-white text-emerald-700 px-6 py-3 rounded-xl font-bold text-sm shadow-md hover:bg-emerald-50 transition-colors flex items-center justify-center gap-2",children:"Kelola Database"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl p-8 border border-slate-100 dark:border-slate-800 shadow-sm relative overflow-hidden flex flex-col justify-between group h-full hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5",children:e.jsx("div",{className:"scale-150 transform",children:e.jsx(C.Money,{})})}),e.jsxs("div",{children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 text-blue-600 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(C.Money,{})}),e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 mb-2",children:"Riwayat Transaksi"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-6 text-sm",children:"Verifikasi pembayaran masuk dan pantau arus kas keuangan sekolah."})]}),e.jsx("button",{onClick:()=>Y("finance"),className:"w-full bg-slate-50 dark:bg-slate-800 text-slate-700 dark:text-slate-200 px-6 py-3 rounded-xl font-bold text-sm border border-slate-200 dark:border-slate-700 hover:bg-blue-50 dark:hover:bg-slate-700 hover:text-blue-600 hover:border-blue-200 transition-all flex items-center justify-center gap-2",children:"Buka Keuangan"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl p-8 border border-slate-100 dark:border-slate-800 shadow-sm relative overflow-hidden flex flex-col justify-between group h-full hover:shadow-md transition-shadow",children:[e.jsxs("div",{children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 text-purple-600 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(C.Home,{})}),e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 mb-2",children:"Atur Tampilan"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-6 text-sm",children:"Sesuaikan konten beranda utama dan informasi setiap unit pendidikan."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>Y("content"),className:"bg-purple-50 dark:bg-slate-800 text-purple-700 dark:text-purple-400 px-4 py-3 rounded-xl font-bold text-xs md:text-sm border border-purple-100 dark:border-slate-700 hover:bg-purple-100 dark:hover:bg-slate-700 transition-colors",children:"Kelola Beranda"}),e.jsx("button",{onClick:()=>Y("unit"),className:"bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-300 px-4 py-3 rounded-xl font-bold text-xs md:text-sm border border-slate-200 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:"Kelola Unit"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl p-8 border border-slate-100 dark:border-slate-800 shadow-sm relative overflow-hidden flex flex-col justify-between group h-full hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5",children:e.jsx("div",{className:"scale-150 transform",children:e.jsx(C.Building,{})})}),e.jsxs("div",{children:[e.jsx("div",{className:"w-12 h-12 bg-amber-100 dark:bg-amber-900/30 text-amber-600 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(C.Building,{})}),e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 mb-2",children:"Manajemen Biaya"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-6 text-sm",children:"Atur komponen biaya pendidikan dan template tagihan siswa."})]}),e.jsx("button",{onClick:()=>Y("fees"),className:"w-full bg-slate-50 dark:bg-slate-800 text-slate-700 dark:text-slate-200 px-6 py-3 rounded-xl font-bold text-sm border border-slate-200 dark:border-slate-700 hover:bg-amber-50 dark:hover:bg-slate-700 hover:text-amber-600 hover:border-amber-200 transition-all flex items-center justify-center gap-2",children:"Kelola Biaya"})]})]})]}),c==="content"&&e.jsx(xa,{language:n}),c==="finance"&&e.jsx(ca,{language:n,setHideNav:h}),c==="unit"&&e.jsx(ma,{language:n}),c==="database"&&e.jsx(ua,{language:n,setHideNav:h}),c==="fees"&&e.jsx(ha,{language:n})]})})},Ve={Folder:()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"})}),External:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),User:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})},pa=({user:M,language:n,onLogout:w})=>e.jsx("div",{className:"bg-transparent min-h-screen pt-24 pb-20 px-4",dir:n==="ar"?"rtl":"ltr",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 animate-fade-in-down",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Dashboard Pegawai"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs("span",{className:"px-3 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full text-xs font-bold uppercase tracking-wider border border-blue-200 dark:border-blue-800 flex items-center gap-1",children:[e.jsx(Ve.User,{}),M.role==="teacher"?"Guru / Pengajar":"Staff / Karyawan"]}),e.jsx("span",{className:"text-slate-400 dark:text-slate-600 text-xs",children:"•"}),e.jsxs("p",{className:"text-slate-500 dark:text-slate-400 text-sm font-medium",children:["Selamat bertugas, ",M.name]})]})]}),e.jsx("button",{onClick:w,className:"px-6 py-2.5 bg-white dark:bg-slate-800 hover:bg-red-50 dark:hover:bg-red-900/20 text-slate-600 dark:text-slate-300 hover:text-red-600 dark:hover:text-red-400 border border-slate-200 dark:border-slate-700 rounded-full font-bold text-sm transition-all shadow-sm flex items-center gap-2",children:e.jsx("span",{children:ze[n].nav.logout})})]}),e.jsx(sa,{user:M,language:n}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-lg border border-slate-100 dark:border-slate-800 overflow-hidden mt-8 animate-fade-in-up",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-slate-50/50 dark:bg-slate-800/30 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 text-emerald-600",children:e.jsx(Ve.Folder,{})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Arsip Dokumen Digital"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Akses materi ajar, silabus, RPP, dan dokumen administrasi yayasan."})]})]}),e.jsxs("a",{href:"https://drive.google.com/drive/u/0/folders/1Cf6a2BiyFv9ycL_0xuxVFL--aH9UPa46",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-5 py-2.5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-xs font-bold hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-200 transition-all shadow-sm hover:shadow-md",children:["Buka Fullscreen ",e.jsx(Ve.External,{})]})]}),e.jsx("div",{className:"w-full relative bg-slate-100 dark:bg-slate-950 p-1",children:e.jsx("iframe",{src:"https://drive.google.com/embeddedfolderview?id=1Cf6a2BiyFv9ycL_0xuxVFL--aH9UPa46#grid",className:"w-full h-[600px] border-0 rounded-b-2xl bg-white shadow-inner",title:"Google Drive Folder",loading:"lazy",allowFullScreen:!0})})]})]})}),We="https://api-sekolah-minnatulhuda.halo-minnatulhuda.workers.dev",ea="service_yer158u",aa="template_bq5blic",ta="mNgGPZEPoYywu9liZ",Je="minnatul_history",He={loginBackground:"https://images.pexels.com/photos/159752/pencil-office-design-creative-159752.jpeg",logo:"https://imgur.com/4hdcTD7.png"},Qe=[{u:"minnatulhuda@admin.com",p:"administrator",n:"Super Administrator",id:"MHAC-AD-SUPER-001"},{u:"@admin",p:"admin",n:"General Administrator",id:"MHAC-AD-GEN-002"},{u:"mi@admin.com",p:"miadmin",n:"Admin MI",id:"MHAC-AD-MI-003"},{u:"smpbp@admin.com",p:"smpbpadmin",n:"Admin SMP BP",id:"MHAC-AD-SMP-004"},{u:"mtsn@admin.com",p:"mtsnadmin",n:"Admin MTsN",id:"MHAC-AD-MTS-005"},{u:"smksit@admin.com",p:"smksitadmin",n:"Admin SMKS IT",id:"MHAC-AD-SMK-006"},{u:"ma@admin.com",p:"maadmin",n:"Admin MA",id:"MHAC-AD-MA-007"}],ge={user:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),key:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),checkSmall:()=>e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})}),spin:()=>e.jsxs("svg",{className:"animate-spin w-5 h-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),checkCircle:()=>e.jsx("svg",{className:"w-4 h-4 text-emerald-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),eye:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})}),eyeOff:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}),trash:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),plus:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),arrowLeft:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),rocket:()=>e.jsx("svg",{className:"w-12 h-12 text-emerald-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),school:()=>e.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),bill:()=>e.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),info:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},ka=({language:M="id",user:n,setUser:w,onLogout:c,adminTab:E="finance",setAdminTab:h,setHideNav:K})=>{const[q,H]=o.useState(!0),[Q,W]=o.useState(!1),[Y,U]=o.useState(!0),[te,F]=o.useState([]),[V,O]=o.useState(!1),D=ze[M].auth,u=[{id:"user",label:D.role_visitor,code:"PG",uniqueField:null,disabled:!1},{id:"parrent",label:D.role_parent,code:"WS",uniqueField:"NISN",disabled:!1},{id:"employee",label:"Pegawai (Guru/Staff)",code:"PGW",uniqueField:"NIP",disabled:!1}],[A,se]=o.useState({role:"user",uniquecode:"",nama:"",telpon:"",email:"",otpInput:"",password:"",confirmPassword:""}),[z,p]=o.useState({emailOrPhone:"",password:""}),[N,I]=o.useState(""),[_,B]=o.useState(!1),[g,oe]=o.useState(!1),[X,le]=o.useState(null),[m,ae]=o.useState(0),[re,de]=o.useState(!1),[ce,b]=o.useState(!1),[T,v]=o.useState(""),[ee,ie]=o.useState(!1),[me,be]=o.useState(!1),[ue,fe]=o.useState({hasUpper:!1,hasLower:!1,hasNumber:!1,hasSpecial:!1,hasMinLength:!1}),[r,i]=o.useState(!0),[d,L]=o.useState("");o.useEffect(()=>{const s=localStorage.getItem(Je);if(s)try{const f=JSON.parse(s);Array.isArray(f)&&f.length>0?(F(f),U(!0)):U(!1)}catch{F([]),U(!1)}else U(!1)},[]);const R=s=>{let f=[...te];f=f.filter(P=>P.id!==s.id);const $={...s,lastLogin:new Date().toISOString()};f.unshift($),f.length>5&&f.pop(),F(f),localStorage.setItem(Je,JSON.stringify(f))},G=(s,f)=>{f.stopPropagation();const $=te.filter(P=>P.id!==s);F($),localStorage.setItem(Je,JSON.stringify($)),$.length===0&&U(!1)},ve=async s=>{b(!0),v("");try{const{ok:f,data:$}=await Z(We+"/api/accounts",{method:"GET",mode:"cors",headers:{Accept:"application/json"}});if(!f)throw new Error("Gagal terhubung ke server.");if($.find(he=>he.idAccount===s.id&&he.password===s.password))R(s),w(s),localStorage.setItem("user",JSON.stringify(s));else if(Qe.find(we=>we.id===s.id&&we.p===s.password))R(s),w(s),localStorage.setItem("user",JSON.stringify(s));else{v("Sesi telah kadaluarsa atau password berubah. Silakan login ulang.");const we=te.filter(Ce=>Ce.id!==s.id);F(we),localStorage.setItem(Je,JSON.stringify(we)),we.length===0&&U(!1)}}catch(f){console.error("Auto login error",f),Qe.find(P=>P.id===s.id&&P.p===s.password)?(R(s),w(s),localStorage.setItem("user",JSON.stringify(s))):v("Gagal login otomatis: "+f.message)}finally{b(!1)}},xe=u.find(s=>s.id===A.role)||u[0];o.useEffect(()=>{let s;return m>0?s=setInterval(()=>ae(f=>f-1),1e3):m===0&&_&&!g&&(B(!1),le(null),v("Waktu OTP habis. Silakan kirim ulang.")),()=>clearInterval(s)},[m,_,g]),o.useEffect(()=>{const s=A.password;fe({hasUpper:/[A-Z]/.test(s),hasLower:/[a-z]/.test(s),hasNumber:/[0-9]/.test(s),hasSpecial:/[^A-Za-z0-9]/.test(s),hasMinLength:s.length>=8})},[A.password]);const je=Object.values(ue).every(Boolean),ye=s=>{const{name:f,value:$}=s.target;if(f==="telpon"){let P=$.replace(/\D/g,"");P.startsWith("0")&&(P=P.substring(1)),se(he=>({...he,[f]:P})),P.length>0?P.startsWith("8")?P.length<9?(i(!1),L(D.validation.phone_length)):(i(!0),L("")):(i(!1),L(D.validation.phone_start)):(i(!0),L(""))}else se(P=>({...P,[f]:$}));v("")},Te=s=>{p(f=>({...f,[s.target.name]:s.target.value}))},$e=async()=>{if(!A.email||!A.nama){v(D.validation.error_incomplete);return}b(!0),v("");const s=Math.floor(1e5+Math.random()*9e5).toString();le(s);const f={title:"Verifikasi Akun",message:"Terima kasih telah mendaftar. Gunakan kode berikut untuk memverifikasi akun Anda:",otp:s,to_email:A.email,email:A.email,nama:A.nama,footer_note:"Kode ini bersifat rahasia dan berlaku selama 100 detik."};try{await Xe.send(ea,aa,f,ta),B(!0),ae(100),alert(`OTP terkirim ke ${A.email}.`)}catch($){console.error("EmailJS Error:",$),v("Gagal mengirim OTP. Periksa koneksi/email.")}finally{b(!1)}},t=async s=>{if(s.preventDefault(),!N){v("Mohon isi email anda.");return}b(!0),v("");try{const{ok:f,data:$}=await Z(We+"/api/accounts",{method:"GET",mode:"cors",headers:{Accept:"application/json"}});if(!f)throw new Error("Gagal terhubung ke server.");const P=$.find(he=>he.email&&he.email.toLowerCase()===N.toLowerCase());if(P){const he={title:"Pemulihan Kata Sandi",message:"Berikut adalah kata sandi untuk akun Anda:",otp:P.password,to_email:P.email,nama:P.nama,email:P.email,footer_note:"Jaga kerahasiaan kata sandi Anda. Jangan berikan kepada siapapun."};await Xe.send(ea,aa,he,ta),alert(`Kata sandi telah dikirim ke email ${N}. Silakan cek inbox/spam.`),W(!1),I("")}else v("Email tidak ditemukan dalam database.")}catch(f){console.error("Forgot Password Error:",f),v("Gagal memproses permintaan. "+f.message)}finally{b(!1)}},S=()=>{A.otpInput===X?(oe(!0),ae(0)):v("Kode OTP salah!")};o.useEffect(()=>{_&&!g&&A.otpInput.length===6&&S()},[A.otpInput]);const Z=async(s,f)=>{const $=await fetch(s,f),P=await $.text();try{return{ok:$.ok,status:$.status,data:JSON.parse(P)}}catch{throw new Error("Server Error: Respon tidak valid (Bukan JSON).")}},a=async s=>{if(s.preventDefault(),v(""),!r||A.telpon.length<9)return v(d||D.validation.phone_length);if(!je)return v("Password belum memenuhi kriteria.");if(!g)return v(D.validation.error_otp);if(A.password!==A.confirmPassword)return v(D.validation.error_match);if(!re)return v("Anda harus menyetujui Syarat & Ketentuan.");const f=["parrent","teacher","staff","employee"].includes(A.role);if(f&&!A.uniquecode)return v(`${xe.uniqueField||"Kode Unik"} wajib diisi.`);b(!0);try{const $="+62"+A.telpon,P={sebagai:A.role,nama:A.nama,telpon:$,email:A.email,password:A.password,uniquecode:f?A.uniquecode.trim():""},{ok:he,data:we}=await Z(We+"/api/register",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(P)});if(we.error)throw new Error(we.details||we.error);if(!he)throw new Error("Gagal menyimpan data.");O(!0)}catch($){let P=$.message;P==="Failed to fetch"&&(P="Gagal terhubung ke Server."),v(P)}finally{b(!1)}},x=async s=>{s.preventDefault(),b(!0),v("");const f=Qe.find($=>$.u===z.emailOrPhone&&$.p===z.password);if(f){const $={name:f.n,email:f.u,telpon:"-",role:"admin",id:f.id,createdAt:new Date().toISOString(),password:f.p};R($),w($),localStorage.setItem("user",JSON.stringify($)),b(!1);return}try{const{ok:$,data:P}=await Z(We+"/api/accounts",{method:"GET",mode:"cors",headers:{Accept:"application/json"}});if(!$)throw new Error(P.details||P.error||"Koneksi Gagal.");const he=z.emailOrPhone,we=z.password;let Ce=he.replace(/\D/g,"");Ce.startsWith("0")?Ce="62"+Ce.substring(1):Ce.startsWith("8")&&(Ce="62"+Ce);const Fe="+"+Ce,Ne=P.find(Ae=>{const Ie=Ae.email&&Ae.email.toLowerCase()===he.toLowerCase(),pe=Ae.telpon===Fe;return(Ie||pe)&&Ae.password===we});if(Ne){const Ae=Ne.idAccount?Ne.idAccount.split("-"):[],Ie=Ae.length>1?Ae[1]:"PG";let pe="student";Ie==="WS"?pe="student":Ie==="GR"?pe="teacher":Ie==="ST"?pe="internal":Ie==="AD"?pe="admin":Ne.sebagai==="staff"?pe="internal":Ne.sebagai==="teacher"?pe="teacher":pe="student";const Oe={name:Ne.nama,email:Ne.email,telpon:Ne.telpon,role:pe,originalRole:Ne.sebagai,id:Ne.idAccount,uniquecode:Ne.uniquecode||"",password:Ne.password,createdAt:Ne.createdAt||new Date().toISOString()};R(Oe),w(Oe),localStorage.setItem("user",JSON.stringify(Oe))}else throw new Error("Email/No.HP atau password salah.")}catch($){let P=$.message;P==="Failed to fetch"&&(P="Gagal terhubung ke Server."),v(P)}finally{b(!1)}};if(n)return n.role==="admin"||n.role==="administrator"?e.jsx(ba,{user:n,language:M,onLogout:c,activeTab:E,setAdminTab:h,setHideNav:K}):["internal","staff","teacher","employee","guru","pengajar"].includes(n.role)?e.jsx(pa,{user:n,language:M,onLogout:c}):e.jsx(ia,{user:n,language:M,onLogout:c,setHideNav:K});const y=s=>s?s.split(" ").slice(0,2).map(f=>f[0]).join("").toUpperCase():"??";return e.jsx("div",{className:"bg-transparent min-h-screen pt-24 pb-20 md:py-24 px-4 flex items-center justify-center",dir:M==="ar"?"rtl":"ltr",children:e.jsxs("div",{className:"bg-white/80 dark:bg-slate-900/80 backdrop-blur-md rounded-3xl shadow-2xl overflow-hidden w-full max-w-5xl flex flex-col md:flex-row md:min-h-[600px] border border-gray-100 dark:border-slate-800 animate-fade-in-up",children:[e.jsxs("div",{className:"w-full md:w-5/12 bg-emerald-800 relative hidden md:flex flex-col justify-center items-center p-12 text-center text-white overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center opacity-20",style:{backgroundImage:`url('${He.loginBackground}')`}}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("img",{src:He.logo,alt:"Logo",className:"w-24 h-24 mx-auto mb-6 drop-shadow-lg"}),e.jsx("h2",{className:"text-3xl font-bold font-lora mb-4",children:Q?"Pemulihan Akun":q?Y&&te.length>0?"Selamat Datang Kembali":D.login_title:D.register_title}),e.jsx("p",{className:"text-emerald-100 text-lg leading-relaxed",children:Q?"Jangan khawatir, kami akan membantu Anda mendapatkan kembali akses ke akun Anda.":q?D.login_desc:D.register_desc})]})]}),e.jsxs("div",{className:"w-full md:w-7/12 p-6 md:p-10 flex flex-col justify-center relative",children:[e.jsxs("div",{className:"md:hidden text-center mb-6",children:[e.jsx("img",{src:He.logo,alt:"Logo",className:"w-16 h-16 mx-auto mb-3"}),e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:Q?"Pemulihan Akun":q?Y&&te.length>0?"Pilih Akun":D.login_title:D.register_title})]}),Q?e.jsxs("div",{className:"animate-fade-in-fast max-w-sm mx-auto w-full",children:[e.jsxs("button",{onClick:()=>{W(!1),v("")},className:"flex items-center text-slate-500 hover:text-emerald-600 font-bold text-sm mb-6 transition-colors",children:[e.jsx(ge.arrowLeft,{})," ",e.jsx("span",{className:"ml-2",children:"Kembali ke Login"})]}),e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-100 dark:border-blue-800 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center mx-auto mb-3 text-blue-600 dark:text-blue-300",children:e.jsx(ge.key,{})}),e.jsx("h4",{className:"font-bold text-blue-700 dark:text-blue-300 text-sm",children:"Lupa Kata Sandi?"}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"Masukkan email yang terdaftar. Kami akan mengirimkan kata sandi Anda melalui email tersebut."})]}),e.jsxs("form",{onSubmit:t,className:"space-y-5",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"email",id:"forgotEmail",name:"forgotEmail",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:N,onChange:s=>I(s.target.value),required:!0}),e.jsx("label",{htmlFor:"forgotEmail",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:"Email Terdaftar"})]}),T&&e.jsx("div",{className:"p-3 bg-red-50 text-red-600 text-xs rounded-lg text-center font-bold",children:T}),e.jsx("button",{type:"submit",disabled:ce,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3.5 rounded-xl shadow-lg transition-transform active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed flex justify-center items-center",children:ce?e.jsx(ge.spin,{}):"Kirim Kata Sandi"})]})]}):e.jsx(e.Fragment,{children:V?e.jsxs("div",{className:"animate-fade-in-fast max-w-sm mx-auto w-full text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(ge.rocket,{})}),e.jsx("h3",{className:"text-2xl font-bold text-emerald-800 dark:text-emerald-400 mb-2 font-lora",children:D.reg_success_title}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 text-sm mb-8 leading-relaxed",children:D.reg_success_desc}),e.jsx("div",{className:"text-left space-y-4 mb-8",children:A.role==="employee"?e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-slate-50 dark:bg-slate-800 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 text-purple-600 rounded-full flex items-center justify-center shrink-0",children:e.jsx(ge.user,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:"Akun Pegawai"}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400",children:"Verifikasi NIP & Email berhasil. Silakan login untuk akses dashboard internal."})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-slate-50 dark:bg-slate-800 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-8 h-8 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center shrink-0",children:e.jsx(ge.school,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:"Identifikasi Unit"}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400",children:"Sistem mendeteksi unit sekolah siswa berdasarkan NISN."})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-slate-50 dark:bg-slate-800 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-100 text-amber-600 rounded-full flex items-center justify-center shrink-0",children:e.jsx(ge.bill,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:"Generate Tagihan"}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400",children:"Tagihan biaya (Tetap/Semester/Bulanan) otomatis dibuat."})]})]})]})}),e.jsx("button",{onClick:()=>{O(!1),H(!0)},className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3.5 rounded-xl shadow-lg transition-transform active:scale-95",children:D.btn_goto_login})]}):e.jsx(e.Fragment,{children:q&&Y&&te.length>0?e.jsxs("div",{className:"animate-fade-in-fast w-full max-w-sm mx-auto",children:[e.jsx("p",{className:"text-center text-slate-500 mb-6 text-sm",children:"Klik salah satu akun untuk login otomatis"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[te.map(s=>e.jsxs("div",{onClick:()=>ve(s),className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl p-4 flex flex-col items-center justify-center relative group cursor-pointer hover:shadow-lg hover:border-emerald-200 hover:bg-emerald-50/20 transition-all duration-300",children:[e.jsx("button",{onClick:f=>G(s.id,f),className:"absolute top-2 right-2 text-slate-300 hover:text-red-500 transition-colors p-1",title:"Hapus akun ini",children:e.jsx(ge.trash,{})}),e.jsx("div",{className:"w-16 h-16 rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 flex items-center justify-center text-xl font-bold mb-3 overflow-hidden border-2 border-white dark:border-slate-700 shadow-sm group-hover:scale-110 transition-transform",children:y(s.name)}),e.jsx("h4",{className:"font-bold text-slate-800 dark:text-slate-100 text-sm text-center line-clamp-1",children:s.name}),e.jsx("span",{className:"text-[10px] uppercase font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded mt-1",children:s.role==="student"?"Wali Santri":s.role})]},s.id)),e.jsxs("button",{onClick:()=>U(!1),className:"bg-slate-50 dark:bg-slate-800/50 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-2xl p-4 flex flex-col items-center justify-center text-slate-400 hover:text-emerald-600 hover:border-emerald-300 hover:bg-emerald-50/10 transition-all duration-300",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center mb-2",children:e.jsx(ge.plus,{})}),e.jsx("span",{className:"text-xs font-bold",children:"Masuk Akun Lain"})]})]}),ce&&e.jsx("div",{className:"text-center mb-4",children:e.jsxs("span",{className:"inline-flex items-center text-emerald-600 font-bold text-sm animate-pulse",children:[e.jsx(ge.spin,{}),e.jsx("span",{className:"ml-2",children:"Memverifikasi Akun..."})]})}),T&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 text-red-600 text-xs rounded-lg text-center font-bold",children:T}),e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:()=>U(!1),className:"text-sm text-slate-500 hover:text-emerald-600 font-bold underline",children:"Gunakan Akun Lain"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-xl mb-6 self-center w-full max-w-xs",children:[e.jsx("button",{onClick:()=>H(!0),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all duration-300 ${q?"bg-white dark:bg-slate-700 text-emerald-600 shadow-sm":"text-slate-500 dark:text-slate-400"}`,children:D.btn_login}),e.jsx("button",{onClick:()=>H(!1),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all duration-300 ${q?"text-slate-500 dark:text-slate-400":"bg-white dark:bg-slate-700 text-emerald-600 shadow-sm"}`,children:D.btn_register})]}),T&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm rounded-lg border border-red-200 dark:border-red-800 text-center animate-fade-in-fast flex flex-col items-center",children:e.jsx("span",{className:"text-xs font-bold",children:T})}),q?e.jsx("div",{className:"space-y-5 animate-fade-in-fast",children:e.jsxs("form",{onSubmit:x,className:"space-y-5",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",id:"emailOrPhone",name:"emailOrPhone",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:z.emailOrPhone,onChange:Te,required:!0}),e.jsx("label",{htmlFor:"emailOrPhone",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:"Email / Nomor Telepon"})]}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:ee?"text":"password",id:"password",name:"password",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:z.password,onChange:Te,required:!0}),e.jsx("label",{htmlFor:"password",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:D.password_label}),e.jsx("button",{type:"button",onClick:()=>ie(!ee),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-emerald-600 transition-colors",children:ee?e.jsx(ge.eyeOff,{}):e.jsx(ge.eye,{})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[te.length>0&&e.jsxs("button",{type:"button",onClick:()=>U(!0),className:"text-xs font-bold text-slate-500 hover:text-emerald-600 flex items-center gap-1",children:[e.jsx(ge.arrowLeft,{})," Pilih Akun Tersimpan"]}),e.jsx("button",{type:"button",onClick:()=>{W(!0),v("")},className:"text-xs font-bold text-emerald-600 hover:text-emerald-700 dark:text-emerald-400 ml-auto",children:D.forgot_password})]}),e.jsx("button",{type:"submit",disabled:ce,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3.5 rounded-xl shadow-lg transition-transform active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed flex justify-center items-center",children:ce?e.jsx(ge.spin,{}):D.btn_login})]})}):e.jsxs("form",{onSubmit:a,className:"space-y-4 animate-fade-in-fast",children:[e.jsx("div",{className:"relative w-full",children:e.jsxs("div",{className:"relative",children:[e.jsx("select",{name:"role",id:"role",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all appearance-none",value:A.role,onChange:ye,children:u.map(s=>e.jsx("option",{value:s.id,disabled:s.disabled,children:s.label},s.id))}),e.jsx("label",{htmlFor:"role",className:"absolute left-4 top-2 text-xs font-bold text-emerald-600 dark:text-emerald-400 pointer-events-none",children:D.role_label})]})}),A.role==="employee"&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-xl border border-blue-100 dark:border-blue-800 flex gap-3 items-start animate-fade-in-fast",children:[e.jsx("div",{className:"mt-0.5 text-blue-600 dark:text-blue-400",children:e.jsx(ge.info,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-blue-700 dark:text-blue-300",children:"Khusus Pegawai & Guru"}),e.jsxs("p",{className:"text-[10px] text-blue-600 dark:text-blue-400 leading-relaxed mt-0.5",children:["Pastikan data ",e.jsx("strong",{children:"NIP"})," dan ",e.jsx("strong",{children:"Email"})," Anda sudah didaftarkan oleh Administrator di database sekolah. Pendaftaran akan gagal jika data tidak cocok."]})]})]}),xe.uniqueField&&e.jsxs("div",{className:"relative w-full animate-fade-in-fast",children:[e.jsx("input",{type:"text",id:"uniquecode",name:"uniquecode",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:A.uniquecode,onChange:ye,required:!0}),e.jsxs("label",{htmlFor:"uniquecode",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:[xe.uniqueField," ",e.jsx("span",{className:"text-red-500",children:"*"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",id:"regNama",name:"nama",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:A.nama,onChange:ye,required:!0}),e.jsxs("label",{htmlFor:"regNama",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:[D.name_label," ",e.jsx("span",{className:"text-red-500",children:"*"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex relative",children:[e.jsx("div",{className:"flex items-center justify-center bg-slate-100 dark:bg-slate-800 border border-r-0 border-slate-300 dark:border-slate-700 rounded-l-xl px-3 text-slate-500 dark:text-slate-300 font-bold text-sm select-none pt-1",children:"+62"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"tel",id:"telpon",name:"telpon",placeholder:" ",className:`peer w-full px-4 pt-6 pb-2 bg-slate-50 dark:bg-slate-800 border rounded-r-xl focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all ${r?"border-slate-300 dark:border-slate-700 focus:border-emerald-500":"border-red-500 ring-red-200"} text-slate-900 dark:text-slate-100`,value:A.telpon,onChange:ye,required:!0}),e.jsxs("label",{htmlFor:"telpon",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:[D.phone_label," ",e.jsx("span",{className:"text-red-500",children:"*"})]})]})]}),!r&&e.jsx("p",{className:"text-xs text-red-500 mt-1 font-bold animate-fade-in-fast",children:d||"Pastikan nomor anda benar!"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-2 relative items-start",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("input",{type:"email",id:"regEmail",name:"email",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all disabled:opacity-70 disabled:cursor-not-allowed",value:A.email,onChange:ye,disabled:_||g,required:!0}),e.jsxs("label",{htmlFor:"regEmail",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:[D.email_label," ",e.jsx("span",{className:"text-red-500",children:"*"})]})]}),e.jsx("div",{className:"flex-shrink-0 pt-1",children:g?e.jsx("div",{className:"h-10 w-10 bg-emerald-100 rounded-lg flex items-center justify-center text-emerald-600 animate-fade-in-zoom",children:e.jsx(ge.checkCircle,{})}):_?e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:"text-xs font-bold text-red-500",children:[m,"s"]}),e.jsx("button",{type:"button",onClick:()=>{B(!1),ae(0),le(null),se(s=>({...s,otpInput:""}))},className:"text-[10px] text-slate-400 underline",children:"Ubah"})]}):e.jsx("button",{type:"button",onClick:$e,disabled:ce||!A.email,className:"h-10 px-3 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-xs font-bold transition-all disabled:opacity-50",children:ce?e.jsx(ge.spin,{}):D.btn_otp})})]}),_&&!g&&e.jsxs("div",{className:"mt-3 animate-slide-in-up",children:[e.jsx("p",{className:"text-[10px] text-emerald-600 mb-1 font-bold",children:D.otp_sent_info}),e.jsx("input",{type:"text",name:"otpInput",value:A.otpInput,onChange:ye,placeholder:"- - - - - -",className:"w-full text-center tracking-[1em] font-mono text-xl py-2 border-b-2 border-emerald-500 outline-none bg-transparent",maxLength:6})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",id:"regPassword",name:"password",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:A.password,onChange:ye,required:!0}),e.jsxs("label",{htmlFor:"regPassword",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:[D.password_label," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("button",{type:"button",onClick:()=>ie(!ee),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-emerald-600 transition-colors",children:ee?e.jsx(ge.eyeOff,{}):e.jsx(ge.eye,{})})]}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",id:"confirmPassword",name:"confirmPassword",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:A.confirmPassword,onChange:ye,required:!0}),e.jsxs("label",{htmlFor:"confirmPassword",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:[D.confirm_password," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("button",{type:"button",onClick:()=>be(!me),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-emerald-600 transition-colors",children:me?e.jsx(ge.eyeOff,{}):e.jsx(ge.eye,{})})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-3 rounded-xl border border-slate-100 dark:border-slate-700 animate-fade-in-fast",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2",children:"Ketentuan Password:"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-y-1.5 gap-x-4",children:[{valid:ue.hasMinLength,label:"Minimal 8 Karakter"},{valid:ue.hasUpper,label:"Huruf Besar (A-Z)"},{valid:ue.hasLower,label:"Huruf Kecil (a-z)"},{valid:ue.hasNumber,label:"Harus ada Angka (0-9)"},{valid:ue.hasSpecial,label:"Harus ada Karakter (!@#)"}].map((s,f)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center border transition-colors ${s.valid?"bg-emerald-500 border-emerald-500 text-white":"bg-white dark:bg-slate-700 border-slate-300 dark:border-slate-600 text-slate-300"}`,children:s.valid&&e.jsx(ge.checkSmall,{})}),e.jsx("span",{className:`text-[10px] font-medium transition-colors ${s.valid?"text-emerald-700 dark:text-emerald-400":"text-slate-500 dark:text-slate-400"}`,children:s.label})]},f))})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[e.jsx("input",{type:"checkbox",id:"terms",checked:re,onChange:s=>de(s.target.checked),className:"w-4 h-4 text-emerald-600 rounded focus:ring-emerald-500 border-gray-300"}),e.jsxs("label",{htmlFor:"terms",className:"text-xs text-slate-600 dark:text-slate-300 select-none cursor-pointer",children:[D.agree_terms," ",e.jsx("a",{href:"#",className:"text-emerald-600 font-bold hover:underline",children:"Ketentuan Layanan"})]})]}),e.jsx("button",{type:"submit",disabled:ce||!je||!g||!re,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3.5 rounded-xl shadow-lg transition-transform active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed flex justify-center items-center",children:ce?e.jsx(ge.spin,{}):D.btn_register})]})]})})})]})]})})};export{ka as default};
