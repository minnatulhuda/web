import{r,j as e,t as qe}from"./index-BJWNPnvn.js";import{e as Ve}from"./index-DfBlkqaH.js";import{f as Ae,W as Ne,I as C,D as Ue,a as j,u as $e,b as He,c as ra,d as na,e as oa}from"./AdminShared-IvonQnSk.js";const We="https://api-sekolah-minnatulhuda.halo-minnatulhuda.workers.dev",ie={calendar:()=>e.jsx("svg",{className:"w-5 h-5 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})}),check:()=>e.jsx("svg",{className:"w-3.5 h-3.5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})}),trash:()=>e.jsx("svg",{className:"w-4 h-4 text-red-400 hover:text-red-600 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),edit:()=>e.jsx("svg",{className:"w-4 h-4 text-slate-400 hover:text-blue-500 transition-colors",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),pin:({active:M})=>e.jsx("svg",{className:`w-4 h-4 transition-colors ${M?"text-amber-500 fill-amber-500":"text-slate-300 hover:text-amber-500"}`,viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"2",fill:"none",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 5a2 2 0 012-2h10a2 2 0 012 2v16l-7-3.5L5 21V5z"})}),plus:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),chevronLeft:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 19l-7-7 7-7"})}),chevronRight:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})}),chevronDown:({open:M})=>e.jsx("svg",{className:`w-4 h-4 transition-transform duration-300 ${M?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})}),close:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),userCard:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"})}),copy:()=>e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3"})}),mapPin:()=>e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M17.657 16.657L13.414 20.9a1.998 1.998 0 01-2.827 0l-4.244-4.243a8 8 0 1111.314 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 11a3 3 0 11-6 0 3 3 0 016 0z"})]}),phone:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"})}),mail:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 8l7.89 5.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})}),cake:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 15.546c-.523 0-1.046.151-1.5.454a2.704 2.704 0 01-3 0 2.704 2.704 0 00-3 0 2.704 2.704 0 01-3 0 2.704 2.704 0 00-3 0 2.704 2.704 0 01-3 0 2.701 2.701 0 00-1.5-.454M9 6v2m3-2v2m3-2v2M9 3h.01M12 3h.01M15 3h.01M21 21v-7a2 2 0 00-2-2H5a2 2 0 00-2 2v7h18zm-3-9v-2a2 2 0 00-2-2H8a2 2 0 00-2 2v2h12z"})}),idCard:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H5a2 2 0 00-2 2v9a2 2 0 002 2h14a2 2 0 002-2V8a2 2 0 00-2-2h-5m-4 0V5a2 2 0 114 0v1m-4 0a2 2 0 104 0m-5 8a2 2 0 100-4 2 2 0 000 4zm0 0c1.306 0 2.417.835 2.83 2M9 14a3.001 3.001 0 00-2.83 2M15 11h3m-3 4h2"})}),gender:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),key:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),eye:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0zM2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})}),eyeOff:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})})},la=({user:M,language:n,studentProfile:N})=>{var De,Pe,Fe,Ke,Re,c,S,Z,I,ye,Se,Ee;const x=(M==null?void 0:M.id)||"GUEST",[P,p]=r.useState([]),[U,J]=r.useState([]),[H,Q]=r.useState([]),[W,Y]=r.useState(!1),[R,re]=r.useState(!1),[O,q]=r.useState(!1),[F,oe]=r.useState(!1),[b,me]=r.useState("calendar"),[ne,z]=r.useState(null),[f,i]=r.useState(null),[D,g]=r.useState(""),[$,v]=r.useState(new Date),[ce,V]=r.useState(null),[de,u]=r.useState(""),[ae,X]=r.useState(""),[xe,we]=r.useState(""),[k,A]=r.useState(""),[K,te]=r.useState(""),[he,se]=r.useState("08:00"),le=s=>{const h=s.toLowerCase();return h==="student"||h==="parrent"||h==="ws"?"Wali Santri":h==="teacher"||h==="gr"?"Pengajar":h==="staff"||h==="st"?"Staff TU":h==="admin"||h==="administrator"||h==="ad"?"Administrator":"Pengunjung"},be=()=>{navigator.clipboard.writeText(M.id),alert("ID Akun disalin!")},E=s=>{s.stopPropagation(),N!=null&&N.nisn&&(navigator.clipboard.writeText(N.nisn),alert("NISN disalin!"))},l=s=>{if(!s)return"-";try{return new Date(s).toLocaleDateString("id-ID",{day:"numeric",month:"short",year:"numeric"})}catch{return s}},d=async()=>{if(x!=="GUEST"){Y(!0);try{const[s,h,T]=await Promise.all([fetch(`${We}/api/data?type=notes&id=${x}`),fetch(`${We}/api/data?type=todolist&id=${x}`),fetch(`${We}/api/data?type=calendar&id=${x}`)]),je=await s.json(),ve=await h.json(),Me=await T.json();je.notes&&p(je.notes),ve.todolist&&J(ve.todolist),Me.calendar&&Q(Me.calendar)}catch(s){console.error("Failed to fetch dashboard data",s)}finally{Y(!1)}}},o=async(s,h)=>{try{await fetch(`${We}/api/data?type=${s}&id=${x}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({[s]:h,idAccount:x})})}catch(T){console.error(`Failed to save ${s}`,T),alert("Gagal menyimpan data ke server.")}};r.useEffect(()=>{d()},[x]);const L=s=>{const h=s.getFullYear(),T=s.getMonth(),je=new Date(h,T+1,0).getDate(),ve=new Date(h,T,1).getDay(),Me=[];for(let Oe=0;Oe<ve;Oe++)Me.push(null);for(let Oe=1;Oe<=je;Oe++)Me.push(new Date(h,T,Oe));return Me},B=s=>{const h=new Date($.getFullYear(),$.getMonth()+s,1);v(h)},G=async()=>{if(!ce||!k.trim())return;const s={scheduleId:`SCH-${Date.now()}`,title:k,description:K,time:he};let h=[...H];const T=h.findIndex(je=>je.date===ce);T>=0?h[T].schedule.push(s):h.push({date:ce,schedule:[s]}),Q(h),A(""),te(""),await o("calendar",h)},fe=async(s,h)=>{let T=H.map(je=>je.date===s?{...je,schedule:je.schedule.filter(ve=>ve.scheduleId!==h)}:je).filter(je=>je.schedule.length>0);Q(T),await o("calendar",T)},ue=async()=>{if(!de.trim()&&!ae.trim())return;let s=[...P];ne?(s=s.map(h=>h.noteId===ne.noteId?{...h,title:de,content:ae,timestamp:new Date().toISOString()}:h),z(null)):s=[{noteId:`NOTE-${Date.now()}`,timestamp:new Date().toISOString(),title:de.trim()||"Tanpa Judul",content:ae,pinned:!1},...s],p(s),u(""),X(""),await o("notes",s)},ke=s=>{z(s),u(s.title),X(s.content)},Te=async s=>{const h=P.filter(T=>T.noteId!==s);p(h),await o("notes",h)},Ie=async s=>{const h=P.map(T=>T.noteId===s?{...T,pinned:!T.pinned}:T);p(h),await o("notes",h)},Be=async s=>{if(!xe.trim())return;const T=[{todoId:`TODO-${Date.now()}`,timestamp:new Date().toISOString(),title:xe,completed:!1,pinned:!1},...U];J(T),we(""),await o("todolist",T)},t=s=>{i(s.todoId),g(s.title)},w=async s=>{if(!D.trim())return;const h=U.map(T=>T.todoId===s?{...T,title:D}:T);J(h),i(null),await o("todolist",h)},ee=async s=>{const h=U.map(T=>T.todoId===s?{...T,completed:!T.completed}:T);J(h),await o("todolist",h)},a=async s=>{const h=U.filter(T=>T.todoId!==s);J(h),await o("todolist",h)},m=async s=>{const h=U.map(T=>T.todoId===s?{...T,pinned:!T.pinned}:T);J(h),await o("todolist",h)},y=[...P].sort((s,h)=>Number(h.pinned)-Number(s.pinned)),_=[...U].sort((s,h)=>Number(h.pinned)-Number(s.pinned)),Ce=ce?(s=>{var h;return((h=H.find(T=>T.date===s))==null?void 0:h.schedule)||[]})(ce):[];return e.jsxs("div",{className:"flex flex-col gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl overflow-hidden shadow-lg border border-slate-100 dark:border-slate-800 relative group",children:[e.jsx("div",{className:"h-28 bg-gradient-to-r from-emerald-600 to-teal-700 relative overflow-hidden",children:e.jsx("div",{className:"absolute -bottom-10 -right-10 w-40 h-40 bg-white/10 rounded-full blur-2xl"})}),e.jsxs("div",{className:"px-6 pb-6 relative",children:[e.jsx("div",{className:"relative -mt-12 mb-4 flex justify-center",children:e.jsxs("div",{className:"w-24 h-24 rounded-full bg-white dark:bg-slate-800 p-1.5 shadow-lg relative z-10",children:[e.jsx("div",{className:"w-full h-full rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center text-emerald-600 dark:text-emerald-400 font-bold text-3xl overflow-hidden border-2 border-slate-50 dark:border-slate-600",children:M.name.charAt(0).toUpperCase()}),e.jsx("div",{className:"absolute bottom-1 right-1 w-5 h-5 bg-emerald-500 border-4 border-white dark:border-slate-800 rounded-full"})]})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"font-bold text-slate-800 dark:text-slate-100 text-xl font-lora leading-tight mb-1",children:M.name}),e.jsx("span",{className:"inline-block px-3 py-1 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 text-[10px] font-bold uppercase tracking-wider rounded-full border border-emerald-100 dark:border-emerald-800/50",children:le(M.role)}),e.jsxs("div",{className:"mt-4 flex items-center justify-center gap-2 bg-slate-50 dark:bg-slate-800/50 py-2 px-3 rounded-lg border border-slate-100 dark:border-slate-700 mx-4 cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors group/id",onClick:be,children:[e.jsx("span",{className:"text-xs text-slate-400 font-mono",children:"ID:"}),e.jsx("span",{className:"text-xs font-bold text-slate-600 dark:text-slate-300 font-mono tracking-wide",children:M.id}),e.jsx("span",{className:"text-slate-400 opacity-0 group-hover/id:opacity-100 transition-opacity",children:e.jsx(ie.copy,{})})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-dashed border-slate-200 dark:border-slate-700",children:[e.jsx("button",{onClick:()=>q(!O),className:`w-full bg-gradient-to-br rounded-xl p-4 border relative overflow-hidden group/card hover:shadow-lg transition-all duration-300 ${O?"from-blue-50 to-white dark:from-slate-800 dark:to-slate-800/50 border-blue-200 dark:border-blue-800":"from-slate-50 to-white dark:from-slate-800 dark:to-slate-800/50 border-slate-200 dark:border-slate-700"}`,children:e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg shadow-sm text-blue-600 dark:text-blue-400 border border-slate-100 dark:border-slate-600 transition-colors ${O?"bg-blue-100 dark:bg-blue-900/40":"bg-white dark:bg-slate-700"}`,children:e.jsx(ie.idCard,{})}),e.jsxs("div",{className:"text-left flex-grow",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-0.5",children:"Informasi Akun"}),e.jsx("h5",{className:"font-bold text-slate-700 dark:text-slate-200 text-sm leading-tight transition-colors",children:"Detail Akun Saya"})]}),e.jsx("div",{className:`text-slate-400 transition-transform duration-300 ${O?"rotate-180 text-blue-500":""}`,children:e.jsx(ie.chevronDown,{open:O})})]})})}),e.jsx("div",{className:`overflow-hidden transition-all duration-500 ease-in-out ${O?"max-h-[800px] opacity-100 mt-4":"max-h-0 opacity-0 mt-0"}`,children:e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl border border-slate-100 dark:border-slate-700 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 text-slate-400",children:e.jsx(ie.mail,{})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-bold",children:"Email"}),e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200 break-all",children:M.email})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 text-slate-400",children:e.jsx(ie.phone,{})}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-bold",children:"No. Telepon"}),e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:M.telpon})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 text-slate-400",children:e.jsx(ie.key,{})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-bold",children:"Password"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200 font-mono",children:F?M.password:"••••••••"}),e.jsx("button",{onClick:()=>oe(!F),className:"text-slate-400 hover:text-blue-500 transition-colors",children:F?e.jsx(ie.eyeOff,{}):e.jsx(ie.eye,{})})]})]})]}),M.uniquecode&&e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 text-slate-400",children:e.jsx(ie.userCard,{})}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-bold",children:"Kode Unik / NISN"}),e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200 font-mono",children:M.uniquecode})]})]}),e.jsxs("div",{className:"pt-2 border-t border-slate-200 dark:border-slate-700 flex items-center gap-2 text-[10px] text-slate-400",children:[e.jsx(ie.calendar,{})," Terdaftar sejak: ",l(M.createdAt)]})]})})]}),N&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-dashed border-slate-200 dark:border-slate-700",children:[e.jsxs("button",{onClick:()=>re(!R),className:`w-full bg-gradient-to-br rounded-xl p-4 border relative overflow-hidden group/card hover:shadow-lg transition-all duration-300 ${R?"from-emerald-50 to-white dark:from-slate-800 dark:to-slate-800/50 border-emerald-200 dark:border-emerald-800":"from-slate-50 to-white dark:from-slate-800 dark:to-slate-800/50 border-slate-200 dark:border-slate-700"}`,children:[e.jsx("div",{className:"absolute top-0 right-0 w-16 h-16 bg-emerald-100 dark:bg-emerald-900/20 rounded-bl-full -mr-8 -mt-8 transition-transform group-hover/card:scale-110"}),e.jsx("div",{className:"relative z-10",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-lg shadow-sm text-emerald-600 dark:text-emerald-400 border border-slate-100 dark:border-slate-600 transition-colors ${R?"bg-emerald-100 dark:bg-emerald-900/40":"bg-white dark:bg-slate-700"}`,children:e.jsx(ie.userCard,{})}),e.jsxs("div",{className:"text-left flex-grow",children:[e.jsx("span",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-widest block mb-0.5",children:"Data Siswa Terkait"}),e.jsx("h5",{className:"font-bold text-slate-700 dark:text-slate-200 text-sm leading-tight group-hover/card:text-emerald-700 dark:group-hover/card:text-emerald-400 transition-colors",children:(De=N.identitas)==null?void 0:De.nama})]}),e.jsx("div",{className:`text-slate-400 transition-transform duration-300 ${R?"rotate-180 text-emerald-500":""}`,children:e.jsx(ie.chevronDown,{open:R})})]})})]}),e.jsx("div",{className:`overflow-hidden transition-all duration-500 ease-in-out ${R?"max-h-[800px] opacity-100 mt-4":"max-h-0 opacity-0 mt-0"}`,children:e.jsxs("div",{className:"space-y-4 px-1",children:[e.jsx("div",{className:"text-center bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl border border-slate-100 dark:border-slate-700",children:e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-1.5 bg-white dark:bg-slate-800 rounded-full text-slate-500 dark:text-slate-400 text-sm font-mono cursor-pointer hover:bg-slate-50 dark:hover:bg-slate-700 transition-colors group/nisn border border-slate-100 dark:border-slate-700 shadow-sm",title:"Salin NISN",onClick:E,children:[e.jsx("span",{className:"font-bold text-emerald-600 dark:text-emerald-400",children:N.nisn}),e.jsx("span",{className:"opacity-0 group-hover/nisn:opacity-100 transition-opacity",children:e.jsx(ie.copy,{})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-3 rounded-xl border border-slate-100 dark:border-slate-700 text-center",children:[e.jsx("span",{className:"text-[9px] text-slate-400 uppercase font-bold block mb-1",children:"Kelas"}),e.jsx("span",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:(Pe=N.status)==null?void 0:Pe.kelas})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-3 rounded-xl border border-slate-100 dark:border-slate-700 text-center",children:[e.jsx("span",{className:"text-[9px] text-slate-400 uppercase font-bold block mb-1",children:"Sekolah"}),e.jsx("span",{className:"text-sm font-bold text-emerald-600 dark:text-emerald-400 uppercase",children:(Fe=N.status)==null?void 0:Fe.sekolah})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl border border-slate-100 dark:border-slate-700 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 text-slate-400",children:e.jsx(ie.cake,{})}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-bold",children:"TTL"}),e.jsxs("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:[(Ke=N.identitas)==null?void 0:Ke.tempat_lahir,", ",(Re=N.identitas)==null?void 0:Re.tanggal_lahir]})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5 text-slate-400",children:e.jsx(ie.gender,{})}),e.jsxs("div",{children:[e.jsx("span",{className:"block text-[10px] text-slate-400 uppercase font-bold",children:"Jenis Kelamin"}),e.jsx("span",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:((c=N.identitas)==null?void 0:c.jenis_kelamin)==="L"?"Laki-laki":"Perempuan"})]})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl border border-slate-100 dark:border-slate-700 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-300",children:[e.jsx(ie.phone,{})," ",((S=N.identitas)==null?void 0:S.telpon)||"-"]}),e.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600 dark:text-slate-300",children:[e.jsx(ie.mail,{})," ",((Z=N.identitas)==null?void 0:Z.email)||"-"]}),e.jsx("div",{className:"pt-2 mt-2 border-t border-slate-200 dark:border-slate-700",children:e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"mt-0.5 text-slate-400 flex-shrink-0",children:e.jsx(ie.mapPin,{})}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400 leading-relaxed",children:[(I=N.alamat)==null?void 0:I.detail,", ",(ye=N.alamat)==null?void 0:ye.desa,", ",(Se=N.alamat)==null?void 0:Se.kec,", ",(Ee=N.alamat)==null?void 0:Ee.kota]})]})})]})]})})]})]})]}),e.jsx("div",{className:"md:hidden flex justify-center mb-2",children:e.jsx("div",{className:"bg-white dark:bg-slate-900 p-1.5 rounded-full shadow-sm border border-slate-100 dark:border-slate-800 inline-flex flex-wrap justify-center gap-1",children:[{id:"all",label:"Semua"},{id:"calendar",label:"Kalender"},{id:"notes",label:"Catatan"},{id:"todos",label:"To Do List"}].map(s=>e.jsx("button",{onClick:()=>me(s.id),className:`px-4 py-2 rounded-full text-xs font-bold transition-all duration-300 whitespace-nowrap ${b===s.id?"bg-emerald-600 text-white shadow-md":"text-slate-500 hover:text-emerald-600"}`,children:s.label},s.id))})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:`bg-white dark:bg-slate-900 rounded-3xl p-6 shadow-sm border border-slate-100 dark:border-slate-800 flex-col h-[500px] ${b==="all"||b==="notes"?"flex":"hidden md:flex"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 border-b border-slate-100 dark:border-slate-800 pb-3",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-amber-400"})," Catatan (",P.length,")"]}),ne&&e.jsx("span",{className:"text-xs text-amber-500 font-bold animate-pulse",children:"Mode Edit"})]}),e.jsxs("div",{className:"space-y-2 mb-4 bg-slate-50 dark:bg-slate-800/50 p-3 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("input",{className:"w-full bg-transparent text-sm font-bold placeholder-slate-400 text-slate-700 dark:text-slate-200 outline-none",placeholder:"Judul Catatan...",value:de,onChange:s=>u(s.target.value)}),e.jsx("div",{className:"h-px bg-slate-200 dark:bg-slate-700 w-full"}),e.jsx("textarea",{className:"w-full bg-transparent text-xs text-slate-600 dark:text-slate-300 outline-none resize-none h-16",placeholder:"Isi catatan disini...",value:ae,onChange:s=>X(s.target.value)}),e.jsxs("div",{className:"flex justify-end gap-2",children:[ne&&e.jsx("button",{onClick:()=>{z(null),u(""),X("")},className:"text-slate-400 hover:text-slate-600 text-xs font-bold px-2",children:"Batal"}),e.jsxs("button",{onClick:ue,className:"bg-amber-500 hover:bg-amber-600 text-white text-xs font-bold px-3 py-1.5 rounded-lg flex items-center gap-1 transition-colors shadow-sm active:scale-95",children:[e.jsx(ie.plus,{})," ",ne?"Update":"Simpan"]})]})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto scrollbar-hide space-y-3 pr-1",children:[y.length===0&&e.jsx("div",{className:"h-full flex items-center justify-center text-slate-400 text-xs",children:"Belum ada catatan"}),y.map(s=>e.jsxs("div",{onClick:()=>ke(s),className:"bg-yellow-50 dark:bg-slate-800 p-3 rounded-xl border border-yellow-100 dark:border-slate-700 relative group transition-all hover:shadow-sm cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h5",{className:"font-bold text-xs text-slate-800 dark:text-slate-200 line-clamp-1",children:s.title}),e.jsx("span",{className:"text-[10px] text-slate-400",children:new Date(s.timestamp).toLocaleDateString("id-ID")})]}),e.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 leading-relaxed whitespace-pre-wrap line-clamp-3",children:s.content}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity bg-white/80 dark:bg-slate-900/80 p-1 rounded-md shadow-sm",onClick:h=>h.stopPropagation(),children:[e.jsx("button",{onClick:()=>Ie(s.noteId),children:e.jsx(ie.pin,{active:s.pinned})}),e.jsx("button",{onClick:()=>Te(s.noteId),children:e.jsx(ie.trash,{})})]})]},s.noteId))]})]}),e.jsxs("div",{className:`bg-white dark:bg-slate-900 rounded-3xl p-5 shadow-sm border border-slate-100 dark:border-slate-800 flex-col h-[500px] ${b==="all"||b==="calendar"?"flex":"hidden md:flex"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("button",{onClick:()=>B(-1),className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full",children:e.jsx(ie.chevronLeft,{})}),e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2 text-sm",children:[e.jsx(ie.calendar,{})," ",$.toLocaleString("default",{month:"long",year:"numeric"})]}),e.jsx("button",{onClick:()=>B(1),className:"p-1 hover:bg-slate-100 dark:hover:bg-slate-800 rounded-full",children:e.jsx(ie.chevronRight,{})})]}),e.jsx("div",{className:"grid grid-cols-7 gap-1 text-center mb-2",children:["M","S","S","R","K","J","S"].map((s,h)=>e.jsx("span",{className:"text-[10px] font-bold text-slate-400",children:s},h))}),e.jsx("div",{className:"grid grid-cols-7 gap-1 auto-rows-fr flex-grow",children:L($).map((s,h)=>{if(!s)return e.jsx("div",{className:"aspect-square"},h);const T=`${s.getFullYear()}-${String(s.getMonth()+1).padStart(2,"0")}-${String(s.getDate()).padStart(2,"0")}`,je=H.some(Oe=>Oe.date===T&&Oe.schedule.length>0),ve=new Date,Me=s.getDate()===ve.getDate()&&s.getMonth()===ve.getMonth()&&s.getFullYear()===ve.getFullYear();return e.jsxs("button",{onClick:()=>V(T),className:`aspect-square flex flex-col items-center justify-center rounded-lg text-xs font-medium transition-all relative group 
                                ${Me?"bg-emerald-600 text-white shadow-md":"bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-400 hover:bg-emerald-50 dark:hover:bg-slate-700"}`,children:[s.getDate(),je&&e.jsx("span",{className:`w-1.5 h-1.5 rounded-full mt-1 ${Me?"bg-white":"bg-emerald-500"}`})]},h)})})]}),e.jsxs("div",{className:`bg-white dark:bg-slate-900 rounded-3xl p-6 shadow-sm border border-slate-100 dark:border-slate-800 flex-col h-[500px] ${b==="all"||b==="todos"?"flex":"hidden md:flex"}`,children:[e.jsx("div",{className:"flex items-center justify-between mb-4 border-b border-slate-100 dark:border-slate-800 pb-3",children:e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"w-2 h-2 rounded-full bg-blue-500"})," To-Do List (",U.filter(s=>!s.completed).length,")"]})}),e.jsxs("div",{className:"space-y-2 mb-4 bg-slate-50 dark:bg-slate-800/50 p-3 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"flex gap-2",children:e.jsx("input",{className:"flex-grow bg-white dark:bg-slate-900 px-3 py-1.5 rounded-lg border border-slate-200 dark:border-slate-700 text-xs outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500/20 dark:text-white transition-all",placeholder:"Nama Tugas...",value:xe,onChange:s=>we(s.target.value)})}),e.jsx("div",{className:"flex justify-end pt-1",children:e.jsxs("button",{onClick:()=>Be(),className:"bg-blue-500 hover:bg-blue-600 text-white text-xs font-bold px-3 py-1.5 rounded-lg flex items-center gap-1 transition-colors shadow-sm active:scale-95",children:[e.jsx(ie.plus,{})," Tambah"]})})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto scrollbar-hide space-y-2 pr-1",children:[_.length===0&&e.jsx("div",{className:"h-full flex items-center justify-center text-slate-400 text-xs",children:"Semua tugas selesai!"}),_.map(s=>e.jsx("div",{className:`p-3 rounded-xl border transition-all hover:shadow-sm ${s.completed?"bg-slate-50 border-slate-100 opacity-60":"bg-white dark:bg-slate-800 border-slate-100 dark:border-slate-700"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("button",{onClick:()=>ee(s.todoId),className:`flex-shrink-0 w-5 h-5 rounded-md border flex items-center justify-center transition-colors mt-0.5 ${s.completed?"bg-emerald-500 border-emerald-500":"border-slate-300 dark:border-slate-600 hover:border-emerald-500"}`,children:s.completed&&e.jsx(ie.check,{})}),e.jsx("div",{className:"flex-grow min-w-0",children:f===s.todoId?e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("input",{value:D,onChange:h=>g(h.target.value),className:"flex-grow bg-slate-100 dark:bg-slate-900 px-2 py-1 rounded text-xs outline-none border border-blue-400",autoFocus:!0,onBlur:()=>w(s.todoId),onKeyDown:h=>h.key==="Enter"&&w(s.todoId)})}):e.jsxs("div",{className:"flex justify-between items-start group",children:[e.jsx("h5",{className:`text-xs font-bold truncate ${s.completed?"text-slate-500 line-through":"text-slate-700 dark:text-slate-200"}`,children:s.title}),e.jsxs("div",{className:"flex gap-1 ml-2 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>t(s),children:e.jsx(ie.edit,{})}),e.jsx("button",{onClick:()=>m(s.todoId),children:e.jsx(ie.pin,{active:s.pinned})}),e.jsx("button",{onClick:()=>a(s.todoId),className:"text-slate-300 hover:text-red-500",children:e.jsx(ie.trash,{})})]})]})})]})},s.todoId))]})]})]}),ce&&e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 animate-fade-in-fast",onClick:()=>V(null),children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-sm rounded-3xl shadow-2xl p-6 relative animate-slide-in-up",onClick:s=>s.stopPropagation(),children:[e.jsx("button",{onClick:()=>V(null),className:"absolute top-4 right-4 text-slate-400 hover:text-slate-600",children:e.jsx(ie.close,{})}),e.jsxs("div",{className:"text-center mb-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:new Date(ce).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric"})}),e.jsx("p",{className:"text-xs text-emerald-600 dark:text-emerald-400 font-bold uppercase tracking-wider mt-1",children:"Agenda Harian"})]}),e.jsx("div",{className:"space-y-3 mb-6 max-h-48 overflow-y-auto scrollbar-hide",children:Ce.length===0?e.jsx("p",{className:"text-center text-sm text-slate-400 italic py-4",children:"Belum ada agenda."}):Ce.map(s=>e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-3 rounded-xl border-l-4 border-emerald-500 flex justify-between items-start group",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-bold text-emerald-600 dark:text-emerald-400 block mb-0.5",children:s.time}),e.jsx("h4",{className:"text-sm font-bold text-slate-700 dark:text-slate-200",children:s.title}),s.description&&e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mt-1",children:s.description})]}),e.jsx("button",{onClick:()=>fe(ce,s.scheduleId),className:"text-slate-300 hover:text-red-500 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(ie.trash,{})})]},s.scheduleId))}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-2xl border border-slate-100 dark:border-slate-800",children:[e.jsx("h4",{className:"text-xs font-bold text-slate-500 mb-3 uppercase",children:"Tambah Agenda"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"time",value:he,onChange:s=>se(s.target.value),className:"w-20 px-2 py-2 text-xs rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 outline-none focus:ring-1 focus:ring-emerald-500"}),e.jsx("input",{type:"text",placeholder:"Judul...",value:k,onChange:s=>A(s.target.value),className:"flex-grow px-3 py-2 text-xs rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 outline-none focus:ring-1 focus:ring-emerald-500"})]}),e.jsx("input",{type:"text",placeholder:"Keterangan...",value:K,onChange:s=>te(s.target.value),className:"w-full px-3 py-2 text-xs rounded-lg border border-slate-200 dark:border-slate-700 bg-white dark:bg-slate-900 outline-none focus:ring-1 focus:ring-emerald-500"}),e.jsx("button",{onClick:G,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white py-2 rounded-lg text-xs font-bold shadow-sm transition-colors active:scale-95",children:"Simpan Agenda"})]})]})]})})]})},Je="https://api-sekolah-minnatulhuda.halo-minnatulhuda.workers.dev",_e={Close:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})}),Check:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 13l4 4L19 7"})}),Download:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})}),Building:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),Clock:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})}),Wallet:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),ChevronRight:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})},Qe=M=>new Intl.NumberFormat("id-ID",{style:"currency",currency:"IDR",minimumFractionDigits:0}).format(M),da=M=>M.replace(/_/g," ").replace(/\b\w/g,n=>n.toUpperCase()),ia=(M,n)=>{let N=[];const x=["tetap","semesteran","bulanan"],P={tetap:"fixed",semesteran:"semester",bulanan:"monthly"};return x.forEach(p=>{M[p]&&Array.isArray(M[p])&&M[p].forEach(U=>{let J=0;if(n&&n[p]){const Y=n[p].find(R=>R.biaya===U.biaya);Y&&(J=Y.amount||0)}const H=U.amount||0;J===0&&H>0&&(J=H);const Q=J-H;let W=0;J>0?W=Q/J*100:H===0&&(W=100),N.push({id:U.biaya,keyName:U.biaya,item:da(U.biaya),amount:Qe(J),rawAmount:J,paid:Qe(Q<0?0:Q),rawPaid:Q<0?0:Q,remaining:Qe(H),rawRemaining:H,progress:Math.min(Math.max(W,0),100),date:U.timestamp?new Date(U.timestamp).toLocaleDateString("id-ID"):"-",status:U.status||"Belum Lunas",category:P[p]})})}),N},ca=({user:M,language:n,onLogout:N,setHideNav:x})=>{const P=qe[n].dashboard,[p,U]=r.useState([]),[J,H]=r.useState(null),[Q,W]=r.useState(!1),[Y,R]=r.useState("all"),[re,O]=r.useState("all"),[q,F]=r.useState(null),[oe,b]=r.useState(!1),[me,ne]=r.useState(!0);r.useEffect(()=>{z()},[M]),r.useEffect(()=>(document.body.style.overflow=q?"hidden":"",()=>{document.body.style.overflow=""}),[q]);const z=async()=>{var u;W(!0);try{const ae=M.uniquecode?fetch(`${Je}/api/data?type=student_profile&nisn=${M.uniquecode}`).then(A=>A.json()):Promise.resolve(null),X=fetch(`${Je}/api/data?type=transaction&id=${M.id}`).then(A=>A.json()),[xe,we]=await Promise.all([ae,X]);xe&&!xe.error&&H(xe);let k=null;if(xe&&((u=xe.status)!=null&&u.sekolah)){let A=xe.status.sekolah.toLowerCase().replace(/\s/g,"");A.includes("mi")?A="mi":A.includes("mts")?A="mtsn":A.includes("smp")?A="smpbp":A.includes("smk")?A="smksit":A.includes("ma")&&(A="ma");const K=await fetch(`${Je}/api/data?type=template_biaya_${A}`);if(K.ok){const te=await K.json();k=Array.isArray(te)?te[0]:te}}if(we&&!we.error){const A=ia(we,k);U(A)}}catch(ae){console.error("Fetch error",ae)}finally{W(!1)}},f=u=>{F(u),x&&x(!0)},i=()=>{b(!0),setTimeout(()=>{F(null),b(!1),x&&x(!1)},300)},D=async()=>{if(!q)return;const u=q;W(!0);try{const ae={idAccount:M.id,biaya:u.keyName,category:u.category},X=await fetch(`${Je}/api/confirm-payment`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ae)}),xe=await X.json();X.ok?(alert(n==="id"?"Konfirmasi berhasil!":"Confirmation successful!"),i(),z()):alert(`Gagal: ${xe.details||xe.error}`)}catch{alert("Error connection")}finally{W(!1)}},g=()=>{const u=document.createElement("a");u.href="https://drive.google.com/uc?export=download&id=1QaWwMafKnUG9c65zOHaLsBXIp5whkszP",u.target="_blank",u.rel="noopener noreferrer",document.body.appendChild(u),u.click(),document.body.removeChild(u)},$=p.filter(u=>{const ae=Y==="all"||u.category===Y,X=re==="all"||(u.status||"").toLowerCase()===re;return ae&&X}),v=q?(q.status||"").toLowerCase()==="lunas":!1,ce=q?!v:!1,V=u=>{const ae=(u||"").toLowerCase();return ae==="lunas"?"bg-emerald-100 text-emerald-700 border-emerald-200":ae==="proses"?"bg-blue-50 text-blue-600 border-blue-100":ae==="diterima sebagian"?"bg-purple-50 text-purple-600 border-purple-100":"bg-amber-50 text-amber-600 border-amber-100"},de=u=>{switch(u){case"fixed":return{icon:_e.Building,color:"text-purple-600",bg:"bg-purple-50 dark:bg-purple-900/20"};case"semester":return{icon:_e.Clock,color:"text-blue-600",bg:"bg-blue-50 dark:bg-blue-900/20"};default:return{icon:_e.Wallet,color:"text-amber-600",bg:"bg-amber-50 dark:bg-amber-900/20"}}};return e.jsx("div",{className:"bg-transparent min-h-screen pt-24 pb-20 px-4",dir:n==="ar"?"rtl":"ltr",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:[P.welcome," ",M.name]}),e.jsx("p",{className:"text-emerald-600 dark:text-emerald-400 font-medium",children:P.portal_parent})]}),e.jsx("button",{onClick:N,className:"px-6 py-2 bg-red-100 hover:bg-red-200 text-red-700 rounded-full font-bold text-sm transition-colors",children:qe[n].nav.logout})]}),me&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-100 dark:border-blue-800 p-4 rounded-2xl mb-8 relative animate-fade-in-down",children:[e.jsx("button",{onClick:()=>ne(!1),className:"absolute top-2 right-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 p-1",children:e.jsx(_e.Close,{})}),e.jsxs("h4",{className:"font-bold text-blue-700 dark:text-blue-300 text-sm mb-2 flex items-center gap-2",children:[e.jsx("span",{className:"w-5 h-5 bg-blue-100 rounded-full flex items-center justify-center text-xs",children:"i"})," ",P.guide_title]}),e.jsxs("ul",{className:"text-xs text-slate-600 dark:text-slate-300 space-y-1 list-disc pl-5",children:[e.jsx("li",{children:P.guide_step_1}),e.jsx("li",{children:P.guide_step_2}),e.jsx("li",{children:P.guide_step_3})]})]}),e.jsx(la,{user:M,language:n,studentProfile:J}),e.jsxs("div",{className:"mt-10",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-end mb-6 gap-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:P.finance_history}),e.jsx("p",{className:"text-slate-500 text-sm mt-1",children:"Pantau status pembayaran SPP dan biaya lainnya."})]}),e.jsx("div",{className:"flex bg-white dark:bg-slate-900 p-1 rounded-xl border border-slate-100 dark:border-slate-800 overflow-x-auto max-w-full",children:["all","fixed","semester","monthly"].map(u=>e.jsx("button",{onClick:()=>R(u),className:`px-4 py-2 rounded-lg text-xs font-bold transition-all whitespace-nowrap ${Y===u?"bg-slate-100 dark:bg-slate-800 text-emerald-600 shadow-sm":"text-slate-500"}`,children:P[`tab_${u}`]||u},u))})]}),e.jsx("div",{className:"space-y-3",children:Q&&!q?e.jsx("div",{className:"text-center py-12",children:e.jsx("span",{className:"text-slate-400 font-medium animate-pulse",children:P.processing})}):$.length===0?e.jsx("div",{className:"text-center py-12 bg-white dark:bg-slate-900 rounded-3xl border border-slate-100 dark:border-slate-800",children:e.jsx("p",{className:"text-slate-400 italic",children:"Tidak ada data transaksi ditemukan."})}):$.map((u,ae)=>{const X=de(u.category);return e.jsxs("div",{onClick:()=>f(u),className:"group relative bg-white dark:bg-slate-900 rounded-2xl p-4 md:p-5 border border-slate-100 dark:border-slate-800 hover:border-emerald-200 dark:hover:border-emerald-800 hover:shadow-md transition-all cursor-pointer overflow-hidden",children:[e.jsx("div",{className:"absolute bottom-0 left-0 h-1 bg-slate-100 dark:bg-slate-800 w-full",children:e.jsx("div",{className:`h-full transition-all duration-1000 ${u.status.toLowerCase()==="lunas"?"bg-emerald-500":"bg-amber-400"}`,style:{width:`${u.progress}%`}})}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl flex items-center justify-center flex-shrink-0 ${X.bg} ${X.color}`,children:e.jsx(X.icon,{})}),e.jsxs("div",{className:"flex-grow min-w-0 grid grid-cols-1 md:grid-cols-12 gap-4 items-center",children:[e.jsxs("div",{className:"md:col-span-5",children:[e.jsx("h4",{className:"font-bold text-slate-800 dark:text-slate-100 text-sm md:text-base truncate group-hover:text-emerald-600 transition-colors",children:u.item}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("span",{className:"text-[10px] bg-slate-100 dark:bg-slate-800 text-slate-500 px-2 py-0.5 rounded font-mono",children:u.date}),e.jsxs("span",{className:"text-[10px] text-slate-400 truncate hidden md:inline",children:["ID: ",u.id.slice(0,8),"..."]})]})]}),e.jsxs("div",{className:"hidden md:block md:col-span-4",children:[e.jsxs("div",{className:"flex justify-between text-xs mb-1",children:[e.jsx("span",{className:"text-slate-500",children:"Terbayar"}),e.jsxs("span",{className:"font-bold font-mono text-slate-700 dark:text-slate-300",children:[u.paid," ",e.jsxs("span",{className:"text-slate-400 font-normal",children:["/ ",u.amount]})]})]}),e.jsx("div",{className:"w-full bg-slate-100 dark:bg-slate-800 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full ${u.progress>=100?"bg-emerald-500":"bg-amber-400"}`,style:{width:`${u.progress}%`}})})]}),e.jsxs("div",{className:"md:col-span-3 flex justify-between md:justify-end items-center gap-4",children:[e.jsx("div",{className:"text-right",children:u.rawRemaining>0?e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] text-slate-400 uppercase font-bold",children:"Sisa Tagihan"}),e.jsx("p",{className:"text-sm font-bold font-mono text-red-500",children:u.remaining})]}):e.jsxs("span",{className:"text-xs font-bold text-emerald-600 flex items-center gap-1",children:[e.jsx(_e.Check,{})," Lunas"]})}),e.jsx("div",{className:`px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-wide border ${V(u.status)}`,children:u.status}),e.jsx("div",{className:"text-slate-300 group-hover:text-emerald-500 transition-colors",children:e.jsx(_e.ChevronRight,{})})]})]})]})]},ae)})})]}),q&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed inset-0 z-[200] bg-black/60 backdrop-blur-sm transition-opacity duration-300 ${oe?"opacity-0":"opacity-100"}`,onClick:i}),e.jsxs("div",{className:`fixed bottom-0 left-0 right-0 z-[201] bg-white dark:bg-slate-900 rounded-t-3xl shadow-[0_-10px_40px_rgba(0,0,0,0.2)] flex flex-col max-h-[90vh] transform transition-transform duration-300 ${oe?"translate-y-full":"translate-y-0 animate-slide-in-up"}`,onClick:u=>u.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Rincian Pembayaran"}),e.jsxs("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["ID: ",q.id]})]}),e.jsx("button",{onClick:i,className:"p-2 bg-slate-100 dark:bg-slate-800 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors",children:e.jsx(_e.Close,{})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto",children:[e.jsx("div",{className:`p-4 rounded-xl flex items-center justify-between mb-6 ${v?"bg-emerald-50 border border-emerald-100 text-emerald-800":"bg-amber-50 border border-amber-100 text-amber-800"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-full flex items-center justify-center ${v?"bg-emerald-200":"bg-amber-200"}`,children:v?e.jsx(_e.Check,{}):e.jsx("svg",{className:"w-6 h-6 text-amber-700",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold opacity-70 uppercase tracking-wider",children:"Status Transaksi"}),e.jsx("p",{className:"font-bold text-lg capitalize",children:q.status})]})]})}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h4",{className:"font-bold text-slate-800 dark:text-slate-100 text-sm border-l-4 border-emerald-500 pl-3",children:"Informasi Tagihan"}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl border border-slate-100 dark:border-slate-800 space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:"Jenis Pembayaran"}),e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:q.item})]}),e.jsx("div",{className:"border-t border-slate-200 dark:border-slate-700 my-2"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:"Total Tagihan"}),e.jsx("span",{className:"font-bold font-mono",children:q.amount})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:"Sudah Dibayar"}),e.jsx("span",{className:"font-bold font-mono text-emerald-600",children:q.paid})]}),e.jsxs("div",{className:"flex justify-between pt-2 border-t border-slate-200 dark:border-slate-700",children:[e.jsx("span",{className:"font-bold",children:"Sisa Tagihan"}),e.jsx("span",{className:"text-xl font-bold font-mono text-red-500",children:q.remaining})]}),e.jsxs("div",{className:"mt-4 pt-2",children:[e.jsxs("div",{className:"flex justify-between text-[10px] text-slate-400 mb-1",children:[e.jsx("span",{children:"Progres Pembayaran"}),e.jsxs("span",{children:[Math.round(q.progress),"%"]})]}),e.jsx("div",{className:"w-full bg-slate-200 dark:bg-slate-700 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full rounded-full transition-all duration-500 ${v?"bg-emerald-500":"bg-amber-400"}`,style:{width:`${q.progress}%`}})})]})]})]}),ce&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"font-bold text-slate-800 dark:text-slate-100 text-sm border-l-4 border-emerald-500 pl-3",children:"Metode Pembayaran"}),e.jsxs("div",{className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl p-4 text-center",children:[e.jsx("div",{className:"inline-block p-4 bg-white rounded-xl border border-slate-100 shadow-sm mb-4",children:e.jsx("img",{src:"https://imgur.com/FPmggp4.png",alt:"QRIS",className:"w-64 h-64 object-contain mx-auto"})}),e.jsxs("button",{onClick:g,className:"mb-4 text-xs font-bold text-emerald-600 hover:text-emerald-700 flex items-center justify-center gap-1 mx-auto py-1 px-3 rounded-full hover:bg-emerald-50 transition-colors",children:[e.jsx(_e.Download,{})," Download QRIS"]})]})]})]}),ce&&e.jsx("div",{className:"p-4 border-t border-slate-100 dark:border-slate-800 bg-white dark:bg-slate-900 pb-8 md:pb-6",children:e.jsx("button",{onClick:D,disabled:Q,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-4 rounded-xl shadow-lg transition-transform active:scale-95 flex justify-center items-center gap-2",children:Q?e.jsx("span",{children:"Memproses..."}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Saya Sudah Transfer"}),e.jsx(_e.Check,{})]})})})]})]})]})})},xa=({language:M,setHideNav:n})=>{const[N,x]=r.useState([]),[P,p]=r.useState([]),[U,J]=r.useState([]),[H,Q]=r.useState([]),[W,Y]=r.useState({}),[R,re]=r.useState(!1),[O,q]=r.useState("all"),[F,oe]=r.useState(""),[b,me]=r.useState(""),[ne,z]=r.useState(""),[f,i]=r.useState(null),[D,g]=r.useState(!1),[$,v]=r.useState(!1),[ce,V]=r.useState([]);r.useEffect(()=>{de()},[]);const de=async()=>{re(!0);try{const k=["template_biaya_mi","template_biaya_mtsn","template_biaya_smpbp","template_biaya_smksit","template_biaya_ma"],[A,K,te,he,...se]=await Promise.all([Ae(`${Ne}/api/data?type=notification_transaction`),Ae(`${Ne}/api/data?type=all_transactions`),Ae(`${Ne}/api/accounts`),Ae(`${Ne}/api/data?type=siswa`),...k.map(be=>Ae(`${Ne}/api/data?type=${be}`))]);if(A){const be=Array.isArray(A)?A.sort((E,l)=>new Date(l.timestamp).getTime()-new Date(E.timestamp).getTime()):[];x(be)}K&&p(Array.isArray(K)?K:[]),te&&J(te),he&&Q(Array.isArray(he)?he:[]);const le={};k.forEach((be,E)=>{se[E]&&(le[be]=Array.isArray(se[E])?se[E][0]:se[E])}),Y(le)}catch(k){console.error("Init Error",k)}finally{re(!1)}};r.useEffect(()=>{const k=f||$;return document.body.style.overflow=k?"hidden":"",n&&n(k),()=>{document.body.style.overflow="",n&&n(!1)}},[f,$,n]);const u=()=>{g(!0),setTimeout(()=>{i(null),g(!1)},300)},ae=async()=>{if(f){re(!0);try{const k={idTransaction:f.idTransaction,idAccount:f.idAccount,biaya:f.biaya,status:f.status,amount:f.amount};(await fetch(`${Ne}/api/admin/update-transaction`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(k)})).ok?(alert("Transaksi berhasil diperbarui!"),u(),de()):alert("Gagal memperbarui transaksi.")}catch{alert("Terjadi kesalahan koneksi.")}finally{re(!1)}}},X=k=>{var be,E,l,d;const A=U.find(o=>o.idAccount===k.idAccount),K=A?H.find(o=>String(o.nisn).trim()===String(A.uniquecode).trim()):null;let te=0,he=0,se=0;if(K&&((be=K.status)!=null&&be.sekolah)){let o=K.status.sekolah.toLowerCase().replace(/\s/g,"");o.includes("mi")?o="mi":o.includes("mts")?o="mtsn":o.includes("smp")?o="smpbp":o.includes("smk")?o="smksit":o.includes("ma")&&(o="ma");const L=`template_biaya_${o}`,B=W[L];B&&["tetap","semesteran","bulanan"].forEach(G=>{var ue;const fe=(ue=B[G])==null?void 0:ue.find(ke=>ke.biaya===k.biaya);fe&&(te=fe.amount||0)})}const le=P.find(o=>o.idAccount===k.idAccount);return le?(["tetap","semesteran","bulanan"].forEach(o=>{var B;const L=(B=le[o])==null?void 0:B.find(G=>G.biaya===k.biaya);L&&(he=L.amount)}),he===void 0&&(he=te)):he=te,se=Math.max(0,te-he),{parentName:A?A.nama:"Unknown",studentName:K?(E=K.identitas)==null?void 0:E.nama:"-",school:K?(l=K.status)==null?void 0:l.sekolah:"-",kelas:K?(d=K.status)==null?void 0:d.kelas:"-",bill:te,paid:se,remaining:he}},xe=N.filter(k=>{const A=O==="all"?!0:(k.status||"").toLowerCase()===O.toLowerCase(),K=new Date(k.timestamp).getTime();let te=!0;b&&(te=te&&K>=new Date(b).setHours(0,0,0,0)),ne&&(te=te&&K<=new Date(ne).setHours(23,59,59,999));let he=!0;if(F){const se=F.toLowerCase(),le=X(k);he=le.studentName&&le.studentName.toLowerCase().includes(se)||le.parentName&&le.parentName.toLowerCase().includes(se)||k.idAccount&&k.idAccount.toLowerCase().includes(se)||k.biaya&&k.biaya.toLowerCase().includes(se)}return A&&te&&he}),we=()=>{const k=new Set;xe.forEach(A=>{const K=new Date(A.timestamp);isNaN(K.getTime())||k.add(K.toLocaleDateString("id-ID",{month:"long",year:"numeric"}))}),V(Array.from(k)),v(!0)};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex flex-col gap-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"Verifikasi Pembayaran"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:we,className:"p-2 rounded-lg bg-emerald-50 text-emerald-600 hover:bg-emerald-100 transition-colors flex items-center gap-1",title:"Download PDF",children:[e.jsx(C.Download,{})," ",e.jsx("span",{className:"text-xs font-bold hidden md:inline",children:"Laporan PDF"})]}),e.jsx("button",{onClick:de,className:"p-2 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-600 transition-colors",children:e.jsx(C.Refresh,{})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-3",children:[e.jsx("div",{className:"md:col-span-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",placeholder:"Cari Nama / ID / Tagihan...",value:F,onChange:k=>oe(k.target.value),className:"w-full pl-10 pr-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-emerald-500 transition-all"}),e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:e.jsx(C.Filter,{})})]})}),e.jsxs("div",{className:"md:col-span-3 flex items-center gap-2",children:[e.jsx("input",{type:"date",value:b,onChange:k=>me(k.target.value),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border rounded-lg text-xs outline-none"}),e.jsx("span",{className:"text-slate-400 text-xs",children:"-"}),e.jsx("input",{type:"date",value:ne,onChange:k=>z(k.target.value),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border rounded-lg text-xs outline-none"})]}),e.jsx("div",{className:"md:col-span-3",children:e.jsxs("select",{value:O,onChange:k=>q(k.target.value),className:"w-full bg-slate-50 dark:bg-slate-800 border px-4 py-2 rounded-lg text-sm outline-none cursor-pointer",children:[e.jsx("option",{value:"all",children:"Semua Status"}),e.jsx("option",{value:"belum lunas",children:"Belum Lunas"}),e.jsx("option",{value:"proses",children:"Proses"}),e.jsx("option",{value:"diterima sebagian",children:"Diterima Sebagian"}),e.jsx("option",{value:"lunas",children:"Lunas"}),e.jsx("option",{value:"gagal",children:"Gagal"}),e.jsx("option",{value:"dikembalikan",children:"Dikembalikan"})]})}),e.jsx("div",{className:"md:col-span-2 text-right flex items-center justify-end",children:e.jsxs("span",{className:"text-xs text-slate-400 font-medium",children:["Total: ",xe.length]})})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left text-sm",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-800/50 text-slate-500 uppercase font-bold text-xs",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-4 rounded-tl-xl",children:"Tanggal"}),e.jsx("th",{className:"px-4 py-4",children:"Wali Santri"}),e.jsx("th",{className:"px-4 py-4",children:"Siswa"}),e.jsx("th",{className:"px-4 py-4",children:"Item Bayar"}),e.jsx("th",{className:"px-4 py-4 text-right",children:"Tagihan"}),e.jsx("th",{className:"px-4 py-4 text-right",children:"Terbayar"}),e.jsx("th",{className:"px-4 py-4 text-right",children:"Sisa"}),e.jsx("th",{className:"px-4 py-4 text-center rounded-tr-xl",children:"Status"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-100 dark:divide-slate-800",children:R?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-6 py-8 text-center text-slate-400 animate-pulse",children:"Memuat Data..."})}):xe.length===0?e.jsx("tr",{children:e.jsx("td",{colSpan:8,className:"px-6 py-8 text-center text-slate-400 italic",children:"Tidak ada data."})}):xe.map((k,A)=>{const K=X(k);return e.jsxs("tr",{className:"hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors cursor-pointer group",onClick:()=>i({...k,...K}),children:[e.jsx("td",{className:"px-4 py-4 text-slate-500 text-xs whitespace-nowrap",children:new Date(k.timestamp).toLocaleDateString("id-ID")}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-slate-700 dark:text-slate-200",children:K.parentName}),e.jsx("span",{className:"text-[10px] text-slate-500",children:k.idAccount})]})}),e.jsx("td",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex flex-col",children:[e.jsx("span",{className:"font-bold text-emerald-600",children:K.studentName}),e.jsx("span",{className:"text-[10px] text-slate-500",children:K.school.toUpperCase()})]})}),e.jsx("td",{className:"px-4 py-4 font-bold text-slate-800 dark:text-slate-200 text-xs",children:k.biaya?k.biaya.replace(/_/g," ").toUpperCase():"-"}),e.jsx("td",{className:"px-4 py-4 text-right font-mono text-slate-500 text-xs",children:new Intl.NumberFormat("id-ID").format(K.bill)}),e.jsx("td",{className:"px-4 py-4 text-right font-mono font-bold text-emerald-600 text-xs",children:new Intl.NumberFormat("id-ID").format(K.paid)}),e.jsx("td",{className:"px-4 py-4 text-right font-mono font-bold text-red-500 text-xs",children:new Intl.NumberFormat("id-ID").format(K.remaining)}),e.jsx("td",{className:"px-4 py-4 text-center",children:e.jsx("span",{className:`px-2 py-1 rounded-full text-[9px] font-bold uppercase tracking-wide border ${(k.status||"").toLowerCase()==="lunas"?"bg-emerald-100 text-emerald-700 border-emerald-200":(k.status||"").toLowerCase()==="gagal"?"bg-red-50 text-red-700 border-red-200":"bg-amber-50 text-amber-600 border-amber-100"}`,children:k.status})})]},A)})})]})}),f&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:`fixed inset-0 z-[200] bg-black/60 backdrop-blur-sm transition-opacity duration-300 ${D?"opacity-0":"opacity-100"}`,onClick:u}),e.jsxs("div",{className:`fixed bottom-0 left-0 right-0 z-[201] bg-white dark:bg-slate-900 rounded-t-3xl shadow-[0_-10px_40px_rgba(0,0,0,0.2)] flex flex-col max-h-[90vh] transform transition-transform duration-300 ${D?"translate-y-full":"translate-y-0 animate-slide-in-up"}`,onClick:k=>k.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-100 dark:border-slate-800",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100",children:"Konfirmasi Transaksi"}),e.jsx("button",{onClick:u,className:"p-2 bg-slate-100 dark:bg-slate-800 rounded-full",children:e.jsx(C.Close,{})})]}),e.jsxs("div",{className:"p-6 overflow-y-auto",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-4 rounded-xl border border-slate-100 mb-6 text-sm space-y-2",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:"Tagihan:"})," ",e.jsxs("span",{className:"font-mono",children:["Rp ",new Intl.NumberFormat("id-ID").format(f.bill||0)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-slate-500",children:"Sisa:"})," ",e.jsxs("span",{className:"font-bold text-red-500 font-mono",children:["Rp ",new Intl.NumberFormat("id-ID").format(f.remaining||0)]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-2",children:"Status"}),e.jsxs("select",{value:f.status,onChange:k=>i({...f,status:k.target.value}),className:"w-full px-4 py-3 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 outline-none",children:[e.jsx("option",{value:"belum lunas",children:"Belum lunas"}),e.jsx("option",{value:"proses",children:"Proses"}),e.jsx("option",{value:"diterima sebagian",children:"Diterima Sebagian"}),e.jsx("option",{value:"lunas",children:"Lunas"}),e.jsx("option",{value:"gagal",children:"Gagal"}),e.jsx("option",{value:"dikembalikan",children:"Dikembalikan"})]})]}),(f.status==="diterima sebagian"||f.status==="lunas")&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-2",children:"Nominal Diterima (Rp)"}),e.jsx("input",{type:"number",value:f.amount,onChange:k=>i({...f,amount:k.target.value}),className:"w-full px-4 py-3 bg-white dark:bg-slate-800 rounded-xl border border-slate-200 outline-none",placeholder:"0"})]})]})]}),e.jsx("div",{className:"p-4 border-t border-slate-100 dark:border-slate-800",children:e.jsx("button",{onClick:ae,disabled:R,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white py-3.5 rounded-xl font-bold flex justify-center items-center gap-2",children:R?"Menyimpan...":"Simpan Perubahan"})})]})]})]})},ma=({language:M})=>{var ae,X,xe,we,k,A,K,te,he,se,le,be,E,l,d,o,L,B,G,fe,ue,ke,Te,Ie,Be,t,w,ee;const[n,N]=r.useState("general"),[x,P]=r.useState(Ue),[p,U]=r.useState(!1),J=r.useRef(null),[H,Q]=r.useState(!1),[W,Y]=r.useState(null),[R,re]=r.useState(null),[O,q]=r.useState(null),[F,oe]=r.useState(6),b=[{id:"general",label:"Umum"},{id:"visimisi",label:"Visi Misi"},{id:"curriculum",label:"Kurikulum"},{id:"stats",label:"Statistik"},{id:"team",label:"Tim"},{id:"gallery",label:"Galeri"},{id:"news",label:"Berita"},{id:"testimonials",label:"Testimoni"},{id:"faq",label:"FAQ"}];r.useEffect(()=>{me()},[]),r.useEffect(()=>{oe(6)},[n]),r.useEffect(()=>(H?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[H]);const me=async()=>{const a=await Ae(`${Ne}/api/data?type=beranda`);if(a)if(Array.isArray(a)){const m=a.reduce((y,_)=>({...y,..._}),{});P({...Ue,...m})}else P({...Ue,...a})},ne=async()=>{U(!0);try{const a={youtube:x.youtube,profile:x.profile,vision:x.vision,mission:x.mission,coreValues:x.coreValues,curriculum:x.curriculum},m={stats:x.stats,team:x.team,gallery:x.gallery,news:x.news,testimonials:x.testimonials,faq:x.faq};await fetch(`${Ne}/api/data?type=beranda`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([a,m])}),alert("Data Beranda Disimpan!")}catch{alert("Gagal menyimpan.")}finally{U(!1)}},z=(a,m)=>{P(y=>$e(y,a,m))},f=(a,m)=>{Y(a),re(null),q(m),Q(!0)},i=(a,m,y)=>{Y(a),re(m),q(JSON.parse(JSON.stringify(y))),Q(!0)},D=(a,m)=>{q(y=>$e(y,a,m))},g=()=>{!W||!O||(P(a=>{const m=[...a[W]||[]];return R!==null?m[R]=O:m.push(O),W==="curriculum_pillars"?$e(a,"curriculum.pillars",m):{...a,[W]:m}}),Q(!1),q(null),Y(null),re(null))},$=(a,m)=>{confirm("Hapus item ini?")&&P(y=>{var Ce;let _;a==="curriculum_pillars"?_=[...((Ce=y.curriculum)==null?void 0:Ce.pillars)||[]]:_=[...y[a]||[]];const ge=_.filter((De,Pe)=>Pe!==m);return a==="curriculum_pillars"?$e(y,"curriculum.pillars",ge):{...y,[a]:ge}})},v=()=>{const a=JSON.stringify(x,null,2),m="data:application/json;charset=utf-8,"+encodeURIComponent(a),y="beranda-data.json",_=document.createElement("a");_.setAttribute("href",m),_.setAttribute("download",y),_.click()},ce=a=>{const m=new FileReader;a.target.files&&a.target.files[0]&&(m.readAsText(a.target.files[0],"UTF-8"),m.onload=y=>{var _;if((_=y.target)!=null&&_.result)try{const ge=JSON.parse(y.target.result);P({...Ue,...ge}),alert("Data Beranda berhasil diimpor!")}catch(ge){alert("Format file JSON tidak valid."),console.error(ge)}})},V=(a,m,y,_,ge)=>e.jsxs("div",{className:"bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-xl p-4 flex gap-4 items-center group relative hover:shadow-md transition-shadow",children:[y&&e.jsx("div",{className:"w-16 h-16 rounded-lg bg-slate-100 overflow-hidden flex-shrink-0 border border-slate-100",children:e.jsx("img",{src:y,alt:"Thumbnail",className:"w-full h-full object-cover",onError:Ce=>Ce.target.style.display="none"})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("h5",{className:"font-bold text-slate-800 dark:text-slate-100 text-sm truncate",children:a||"(Tanpa Judul)"}),e.jsx("p",{className:"text-xs text-slate-500 truncate",children:m||"-"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:_,className:"p-2 text-blue-500 hover:bg-blue-50 rounded-lg transition-colors text-xs font-bold border border-blue-100",children:"Edit"}),e.jsx("button",{onClick:ge,className:"p-2 text-red-500 hover:bg-red-50 rounded-lg transition-colors text-xs font-bold border border-red-100",children:e.jsx(C.Trash,{})})]})]}),de=a=>a>F?e.jsxs("button",{onClick:()=>oe(m=>m+6),className:"w-full py-3 bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-400 font-bold rounded-xl hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors mt-6 text-xs flex items-center justify-center gap-2",children:[e.jsx(C.Refresh,{})," Muat Lebih Banyak (",a-F," lagi)"]}):null,u=({label:a,pathPrefix:m,type:y="text"})=>{var _,ge,Ce;return e.jsxs("div",{className:"border-t border-slate-100 dark:border-slate-700 my-3 pt-3",children:[e.jsx("p",{className:"text-xs font-bold text-slate-400 mb-2 uppercase tracking-wider",children:a}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{label:"Bahasa Indonesia",value:(_=O[m])==null?void 0:_.id,onChange:De=>D(`${m}.id`,De),type:y}),e.jsx(j,{label:"English",value:(ge=O[m])==null?void 0:ge.en,onChange:De=>D(`${m}.en`,De),type:y}),e.jsx(j,{label:"Bahasa Arab",value:(Ce=O[m])==null?void 0:Ce.ar,onChange:De=>D(`${m}.ar`,De),type:y})]})]})};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 p-6 min-h-[600px]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 border-b border-slate-100 dark:border-slate-800 pb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Manajemen Beranda"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Sesuaikan konten yang tampil di halaman utama."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-lg text-xs font-bold transition-colors",children:[e.jsx(C.Download,{})," Export JSON"]}),e.jsxs("button",{onClick:()=>{var a;return(a=J.current)==null?void 0:a.click()},className:"flex items-center gap-2 px-4 py-2 bg-emerald-50 text-emerald-600 hover:bg-emerald-100 rounded-lg text-xs font-bold transition-colors",children:[e.jsx(C.Upload,{})," Import JSON"]}),e.jsx("input",{type:"file",ref:J,onChange:ce,accept:".json",className:"hidden"})]})]}),e.jsx("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-xl overflow-x-auto max-w-full no-scrollbar mb-6",children:b.map(a=>e.jsx("button",{onClick:()=>N(a.id),className:`px-5 py-2 rounded-lg text-sm font-bold transition-all whitespace-nowrap ${n===a.id?"bg-white dark:bg-slate-700 text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:a.label},a.id))}),e.jsxs("div",{className:"pb-20",children:[n==="general"&&e.jsxs("div",{className:"space-y-4 animate-fade-in-up",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-red-500 rounded-full"})," Youtube Hero"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"Video URL",value:(ae=x.youtube)==null?void 0:ae.url,onChange:a=>z("youtube.url",a)}),e.jsx(j,{label:"Thumbnail URL",value:(X=x.youtube)==null?void 0:X.thumbnail,onChange:a=>z("youtube.thumbnail",a),isImage:!0})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Profil Sekolah"]}),e.jsx(j,{label:"Bahasa Indonesia",value:(xe=x.profile)==null?void 0:xe.id,onChange:a=>z("profile.id",a),type:"textarea"}),e.jsx(j,{label:"English",value:(we=x.profile)==null?void 0:we.en,onChange:a=>z("profile.en",a),type:"textarea"}),e.jsx(j,{label:"Bahasa Arab",value:(k=x.profile)==null?void 0:k.ar,onChange:a=>z("profile.ar",a),type:"textarea"})]})]}),n==="visimisi"&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Visi"]}),e.jsx(j,{label:"Bahasa Indonesia",value:(A=x.vision)==null?void 0:A.id,onChange:a=>z("vision.id",a),type:"textarea"}),e.jsx(j,{label:"English",value:(K=x.vision)==null?void 0:K.en,onChange:a=>z("vision.en",a),type:"textarea"}),e.jsx(j,{label:"Bahasa Arab",value:(te=x.vision)==null?void 0:te.ar,onChange:a=>z("vision.ar",a),type:"textarea"})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Misi"]}),e.jsxs("button",{onClick:()=>f("mission",{id:"",en:"",ar:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"space-y-3",children:(he=x.mission)==null?void 0:he.map((a,m)=>V(`Poin Misi ${m+1}`,a.id,"",()=>i("mission",m,a),()=>$("mission",m)))})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Core Values"]}),e.jsxs("button",{onClick:()=>f("coreValues",{title:{id:"",en:"",ar:""},icon:"",description:{id:"",en:"",ar:""}}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:(se=x.coreValues)==null?void 0:se.map((a,m)=>{var y,_;return V((y=a.title)==null?void 0:y.id,(_=a.description)==null?void 0:_.id,"",()=>i("coreValues",m,a),()=>$("coreValues",m))})})]})]}),n==="curriculum"&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Intro Kurikulum"]}),e.jsx(j,{label:"Bahasa Indonesia",value:(be=(le=x.curriculum)==null?void 0:le.intro)==null?void 0:be.id,onChange:a=>z("curriculum.intro.id",a),type:"textarea"}),e.jsx(j,{label:"English",value:(l=(E=x.curriculum)==null?void 0:E.intro)==null?void 0:l.en,onChange:a=>z("curriculum.intro.en",a),type:"textarea"}),e.jsx(j,{label:"Bahasa Arab",value:(o=(d=x.curriculum)==null?void 0:d.intro)==null?void 0:o.ar,onChange:a=>z("curriculum.intro.ar",a),type:"textarea"})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Pilar Kurikulum"]}),e.jsxs("button",{onClick:()=>f("curriculum_pillars",{title:{id:"",en:"",ar:""},icon:"",description:{id:"",en:"",ar:""}}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"space-y-3",children:(B=(L=x.curriculum)==null?void 0:L.pillars)==null?void 0:B.map((a,m)=>{var y,_;return V((y=a.title)==null?void 0:y.id,(_=a.description)==null?void 0:_.id,"",()=>i("curriculum_pillars",m,a),()=>$("curriculum_pillars",m))})})]})]}),n==="stats"&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 animate-fade-in-up",children:["students","alumni","teachers","awards"].map(a=>{var m,y,_,ge,Ce,De,Pe,Fe,Ke,Re,c,S,Z;return e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsx("h5",{className:"font-bold mb-4 text-slate-800 dark:text-slate-200 capitalize",children:a}),e.jsx(j,{label:"Label Indonesia",value:(_=(y=(m=x.stats)==null?void 0:m[a])==null?void 0:y.label)==null?void 0:_.id,onChange:I=>z(`stats.${a}.label.id`,I)}),e.jsx(j,{label:"Label English",value:(De=(Ce=(ge=x.stats)==null?void 0:ge[a])==null?void 0:Ce.label)==null?void 0:De.en,onChange:I=>z(`stats.${a}.label.en`,I)}),e.jsx(j,{label:"Label Arabic",value:(Ke=(Fe=(Pe=x.stats)==null?void 0:Pe[a])==null?void 0:Fe.label)==null?void 0:Ke.ar,onChange:I=>z(`stats.${a}.label.ar`,I)}),e.jsx("div",{className:"border-t my-4 border-slate-200 dark:border-slate-600"}),e.jsx(j,{label:"Nilai Saat Ini",value:(c=(Re=x.stats)==null?void 0:Re[a])==null?void 0:c.value,onChange:I=>z(`stats.${a}.value`,parseInt(I)),type:"number"}),e.jsx(j,{label:"Target / Maksimal",value:(Z=(S=x.stats)==null?void 0:S[a])==null?void 0:Z.max,onChange:I=>z(`stats.${a}.max`,parseInt(I)),type:"number"})]},a)})}),n==="team"&&e.jsxs("div",{className:"animate-fade-in-up bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Tim Pengelola"]}),e.jsxs("button",{onClick:()=>f("team",{name:{id:"",en:"",ar:""},role:{id:"",en:"",ar:""},image:"",bio:{id:"",en:"",ar:""},quote:{id:"",en:"",ar:""}}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(G=x.team)==null?void 0:G.slice(0,F).map((a,m)=>{var y,_;return V((y=a.name)==null?void 0:y.id,(_=a.role)==null?void 0:_.id,a.image,()=>i("team",m,a),()=>$("team",m))})}),de(((fe=x.team)==null?void 0:fe.length)||0)]}),n==="gallery"&&e.jsxs("div",{className:"animate-fade-in-up bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Galeri Foto"]}),e.jsxs("button",{onClick:()=>f("gallery",{category:{id:"",en:"",ar:""},title:{id:"",en:"",ar:""},description:{id:"",en:"",ar:""},image:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:(ue=x.gallery)==null?void 0:ue.slice(0,F).map((a,m)=>{var y,_;return V((y=a.title)==null?void 0:y.id,(_=a.category)==null?void 0:_.id,a.image,()=>i("gallery",m,a),()=>$("gallery",m))})}),de(((ke=x.gallery)==null?void 0:ke.length)||0)]}),n==="news"&&e.jsxs("div",{className:"animate-fade-in-up bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Berita"]}),e.jsxs("button",{onClick:()=>f("news",{title:{id:"",en:"",ar:""},category:{id:"",en:"",ar:""},date:"",description:{id:"",en:"",ar:""},image:"",author:"",source:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(Te=x.news)==null?void 0:Te.slice(0,F).map((a,m)=>{var y;return V((y=a.title)==null?void 0:y.id,a.date,a.image,()=>i("news",m,a),()=>$("news",m))})}),de(((Ie=x.news)==null?void 0:Ie.length)||0)]}),n==="testimonials"&&e.jsxs("div",{className:"animate-fade-in-up bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Testimoni"]}),e.jsxs("button",{onClick:()=>f("testimonials",{name:{id:"",en:"",ar:""},role:{id:"",en:"",ar:""},quote:{id:"",en:"",ar:""},image:"",rating:5}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:(Be=x.testimonials)==null?void 0:Be.slice(0,F).map((a,m)=>{var y,_;return V((y=a.name)==null?void 0:y.id,(_=a.role)==null?void 0:_.id,a.image,()=>i("testimonials",m,a),()=>$("testimonials",m))})}),de(((t=x.testimonials)==null?void 0:t.length)||0)]}),n==="faq"&&e.jsxs("div",{className:"animate-fade-in-up bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," FAQ"]}),e.jsxs("button",{onClick:()=>f("faq",{q:{id:"",en:"",ar:""},a:{id:"",en:"",ar:""}}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),e.jsx("div",{className:"space-y-3",children:(w=x.faq)==null?void 0:w.slice(0,F).map((a,m)=>{var y;return V((y=a.q)==null?void 0:y.id,"","",()=>i("faq",m,a),()=>$("faq",m))})}),de(((ee=x.faq)==null?void 0:ee.length)||0)]})]}),H&&O&&e.jsx("div",{className:"fixed inset-0 z-[200] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-2xl rounded-3xl shadow-2xl relative flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-100 dark:border-slate-800",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora capitalize",children:R!==null?"Edit Data":"Tambah Data"}),e.jsx("button",{onClick:()=>Q(!1),className:"p-2 bg-slate-100 dark:bg-slate-800 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors",children:e.jsx(C.Close,{})})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-4",children:[W==="mission"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Bahasa Indonesia",value:O.id,onChange:a=>D("id",a),type:"textarea"}),e.jsx(j,{label:"English",value:O.en,onChange:a=>D("en",a),type:"textarea"}),e.jsx(j,{label:"Bahasa Arab",value:O.ar,onChange:a=>D("ar",a),type:"textarea"})]}),(W==="coreValues"||W==="curriculum_pillars")&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Icon Key",value:O.icon,onChange:a=>D("icon",a)}),e.jsx(u,{label:"Judul / Title",pathPrefix:"title"}),e.jsx(u,{label:"Deskripsi / Description",pathPrefix:"description",type:"textarea"})]}),W==="team"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Foto URL",value:O.image,onChange:a=>D("image",a),isImage:!0}),e.jsx(u,{label:"Nama",pathPrefix:"name"}),e.jsx(u,{label:"Role / Jabatan",pathPrefix:"role"}),e.jsx(u,{label:"Bio Singkat",pathPrefix:"bio",type:"textarea"}),e.jsx(u,{label:"Kutipan / Quote",pathPrefix:"quote",type:"textarea"})]}),W==="gallery"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Image URL",value:O.image,onChange:a=>D("image",a),isImage:!0}),e.jsx(u,{label:"Judul Foto",pathPrefix:"title"}),e.jsx(u,{label:"Kategori",pathPrefix:"category"}),e.jsx(u,{label:"Deskripsi",pathPrefix:"description",type:"textarea"})]}),W==="news"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Image URL",value:O.image,onChange:a=>D("image",a),isImage:!0}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"Tanggal",value:O.date,onChange:a=>D("date",a)}),e.jsx(j,{label:"Author",value:O.author,onChange:a=>D("author",a)})]}),e.jsx(j,{label:"Source Link",value:O.source,onChange:a=>D("source",a)}),e.jsx(u,{label:"Kategori",pathPrefix:"category"}),e.jsx(u,{label:"Judul Berita",pathPrefix:"title"}),e.jsx(u,{label:"Konten / Deskripsi",pathPrefix:"description",type:"textarea"})]}),W==="testimonials"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Image URL",value:O.image,onChange:a=>D("image",a),isImage:!0}),e.jsx(j,{label:"Rating (1-5)",value:O.rating,onChange:a=>D("rating",parseInt(a)),type:"number"}),e.jsx(u,{label:"Nama",pathPrefix:"name"}),e.jsx(u,{label:"Role / Status",pathPrefix:"role"}),e.jsx(u,{label:"Kutipan / Quote",pathPrefix:"quote",type:"textarea"})]}),W==="faq"&&e.jsxs(e.Fragment,{children:[e.jsx(u,{label:"Pertanyaan (Q)",pathPrefix:"q"}),e.jsx(u,{label:"Jawaban (A)",pathPrefix:"a",type:"textarea"})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-100 dark:border-slate-800 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>Q(!1),className:"px-6 py-2 text-slate-500 font-bold hover:bg-slate-100 rounded-lg transition-colors",children:"Batal"}),e.jsxs("button",{onClick:g,className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-bold shadow-lg transition-transform active:scale-95 flex items-center gap-2",children:[e.jsx(C.Save,{})," Simpan"]})]})]})}),e.jsx("div",{className:"sticky bottom-0 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md p-4 border-t border-slate-100 dark:border-slate-800 flex justify-end -mx-6 -mb-6 rounded-b-3xl",children:e.jsxs("button",{onClick:ne,disabled:p,className:"bg-emerald-600 hover:bg-emerald-700 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-emerald-200 dark:shadow-none transition-transform active:scale-95 flex items-center gap-2",children:[p?e.jsx(C.Refresh,{}):e.jsx(C.Save,{})," ",p?"Menyimpan...":"Simpan Perubahan"]})})]})},Le=({label:M,value:n,onChange:N,type:x="text"})=>e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:[M," (Multi-Bahasa)"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-2",children:[e.jsx("input",{type:x,placeholder:"Bahasa Indonesia",className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-sm outline-none",value:(n==null?void 0:n.id)||"",onChange:P=>N({...n,id:P.target.value})}),e.jsx("input",{type:x,placeholder:"English",className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-sm outline-none",value:(n==null?void 0:n.en)||"",onChange:P=>N({...n,en:P.target.value})}),e.jsx("input",{type:x,placeholder:"Bahasa Arab",className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 text-sm outline-none text-right",value:(n==null?void 0:n.ar)||"",onChange:P=>N({...n,ar:P.target.value})})]})]}),ua=({language:M})=>{var v,ce,V,de,u,ae,X,xe,we,k,A,K,te,he,se,le,be,E;const[n,N]=r.useState(He),[x,P]=r.useState("global"),[p,U]=r.useState("mi_alhikmah_mustofa"),[J,H]=r.useState(!1),[Q,W]=r.useState(!1),Y=r.useRef(null),[R,re]=r.useState(6),O=[{id:"global",label:"Global"},{id:"units",label:"Unit"},{id:"achievements",label:"Prestasi"},{id:"articles",label:"Artikel"}];r.useEffect(()=>{q()},[]),r.useEffect(()=>{W(!1),re(6)},[p,x]);const q=async()=>{const l=await Ae(`${Ne}/api/data?type=unit`);if(l){const d=Array.isArray(l)?l[0]:l;d&&(N({...He,...d}),d.units&&Object.keys(d.units).length>0&&!Object.keys(d.units).includes(p)&&U(Object.keys(d.units)[0]))}},F=async()=>{H(!0);try{await fetch(`${Ne}/api/data?type=unit`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([n])}),alert("Data Unit Disimpan!"),W(!1)}catch{alert("Gagal menyimpan.")}finally{H(!1)}},oe=(l,d)=>{N(o=>{let L=$e(o,l,d);if(d&&typeof d=="object"&&"id"in d){const B=l.split(".");let G=o;for(let ke=0;ke<B.length;ke++)if(G[B[ke]])G=G[B[ke]];else{G=null;break}const fe=(G==null?void 0:G.id)||"",ue=d.id||"";fe!==ue&&(d.en="",d.ar=""),L=$e(o,l,d)}return L})},b=(l,d,o,L)=>{N(B=>{const G=[...B[l]||[]];return G[d]?(o?(L&&typeof L=="object"&&"id"in L&&(G[d][o]||{}).id!==L.id&&(L.en="",L.ar=""),o.includes(".")?G[d]=$e(G[d],o,L):G[d]={...G[d],[o]:L}):(L&&typeof L=="object"&&"id"in L&&(G[d]||{}).id!==L.id&&(L.en="",L.ar=""),G[d]=L),{...B,[l]:G}):B})},me=(l,d)=>{N(o=>({...o,[l]:[...o[l]||[],d]}))},ne=(l,d)=>{N(o=>({...o,[l]:o[l].filter((L,B)=>B!==d)}))},z=(l,d,o,L,B)=>{N(G=>{const fe=G.units[l];if(!fe)return G;const ue=[...fe[d]||[]];if(B&&typeof B=="object"&&"id"in B){let ke;L?ke=ue[o][L]||{}:ke=ue[o]||{},ke.id!==B.id&&(B.en="",B.ar="")}return L?L.includes(".")?ue[o]=$e(ue[o],L,B):ue[o]={...ue[o],[L]:B}:ue[o]=B,$e(G,`units.${l}.${d}`,ue)})},f=(l,d,o)=>{N(L=>{var G;const B=((G=L.units[l])==null?void 0:G[d])||[];return $e(L,`units.${l}.${d}`,[...B,o])})},i=(l,d,o)=>{N(L=>{var G;const B=((G=L.units[l])==null?void 0:G[d])||[];return $e(L,`units.${l}.${d}`,B.filter((fe,ue)=>ue!==o))})},D=()=>{const l=JSON.stringify(n,null,2),d="data:application/json;charset=utf-8,"+encodeURIComponent(l),o="unit-data.json",L=document.createElement("a");L.setAttribute("href",d),L.setAttribute("download",o),L.click()},g=l=>{const d=new FileReader;l.target.files&&l.target.files[0]&&(d.readAsText(l.target.files[0],"UTF-8"),d.onload=o=>{var L;if((L=o.target)!=null&&L.result)try{const B=JSON.parse(o.target.result);N({...He,...B}),alert("Data Unit berhasil diimpor!")}catch(B){alert("Format file JSON tidak valid."),console.error(B)}})},$=l=>l>R?e.jsxs("button",{onClick:()=>re(d=>d+6),className:"w-full py-3 bg-slate-100 dark:bg-slate-800 text-slate-500 dark:text-slate-400 font-bold rounded-xl hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors mt-6 text-xs flex items-center justify-center gap-2",children:[e.jsx(C.Refresh,{})," Muat Lebih Banyak (",l-R," lagi)"]}):null;return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 p-6 min-h-[600px]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 border-b border-slate-100 dark:border-slate-800 pb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Manajemen Unit"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Kelola informasi setiap unit pendidikan."})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:D,className:"flex items-center gap-2 px-4 py-2 bg-blue-50 text-blue-600 hover:bg-blue-100 rounded-lg text-xs font-bold transition-colors",children:[e.jsx(C.Download,{})," Export JSON"]}),e.jsxs("button",{onClick:()=>{var l;return(l=Y.current)==null?void 0:l.click()},className:"flex items-center gap-2 px-4 py-2 bg-emerald-50 text-emerald-600 hover:bg-emerald-100 rounded-lg text-xs font-bold transition-colors",children:[e.jsx(C.Upload,{})," Import JSON"]}),e.jsx("input",{type:"file",ref:Y,onChange:g,accept:".json",className:"hidden"})]})]}),e.jsx("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-xl overflow-x-auto max-w-full no-scrollbar mb-6",children:O.map(l=>e.jsx("button",{onClick:()=>P(l.id),className:`px-5 py-2 rounded-lg text-sm font-bold transition-all whitespace-nowrap ${x===l.id?"bg-white dark:bg-slate-700 text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:l.label},l.id))}),e.jsxs("div",{className:"pb-20",children:[x==="global"&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Main Settings"]}),e.jsx(j,{label:"Main Logo URL",value:n.logo,onChange:l=>oe("logo",l),isImage:!0}),e.jsx(j,{label:"Hero Video URL",value:(v=n.hero)==null?void 0:v.videoUrl,onChange:l=>oe("hero.videoUrl",l)})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Kategori"]}),e.jsxs("button",{onClick:()=>me("categories",{id:"",en:"",ar:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),(ce=n.categories)==null?void 0:ce.map((l,d)=>e.jsxs("div",{className:"mb-4 pb-2 border-b border-slate-200 dark:border-slate-700 last:border-0 relative",children:[e.jsx("button",{onClick:()=>ne("categories",d),className:"absolute top-0 right-0 text-red-400 hover:text-red-600",children:e.jsx(C.Trash,{})}),e.jsx(Le,{label:`Category ${d+1}`,value:l,onChange:o=>b("categories",d,"",o)})]},d))]})]}),x==="units"&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{className:"w-full md:w-64",children:[e.jsx("label",{className:"text-xs font-bold text-slate-500 block mb-1",children:"Pilih Unit Pendidikan"}),e.jsxs("div",{className:"relative",children:[e.jsx("select",{value:p,onChange:l=>U(l.target.value),className:"w-full px-4 py-3 bg-slate-100 dark:bg-slate-800 rounded-xl border-none font-bold text-emerald-600 outline-none appearance-none cursor-pointer",children:Object.keys(n.units||{}).map(l=>{var d,o;return e.jsx("option",{value:l,children:((o=(d=n.units[l])==null?void 0:d.short)==null?void 0:o.id)||l},l)})}),e.jsx("div",{className:"absolute right-4 top-1/2 -translate-y-1/2 pointer-events-none text-slate-400",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 9l-7 7-7-7"})})})]})]})}),n.units[p]&&e.jsxs(e.Fragment,{children:[!Q&&e.jsxs("div",{className:"bg-white dark:bg-slate-800 rounded-3xl border border-slate-200 dark:border-slate-700 shadow-sm overflow-hidden animate-fade-in-up",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-700 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-slate-50 dark:bg-slate-800/50",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-white dark:bg-slate-700 rounded-2xl p-2 flex items-center justify-center border border-slate-200 dark:border-slate-600 shadow-sm",children:e.jsx("img",{src:n.units[p].logoImg||n.logo,alt:"Logo",className:"w-full h-full object-contain"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:((V=n.units[p].name)==null?void 0:V.id)||"Nama Unit"}),e.jsx("span",{className:"text-sm font-bold text-emerald-600 dark:text-emerald-400",children:((de=n.units[p].short)==null?void 0:de.id)||"Short Name"})]})]}),e.jsxs("button",{onClick:()=>W(!0),className:"px-6 py-2.5 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-bold shadow-lg transition-transform active:scale-95 flex items-center gap-2",children:[e.jsx(C.Edit,{})," Edit Unit Ini"]})]}),e.jsxs("div",{className:"p-6 md:p-8 space-y-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-8 items-start",children:[e.jsxs("div",{className:"w-full md:w-1/3 flex flex-col items-center text-center p-6 bg-slate-50 dark:bg-slate-900 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-32 h-32 rounded-full overflow-hidden border-4 border-white dark:border-slate-700 shadow-md mb-4",children:e.jsx("img",{src:n.units[p].headmasterImg,alt:"Kepala Sekolah",className:"w-full h-full object-cover"})}),e.jsx("h5",{className:"font-bold text-slate-800 dark:text-slate-100 text-lg",children:n.units[p].headmasterName}),e.jsx("p",{className:"text-xs text-slate-500 uppercase tracking-widest font-bold mt-1",children:"Kepala Sekolah"})]}),e.jsxs("div",{className:"w-full md:w-2/3 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-slate-400 uppercase mb-2",children:"Deskripsi"}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300 leading-relaxed text-sm",children:(u=n.units[p].desc)==null?void 0:u.id})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-slate-400 uppercase mb-2",children:"Visi"}),e.jsxs("p",{className:"text-slate-700 dark:text-slate-300 italic font-lora text-lg",children:['"',(ae=n.units[p].vision)==null?void 0:ae.id,'"']})]})]})]}),((X=n.units[p].profileMedia)==null?void 0:X.url)&&e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-slate-400 uppercase mb-3",children:"Media Profil"}),e.jsxs("div",{className:"aspect-video rounded-xl overflow-hidden bg-black relative group",children:[e.jsx("img",{src:n.units[p].profileMedia.thumbnail||n.units[p].profileMedia.url,className:"w-full h-full object-cover opacity-80",alt:"Media"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"bg-white/20 backdrop-blur-md p-3 rounded-full",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM9.555 7.168A1 1 0 008 8.118v3.764a1 1 0 001.555.832l3.198-1.882a1 1 0 000-1.664l-3.198-1.882z",clipRule:"evenodd"})})})})]})]}),e.jsxs("div",{className:"grid md:grid-cols-2 gap-8 pt-6 border-t border-slate-100 dark:border-slate-800",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-slate-400 uppercase mb-4",children:"Misi"}),e.jsx("ul",{className:"space-y-2",children:(xe=n.units[p].mission)==null?void 0:xe.map((l,d)=>e.jsxs("li",{className:"flex gap-3 text-sm text-slate-600 dark:text-slate-300",children:[e.jsx("span",{className:"w-5 h-5 rounded-full bg-emerald-100 text-emerald-600 flex items-center justify-center text-xs font-bold flex-shrink-0 mt-0.5",children:d+1}),l.id]},d))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-bold text-slate-400 uppercase mb-4",children:"Program Unggulan"}),e.jsx("div",{className:"space-y-3",children:(we=n.units[p].programs)==null?void 0:we.map((l,d)=>{var o,L;return e.jsxs("div",{className:"flex gap-3 items-center bg-slate-50 dark:bg-slate-900 p-3 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"p-2 bg-white dark:bg-slate-800 rounded-lg shadow-sm",children:e.jsx("span",{className:"text-lg",children:"✨"})}),e.jsxs("div",{children:[e.jsx("h6",{className:"font-bold text-sm text-slate-800 dark:text-slate-200",children:(o=l.title)==null?void 0:o.id}),e.jsx("p",{className:"text-xs text-slate-500",children:(L=l.desc)==null?void 0:L.id})]})]},d)})})]})]})]})]}),Q&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsx("div",{className:"flex justify-end mb-4",children:e.jsxs("button",{onClick:()=>W(!1),className:"px-4 py-2 bg-slate-200 dark:bg-slate-700 text-slate-700 dark:text-slate-200 rounded-lg font-bold text-sm hover:bg-slate-300 transition-colors flex items-center gap-2",children:[e.jsx(C.Close,{})," Batal Edit"]})}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Informasi Dasar"]}),e.jsx(Le,{label:"Nama Unit",value:n.units[p].name,onChange:l=>oe(`units.${p}.name`,l)}),e.jsx(Le,{label:"Nama Pendek",value:n.units[p].short,onChange:l=>oe(`units.${p}.short`,l)}),e.jsx(Le,{label:"Deskripsi",value:n.units[p].desc,onChange:l=>oe(`units.${p}.desc`,l),type:"textarea"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:[e.jsx(j,{label:"Nama Kepala Sekolah",value:n.units[p].headmasterName,onChange:l=>oe(`units.${p}.headmasterName`,l)}),e.jsx(j,{label:"Foto Kepala Sekolah",value:n.units[p].headmasterImg,onChange:l=>oe(`units.${p}.headmasterImg`,l),isImage:!0}),e.jsx(j,{label:"Logo Unit",value:n.units[p].logoImg,onChange:l=>oe(`units.${p}.logoImg`,l),isImage:!0})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 mb-4 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Media Profil & Visi"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Type"}),e.jsxs("select",{value:(k=n.units[p].profileMedia)==null?void 0:k.type,onChange:l=>oe(`units.${p}.profileMedia.type`,l.target.value),className:"w-full px-3 py-2 bg-white dark:bg-slate-900 rounded-lg border border-slate-200 dark:border-slate-700 text-sm outline-none",children:[e.jsx("option",{value:"image",children:"Image"}),e.jsx("option",{value:"video",children:"Video"})]})]}),e.jsx(j,{label:"URL Media",value:(A=n.units[p].profileMedia)==null?void 0:A.url,onChange:l=>oe(`units.${p}.profileMedia.url`,l),isImage:!0}),e.jsx(j,{label:"Thumbnail",value:(K=n.units[p].profileMedia)==null?void 0:K.thumbnail,onChange:l=>oe(`units.${p}.profileMedia.thumbnail`,l),isImage:!0})]}),e.jsx(Le,{label:"Visi",value:n.units[p].vision,onChange:l=>oe(`units.${p}.vision`,l),type:"textarea"})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Misi"]}),e.jsxs("button",{onClick:()=>f(p,"mission",{id:"",en:"",ar:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),(te=n.units[p].mission)==null?void 0:te.map((l,d)=>e.jsxs("div",{className:"mb-4 pb-2 border-b border-slate-200 dark:border-slate-700 last:border-0 relative",children:[e.jsx("button",{onClick:()=>i(p,"mission",d),className:"absolute top-0 right-0 text-red-400 hover:text-red-600",children:e.jsx(C.Trash,{})}),e.jsx(Le,{label:`Poin ${d+1}`,value:l,onChange:o=>z(p,"mission",d,"",o)})]},d))]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-200 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Program Unggulan"]}),e.jsxs("button",{onClick:()=>f(p,"programs",{title:{id:"",en:"",ar:""},desc:{id:"",en:"",ar:""},icon:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),(he=n.units[p].programs)==null?void 0:he.map((l,d)=>e.jsxs("div",{className:"mb-6 pb-4 border-b border-slate-200 dark:border-slate-700 last:border-0 relative",children:[e.jsx("button",{onClick:()=>i(p,"programs",d),className:"absolute top-0 right-0 text-red-400 hover:text-red-600",children:e.jsx(C.Trash,{})}),e.jsx(j,{label:"Icon Key",value:l.icon,onChange:o=>z(p,"programs",d,"icon",o)}),e.jsx(Le,{label:"Judul Program",value:l.title,onChange:o=>z(p,"programs",d,"title",o)}),e.jsx(Le,{label:"Deskripsi Program",value:l.desc,onChange:o=>z(p,"programs",d,"desc",o)})]},d))]})]})]})]}),x==="achievements"&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Daftar Prestasi"]}),e.jsxs("button",{onClick:()=>me("achievements",{name:{id:"",en:"",ar:""},title:{id:"",en:"",ar:""},category:{id:"",en:"",ar:""},story:{id:"",en:"",ar:""},image:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),(se=n.achievements)==null?void 0:se.slice(0,R).map((l,d)=>e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700 mb-4 relative",children:[e.jsx("button",{onClick:()=>ne("achievements",d),className:"absolute top-4 right-4 text-red-400 hover:text-red-600",children:e.jsx(C.Trash,{})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{label:"Image URL",value:l.image,onChange:o=>b("achievements",d,"image",o),isImage:!0}),e.jsx(Le,{label:"Nama",value:l.name,onChange:o=>b("achievements",d,"name",o)}),e.jsx(Le,{label:"Judul Prestasi",value:l.title,onChange:o=>b("achievements",d,"title",o)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Le,{label:"Kategori",value:l.category,onChange:o=>b("achievements",d,"category",o)}),e.jsx(Le,{label:"Cerita / Deskripsi",value:l.story,onChange:o=>b("achievements",d,"story",o),type:"textarea"})]})]})]},d)),$(((le=n.achievements)==null?void 0:le.length)||0)]}),x==="articles"&&e.jsxs("div",{className:"space-y-6 animate-fade-in-up",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h4",{className:"font-bold text-slate-800 dark:text-slate-100 flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-6 bg-emerald-500 rounded-full"})," Artikel Cerita"]}),e.jsxs("button",{onClick:()=>me("articles",{title:{id:"",en:"",ar:""},teaser:{id:"",en:"",ar:""},content:{id:"",en:"",ar:""},image:""}),className:"text-xs bg-emerald-100 text-emerald-700 px-3 py-1.5 rounded-full font-bold hover:bg-emerald-200 transition-colors flex items-center gap-1",children:[e.jsx(C.Plus,{})," Tambah"]})]}),(be=n.articles)==null?void 0:be.slice(0,R).map((l,d)=>e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 p-6 rounded-2xl border border-slate-100 dark:border-slate-700 mb-4 relative",children:[e.jsx("button",{onClick:()=>ne("articles",d),className:"absolute top-4 right-4 text-red-400 hover:text-red-600",children:e.jsx(C.Trash,{})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(j,{label:"Image URL",value:l.image,onChange:o=>b("articles",d,"image",o),isImage:!0}),e.jsx(Le,{label:"Judul",value:l.title,onChange:o=>b("articles",d,"title",o)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(Le,{label:"Teaser",value:l.teaser,onChange:o=>b("articles",d,"teaser",o)}),e.jsx(Le,{label:"Konten",value:l.content,onChange:o=>b("articles",d,"content",o),type:"textarea"})]})]})]},d)),$(((E=n.articles)==null?void 0:E.length)||0)]})]}),e.jsx("div",{className:"sticky bottom-0 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md p-4 border-t border-slate-100 dark:border-slate-800 flex justify-end -mx-6 -mb-6 rounded-b-3xl",children:e.jsxs("button",{onClick:F,disabled:J,className:"bg-emerald-600 hover:bg-emerald-700 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-emerald-200 dark:shadow-none transition-transform active:scale-95 flex items-center gap-2",children:[J?e.jsx(C.Refresh,{}):e.jsx(C.Save,{})," ",J?"Menyimpan...":"Simpan Perubahan"]})})]})},ha=({language:M,setHideNav:n})=>{var de,u,ae,X,xe,we,k,A,K,te,he,se,le,be,E,l,d,o,L,B,G,fe,ue,ke,Te,Ie,Be;const[N,x]=r.useState("siswa"),[P,p]=r.useState([]),[U,J]=r.useState([]),[H,Q]=r.useState([]),[W,Y]=r.useState(!1),[R,re]=r.useState(""),[O,q]=r.useState(!1),[F,oe]=r.useState("siswa"),[b,me]=r.useState(null),[ne,z]=r.useState("identitas"),f=[{id:"siswa",label:"Data Siswa"},{id:"pegawai",label:"Data Pegawai"},{id:"akun",label:"Data Akun"}];r.useEffect(()=>{i()},[]),r.useEffect(()=>{re("")},[N]),r.useEffect(()=>(O?(document.body.style.overflow="hidden",n&&n(!0)):(document.body.style.overflow="",n&&n(!1)),()=>{document.body.style.overflow="",n&&n(!1)}),[O,n]);const i=async()=>{Y(!0);const[t,w,ee]=await Promise.all([Ae(`${Ne}/api/data?type=siswa`),Ae(`${Ne}/api/data?type=pegawai`),Ae(`${Ne}/api/accounts`)]);t&&p(Array.isArray(t)?t:[]),w&&J(Array.isArray(w)?w:[]),ee&&Q(Array.isArray(ee)?ee:[]),Y(!1)},g=(()=>{const t=R.toLowerCase();return N==="siswa"?t?P.filter(w=>{var ee,a,m;return((ee=w.identitas)==null?void 0:ee.nama)&&w.identitas.nama.toLowerCase().includes(t)||w.nisn&&w.nisn.toLowerCase().includes(t)||((a=w.status)==null?void 0:a.kelas)&&w.status.kelas.toLowerCase().includes(t)||((m=w.status)==null?void 0:m.sekolah)&&w.status.sekolah.toLowerCase().includes(t)}):P:N==="pegawai"?t?U.filter(w=>{var ee,a;return((ee=w.identitas)==null?void 0:ee.nama)&&w.identitas.nama.toLowerCase().includes(t)||w.nip&&w.nip.toLowerCase().includes(t)||((a=w.statusKepegawaian)==null?void 0:a.jabatan)&&w.statusKepegawaian.jabatan.toLowerCase().includes(t)}):U:t?H.filter(w=>w.nama&&w.nama.toLowerCase().includes(t)||w.email&&w.email.toLowerCase().includes(t)||w.telpon&&w.telpon.toLowerCase().includes(t)||w.sebagai&&w.sebagai.toLowerCase().includes(t)||w.uniquecode&&w.uniquecode.toLowerCase().includes(t)):H})(),$=(t,w)=>{oe(t),me(w?JSON.parse(JSON.stringify(w)):t==="siswa"?{...ra}:t==="pegawai"?{...na}:{...oa}),z("identitas"),q(!0)},v=(t,w)=>{me(ee=>$e(ee,t,w))},ce=async()=>{if(!b)return;Y(!0);const t=F;let w,ee=t;if(t==="siswa")w=[...P.filter(m=>m.nisn!==b.nisn),b],p(w);else if(t==="pegawai")w=[...U.filter(m=>m.nip!==b.nip),b],J(w);else{ee="account";let a={...b};if(!a.idAccount){const _={parrent:"WS",teacher:"GR",staff:"ST",admin:"AD",user:"PG"}[a.sebagai]||"PG",ge=Math.floor(1e3+Math.random()*9e3);a.idAccount=`MHAC-${_}-${ge}-${Date.now().toString().slice(-4)}`,a.createdAt=new Date().toISOString()}w=[...H.filter(y=>y.idAccount!==a.idAccount),a],Q(w),me(a)}try{await fetch(`${Ne}/api/data?type=${ee}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(w)}),alert("Data berhasil disimpan!"),q(!1),me(null)}catch(a){alert("Gagal menyimpan data."),console.error(a),i()}finally{Y(!1)}},V=async(t,w)=>{if(!confirm("Apakah Anda yakin ingin menghapus data ini?"))return;Y(!0);let ee,a=w;w==="siswa"?(ee=P.filter(m=>m.nisn!==t),p(ee)):w==="pegawai"?(ee=U.filter(m=>m.nip!==t),J(ee)):(a="account",ee=H.filter(m=>m.idAccount!==t),Q(ee));try{await fetch(`${Ne}/api/data?type=${a}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ee)})}catch{alert("Gagal menghapus data."),i()}finally{Y(!1)}};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 p-6 min-h-[600px]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 border-b border-slate-100 dark:border-slate-800 pb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Pusat Data"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Kelola data induk Siswa, Pegawai, dan Akun."})]}),e.jsx("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-xl overflow-x-auto max-w-full",children:f.map(t=>e.jsx("button",{onClick:()=>x(t.id),className:`px-5 py-2 rounded-lg text-sm font-bold transition-all whitespace-nowrap ${N===t.id?"bg-white dark:bg-slate-700 text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:t.label},t.id))})]}),e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-center mb-6 gap-4 animate-fade-in-up",children:[e.jsxs("h4",{className:"font-bold text-lg text-slate-700 dark:text-slate-200",children:["Daftar ",N.charAt(0).toUpperCase()+N.slice(1)," ",e.jsxs("span",{className:"text-slate-400 text-sm font-normal",children:["(",g.length,")"]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-2 w-full md:w-auto",children:[e.jsxs("div",{className:"relative w-full md:w-64",children:[e.jsx("input",{type:"text",placeholder:`Cari ${N}...`,value:R,onChange:t=>re(t.target.value),className:"w-full pl-9 pr-4 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-sm outline-none focus:ring-2 focus:ring-emerald-500 transition-all"}),e.jsx("div",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{onClick:()=>$(N),className:"bg-emerald-100 text-emerald-700 px-4 py-2 rounded-lg text-sm font-bold flex items-center justify-center gap-2 hover:bg-emerald-200 transition-colors shadow-sm whitespace-nowrap flex-grow md:flex-grow-0",children:[e.jsx(C.Plus,{})," ",e.jsx("span",{className:"hidden md:inline",children:"Tambah"})]}),e.jsx("button",{onClick:i,className:"p-2 rounded-lg bg-slate-100 hover:bg-slate-200 text-slate-600 transition-colors",children:e.jsx(C.Refresh,{})})]})]})]}),W&&e.jsx("div",{className:"flex justify-center py-10",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-emerald-600"})}),!W&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 animate-fade-in-up",children:[N==="siswa"&&(g.length===0?e.jsx("div",{className:"col-span-full text-center py-20 text-slate-400 italic",children:"Data siswa tidak ditemukan."}):g.map((t,w)=>{var ee,a,m,y,_;return e.jsxs("div",{className:"bg-white dark:bg-slate-800 border border-slate-100 dark:border-slate-700 hover:border-emerald-200 dark:hover:border-emerald-800 hover:shadow-lg rounded-2xl p-4 flex gap-4 transition-all duration-300 group relative",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-700 overflow-hidden flex-shrink-0 border-2 border-white dark:border-slate-600 shadow-sm",children:e.jsx("img",{src:((ee=t.identitas)==null?void 0:ee.foto)||`https://ui-avatars.com/api/?name=${(a=t.identitas)==null?void 0:a.nama}&background=random`,alt:"Foto",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100 truncate",children:(m=t.identitas)==null?void 0:m.nama}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-mono mb-2",children:t.nisn}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 text-[10px] font-bold rounded uppercase",children:(y=t.status)==null?void 0:y.sekolah}),e.jsx("span",{className:"px-2 py-0.5 bg-blue-50 dark:bg-blue-900/30 text-blue-700 dark:text-blue-400 text-[10px] font-bold rounded uppercase",children:(_=t.status)==null?void 0:_.kelas})]})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity bg-white/90 dark:bg-slate-800/90 p-1 rounded-lg shadow-sm",children:[e.jsx("button",{onClick:()=>$("siswa",t),className:"text-blue-500 hover:text-blue-700 p-1",children:e.jsx(C.Edit,{})}),e.jsx("button",{onClick:()=>V(t.nisn,"siswa"),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(C.Trash,{})})]})]},w)})),N==="pegawai"&&(g.length===0?e.jsx("div",{className:"col-span-full text-center py-20 text-slate-400 italic",children:"Data pegawai tidak ditemukan."}):g.map((t,w)=>{var ee,a,m,y,_,ge,Ce;return e.jsxs("div",{className:"bg-white dark:bg-slate-800 border border-slate-100 dark:border-slate-700 hover:border-emerald-200 dark:hover:border-emerald-800 hover:shadow-lg rounded-2xl p-4 flex gap-4 transition-all duration-300 group relative",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-slate-100 dark:bg-slate-700 overflow-hidden flex-shrink-0 border-2 border-white dark:border-slate-600 shadow-sm",children:e.jsx("img",{src:((ee=t.identitas)==null?void 0:ee.foto)||`https://ui-avatars.com/api/?name=${(a=t.identitas)==null?void 0:a.nama}&background=random`,alt:"Foto",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsxs("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100 truncate",children:[(m=t.identitas)==null?void 0:m.gelar_depan," ",(y=t.identitas)==null?void 0:y.nama," ",(_=t.identitas)==null?void 0:_.gelar_belakang]}),e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-400 font-mono mb-2",children:t.nip||"-"}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:"px-2 py-0.5 bg-emerald-50 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 text-[10px] font-bold rounded uppercase",children:(ge=t.statusKepegawaian)==null?void 0:ge.jabatan}),e.jsx("span",{className:"px-2 py-0.5 bg-purple-50 dark:bg-purple-900/30 text-purple-700 dark:text-purple-400 text-[10px] font-bold rounded uppercase",children:(Ce=t.statusKepegawaian)==null?void 0:Ce.jenisGuru})]})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity bg-white/90 dark:bg-slate-800/90 p-1 rounded-lg shadow-sm",children:[e.jsx("button",{onClick:()=>$("pegawai",t),className:"text-blue-500 hover:text-blue-700 p-1",children:e.jsx(C.Edit,{})}),e.jsx("button",{onClick:()=>V(t.nip,"pegawai"),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(C.Trash,{})})]})]},w)})),N==="akun"&&(g.length===0?e.jsx("div",{className:"col-span-full text-center py-20 text-slate-400 italic",children:"Data akun tidak ditemukan."}):g.map((t,w)=>e.jsxs("div",{className:"bg-white dark:bg-slate-800 border border-slate-100 dark:border-slate-700 hover:border-emerald-200 dark:hover:border-emerald-800 hover:shadow-lg rounded-2xl p-4 flex gap-4 transition-all duration-300 group relative",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 dark:text-emerald-400 flex items-center justify-center font-bold text-2xl flex-shrink-0 border-2 border-white dark:border-slate-600 shadow-sm",children:t.nama?t.nama.charAt(0).toUpperCase():"?"}),e.jsxs("div",{className:"flex-grow min-w-0",children:[e.jsx("h4",{className:"font-bold text-lg text-slate-800 dark:text-slate-100 truncate",children:t.nama}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono mb-1 truncate",children:t.email||"-"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 font-mono mb-2 truncate",children:t.telpon}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[e.jsx("span",{className:`px-2 py-0.5 text-[10px] font-bold rounded uppercase ${t.sebagai==="admin"?"bg-red-50 text-red-700":"bg-blue-50 text-blue-700"}`,children:t.sebagai}),t.uniquecode&&e.jsx("span",{className:"px-2 py-0.5 bg-slate-100 dark:bg-slate-700 text-slate-600 dark:text-slate-300 text-[10px] font-bold rounded font-mono",children:t.uniquecode})]})]}),e.jsxs("div",{className:"absolute top-2 right-2 flex gap-1 opacity-0 group-hover:opacity-100 transition-opacity bg-white/90 dark:bg-slate-800/90 p-1 rounded-lg shadow-sm",children:[e.jsx("button",{onClick:()=>$("akun",t),className:"text-blue-500 hover:text-blue-700 p-1",children:e.jsx(C.Edit,{})}),e.jsx("button",{onClick:()=>V(t.idAccount,"akun"),className:"text-red-500 hover:text-red-700 p-1",children:e.jsx(C.Trash,{})})]})]},w)))]}),O&&b&&e.jsx("div",{className:"fixed inset-0 z-[200] bg-black/80 backdrop-blur-sm flex items-center justify-center p-4 overflow-y-auto",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 w-full max-w-2xl rounded-3xl shadow-2xl relative flex flex-col max-h-[90vh]",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-slate-100 dark:border-slate-800",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:(de=b.identitas)!=null&&de.nama||b.nama?`Edit ${F.charAt(0).toUpperCase()+F.slice(1)}`:`Tambah ${F.charAt(0).toUpperCase()+F.slice(1)}`}),e.jsx("button",{onClick:()=>q(!1),className:"p-2 bg-slate-100 dark:bg-slate-800 rounded-full hover:bg-slate-200 dark:hover:bg-slate-700 transition-colors",children:e.jsx(C.Close,{})})]}),e.jsxs("div",{className:"flex-grow overflow-y-auto p-6",children:[(F==="siswa"||F==="pegawai")&&e.jsx("div",{className:"flex gap-2 mb-6 border-b border-slate-100 pb-2 overflow-x-auto scrollbar-hide",children:["identitas","alamat",F==="siswa"?"status":"statusKepegawaian",F==="siswa"?"orangtua":"kontakDarurat"].map(t=>e.jsx("button",{onClick:()=>z(t),className:`px-4 py-2 rounded-lg text-sm font-bold capitalize whitespace-nowrap ${ne===t?"bg-emerald-600 text-white":"bg-slate-100 text-slate-500"}`,children:t.replace(/([A-Z])/g," $1").trim()},t))}),e.jsxs("div",{className:"space-y-4",children:[ne==="identitas"&&(F==="siswa"||F==="pegawai")&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Nama Lengkap",value:(u=b.identitas)==null?void 0:u.nama,onChange:t=>v("identitas.nama",t)}),F==="siswa"?e.jsx(j,{label:"NISN (Wajib & Unik)",value:b.nisn,onChange:t=>v("nisn",t)}):e.jsx(j,{label:"NIP (Jika ada)",value:b.nip,onChange:t=>v("nip",t)}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"Tempat Lahir",value:(ae=b.identitas)==null?void 0:ae.tempat_lahir,onChange:t=>v("identitas.tempat_lahir",t)}),e.jsx(j,{label:"Tanggal Lahir",type:"date",value:(X=b.identitas)==null?void 0:X.tanggal_lahir,onChange:t=>v("identitas.tanggal_lahir",t)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Jenis Kelamin"}),e.jsxs("select",{value:(xe=b.identitas)==null?void 0:xe.jenis_kelamin,onChange:t=>v("identitas.jenis_kelamin",t.target.value),className:"w-full px-3 py-2 bg-slate-50 rounded-lg border border-slate-200 text-sm outline-none",children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"L",children:"Laki-laki"}),e.jsx("option",{value:"P",children:"Perempuan"})]})]}),e.jsx(j,{label:"No. Telepon",value:(we=b.identitas)==null?void 0:we.telpon,onChange:t=>v("identitas.telpon",t)})]}),e.jsx(j,{label:"Email",type:"email",value:(k=b.identitas)==null?void 0:k.email,onChange:t=>v("identitas.email",t)}),e.jsx(j,{label:"Foto URL",value:(A=b.identitas)==null?void 0:A.foto,onChange:t=>v("identitas.foto",t),isImage:!0})]}),ne==="alamat"&&(F==="siswa"||F==="pegawai")&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"Provinsi",value:(K=b.alamat)==null?void 0:K.provinsi,onChange:t=>v("alamat.provinsi",t)}),e.jsx(j,{label:"Kota/Kab",value:(te=b.alamat)==null?void 0:te.kota,onChange:t=>v("alamat.kota",t)})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"Kecamatan",value:(he=b.alamat)==null?void 0:he.kec,onChange:t=>v("alamat.kec",t)}),e.jsx(j,{label:"Desa/Kel",value:(se=b.alamat)==null?void 0:se.desa,onChange:t=>v("alamat.desa",t)})]}),e.jsx(j,{label:"Detail Alamat",type:"textarea",value:(le=b.alamat)==null?void 0:le.detail,onChange:t=>v("alamat.detail",t)})]}),ne==="status"&&F==="siswa"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Sekolah"}),e.jsxs("select",{value:(be=b.status)==null?void 0:be.sekolah,onChange:t=>v("status.sekolah",t.target.value),className:"w-full px-3 py-2 bg-slate-50 rounded-lg border border-slate-200 text-sm outline-none",children:[e.jsx("option",{value:"",children:"Pilih"}),e.jsx("option",{value:"mi",children:"MI Al-Hikmah"}),e.jsx("option",{value:"mtsn",children:"MTsN 2 Purwakarta"}),e.jsx("option",{value:"smpbp",children:"SMP BP"}),e.jsx("option",{value:"smksit",children:"SMKS IT"}),e.jsx("option",{value:"ma",children:"MA Minnatul Huda"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"Kelas",value:(E=b.status)==null?void 0:E.kelas,onChange:t=>v("status.kelas",t)}),e.jsx(j,{label:"Jurusan (SMK)",value:(l=b.status)==null?void 0:l.jurusan,onChange:t=>v("status.jurusan",t)})]}),e.jsx(j,{label:"Tinggal (Asrama/Pulang)",value:(d=b.status)==null?void 0:d.tinggal,onChange:t=>v("status.tinggal",t)})]}),ne==="statusKepegawaian"&&F==="pegawai"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Jabatan",value:(o=b.statusKepegawaian)==null?void 0:o.jabatan,onChange:t=>v("statusKepegawaian.jabatan",t)}),e.jsx(j,{label:"Jenis Guru",value:(L=b.statusKepegawaian)==null?void 0:L.jenisGuru,onChange:t=>v("statusKepegawaian.jenisGuru",t)}),e.jsx(j,{label:"Mulai Bertugas",type:"date",value:(B=b.statusKepegawaian)==null?void 0:B.mulaiBertugas,onChange:t=>v("statusKepegawaian.mulaiBertugas",t)})]}),ne==="orangtua"&&F==="siswa"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Nama Ayah",value:(G=b.orangtua)==null?void 0:G.nama_ayah,onChange:t=>v("orangtua.nama_ayah",t)}),e.jsx(j,{label:"Pekerjaan Ayah",value:(fe=b.orangtua)==null?void 0:fe.pekerjaan_ayah,onChange:t=>v("orangtua.pekerjaan_ayah",t)}),e.jsx(j,{label:"Nama Ibu",value:(ue=b.orangtua)==null?void 0:ue.nama_ibu,onChange:t=>v("orangtua.nama_ibu",t)}),e.jsx(j,{label:"No. Telpon Ortu",value:(ke=b.orangtua)==null?void 0:ke.telpon_ayah,onChange:t=>v("orangtua.telpon_ayah",t)})]}),ne==="kontakDarurat"&&F==="pegawai"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Nama Kontak",value:(Te=b.kontakDarurat)==null?void 0:Te.nama,onChange:t=>v("kontakDarurat.nama",t)}),e.jsx(j,{label:"Hubungan",value:(Ie=b.kontakDarurat)==null?void 0:Ie.hubungan,onChange:t=>v("kontakDarurat.hubungan",t)}),e.jsx(j,{label:"Nomor Telepon",value:(Be=b.kontakDarurat)==null?void 0:Be.telpon,onChange:t=>v("kontakDarurat.telpon",t)})]}),F==="akun"&&e.jsxs(e.Fragment,{children:[e.jsx(j,{label:"Nama Akun",value:b.nama,onChange:t=>v("nama",t)}),e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"block text-xs font-bold text-slate-500 mb-1",children:"Role"}),e.jsxs("select",{value:b.sebagai,onChange:t=>v("sebagai",t.target.value),className:"w-full px-3 py-2 bg-slate-50 rounded-lg border border-slate-200 text-sm outline-none",children:[e.jsx("option",{value:"user",children:"User / Pengunjung"}),e.jsx("option",{value:"parrent",children:"Wali Santri (WS)"}),e.jsx("option",{value:"teacher",children:"Guru (GR)"}),e.jsx("option",{value:"staff",children:"Staff (ST)"}),e.jsx("option",{value:"admin",children:"Administrator (AD)"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(j,{label:"No. Telepon",value:b.telpon,onChange:t=>v("telpon",t)}),e.jsx(j,{label:"Unique Code (NISN)",value:b.uniquecode,onChange:t=>v("uniquecode",t)})]}),e.jsx(j,{label:"Email",type:"email",value:b.email,onChange:t=>v("email",t)}),e.jsx(j,{label:"Password",value:b.password,onChange:t=>v("password",t)}),b.idAccount&&e.jsxs("div",{className:"mt-4 p-3 bg-slate-100 dark:bg-slate-800 rounded-lg",children:[e.jsx("p",{className:"text-xs text-slate-500 mb-1",children:"ID Account (Auto-generated)"}),e.jsx("p",{className:"font-mono font-bold text-sm",children:b.idAccount})]})]})]})]}),e.jsxs("div",{className:"p-6 border-t border-slate-100 dark:border-slate-800 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>q(!1),className:"px-6 py-2 text-slate-500 font-bold hover:bg-slate-100 rounded-lg transition-colors",children:"Batal"}),e.jsxs("button",{onClick:ce,disabled:W,className:"px-6 py-2 bg-emerald-600 hover:bg-emerald-700 text-white rounded-lg font-bold shadow-lg transition-transform active:scale-95 flex items-center gap-2",children:[W?e.jsx(C.Refresh,{}):e.jsx(C.Save,{})," Simpan Data"]})]})]})})]})},ba=({language:M})=>{var z;const[n,N]=r.useState("mi"),[x,P]=r.useState(null),[p,U]=r.useState(!1),[J,H]=r.useState({tetap:!1,semesteran:!1,bulanan:!1}),[Q,W]=r.useState({}),Y=[{id:"mi",label:"MI"},{id:"smpbp",label:"SMPBP"},{id:"mtsn",label:"MTSN"},{id:"smksit",label:"SMKSIT"},{id:"ma",label:"MA"}];r.useEffect(()=>{R(),W({})},[n]);const R=async()=>{U(!0);const f=await Ae(`${Ne}/api/data?type=template_biaya_${n}`);if(f){const i=Array.isArray(f)?f[0]:f;P(i||{tetap:[],semesteran:[],bulanan:[]})}else P({tetap:[],semesteran:[],bulanan:[]});U(!1)},re=f=>{H(i=>({...i,[f]:!i[f]}))},O=(f,i,D,g)=>{const v=(g[f]||[]).some((V,de)=>de!==i&&V.biaya.trim().toLowerCase()===D.trim().toLowerCase()),ce=`${f}-${i}`;W(V=>{const de={...V};return v?de[ce]="Pastikan keterangan Judul tidak sama agar mudah di identifikasi":delete de[ce],de})},q=(f,i,D)=>{P(g=>{if(!g)return g;const $=[...g[f]||[]];$[i]={...$[i],biaya:D};const v={...g,[f]:$};return O(f,i,D,v),v})},F=(f,i,D)=>{P(g=>{if(!g)return g;const $=[...g[f]||[]];return $[i]={...$[i],amount:parseInt(D)||0},{...g,[f]:$}})},oe=f=>{P(i=>{const D=i||{tetap:[],semesteran:[],bulanan:[]};return{...D,[f]:[...D[f]||[],{biaya:"",amount:0}]}}),H(i=>({...i,[f]:!0}))},b=(f,i)=>{P(D=>{if(!D)return D;const g=[...D[f]||[]];return g.splice(i,1),{...D,[f]:g}}),W(D=>{const g={};return Object.keys(D).forEach($=>{const[v,ce]=$.split("-"),V=parseInt(ce);if(v!==f){g[$]=D[$];return}V<i?g[$]=D[$]:V>i&&(g[`${v}-${V-1}`]=D[$])}),g})},me=async()=>{if(Object.keys(Q).length>0){alert("Terdapat duplikasi nama biaya. Harap perbaiki sebelum menyimpan.");return}U(!0);try{await fetch(`${Ne}/api/data?type=template_biaya_${n}`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify([x])}),alert("Data Pembiayaan Disimpan!")}catch(f){alert("Gagal menyimpan data."),console.error(f)}finally{U(!1)}},ne=(f,i)=>{const D=(x==null?void 0:x[i])||[],g=J[i];return e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800 rounded-2xl border border-slate-100 dark:border-slate-700 mb-4 overflow-hidden transition-all duration-300",children:[e.jsxs("div",{onClick:()=>re(i),className:"flex justify-between items-center p-6 cursor-pointer bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-800/50 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("span",{className:`w-8 h-8 rounded-full flex items-center justify-center text-emerald-600 bg-emerald-50 dark:bg-emerald-900/30 transition-transform duration-300 ${g?"rotate-90":""}`,children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5l7 7-7 7"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-bold text-slate-700 dark:text-slate-200 text-lg",children:f}),e.jsxs("p",{className:"text-xs text-slate-400 font-medium",children:[D.length," Item Biaya"]})]})]}),e.jsx("div",{className:"text-slate-400",children:g?"Sembunyikan":"Tampilkan"})]}),g&&e.jsxs("div",{className:"p-6 border-t border-slate-100 dark:border-slate-800 bg-slate-50 dark:bg-slate-800/50 animate-fade-in-down",children:[e.jsx("div",{className:"space-y-3",children:D.length===0?e.jsx("p",{className:"text-center text-slate-400 text-sm italic py-4",children:"Belum ada data biaya."}):D.map(($,v)=>{const ce=Q[`${i}-${v}`];return e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-4 rounded-xl border border-slate-200 dark:border-slate-700 shadow-sm flex flex-col md:flex-row items-start md:items-center gap-4 group",children:[e.jsxs("div",{className:"flex-grow w-full md:w-auto",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider mb-1 block",children:"Nama Item Biaya"}),e.jsx("input",{type:"text",value:$.biaya,onChange:V=>q(i,v,V.target.value),className:`w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border rounded-lg text-slate-700 dark:text-slate-200 font-medium text-sm focus:ring-2 outline-none ${ce?"border-red-500 focus:ring-red-200":"border-slate-200 dark:border-slate-700 focus:ring-emerald-500"}`,placeholder:"Contoh: SPP Januari"}),ce&&e.jsxs("p",{className:"text-[10px] text-red-500 font-bold mt-1 flex items-center gap-1 animate-pulse",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),ce]})]}),e.jsxs("div",{className:"w-full md:w-48",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-slate-400 tracking-wider mb-1 block",children:"Nominal (Rp)"}),e.jsx("input",{type:"number",value:$.amount,onChange:V=>F(i,v,V.target.value),className:"w-full px-3 py-2 bg-slate-50 dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-lg text-emerald-600 font-mono font-bold text-sm focus:ring-2 focus:ring-emerald-500 outline-none",placeholder:"0"})]}),e.jsx("button",{type:"button",onClick:()=>b(i,v),className:"p-2 md:mt-5 text-slate-300 hover:text-red-500 hover:bg-red-50 rounded-lg transition-all",title:"Hapus Item",children:e.jsx(C.Trash,{})})]},`${i}-${v}`)})}),e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsxs("button",{onClick:()=>oe(i),className:"flex items-center gap-2 px-4 py-2 bg-emerald-50 dark:bg-emerald-900/20 text-emerald-700 dark:text-emerald-400 text-xs font-bold rounded-lg hover:bg-emerald-100 transition-colors",children:[e.jsx(C.Plus,{})," Tambah Item Baru"]})})]})]})};return e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 p-6 min-h-[600px]",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 border-b border-slate-100 dark:border-slate-800 pb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Manajemen Pembiayaan"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Atur template biaya untuk setiap unit pendidikan."})]}),e.jsx("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-xl overflow-x-auto max-w-full",children:Y.map(f=>e.jsx("button",{onClick:()=>N(f.id),className:`px-5 py-2 rounded-lg text-sm font-bold transition-all whitespace-nowrap ${n===f.id?"bg-white dark:bg-slate-700 text-emerald-600 shadow-sm":"text-slate-500 hover:text-slate-700 dark:text-slate-400"}`,children:f.label},f.id))})]}),p?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsxs("div",{className:"flex flex-col items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 border-4 border-emerald-100 border-t-emerald-600 rounded-full animate-spin"}),e.jsx("span",{className:"text-slate-400 text-sm font-bold animate-pulse",children:"Memuat Data..."})]})}):e.jsxs("div",{className:"animate-fade-in-up pb-20",children:[ne("Biaya Tetap (Awal Masuk)","tetap"),ne("Biaya Semesteran","semesteran"),ne("Biaya Bulanan (SPP)","bulanan"),e.jsx("div",{className:"sticky bottom-0 bg-white/80 dark:bg-slate-900/80 backdrop-blur-md p-4 border-t border-slate-100 dark:border-slate-800 flex justify-end -mx-6 -mb-6 rounded-b-3xl z-10",children:e.jsxs("button",{onClick:me,disabled:p,className:"bg-emerald-600 hover:bg-emerald-700 text-white px-8 py-3 rounded-xl font-bold shadow-lg shadow-emerald-200 dark:shadow-none transition-transform active:scale-95 flex items-center gap-2",children:[e.jsx(C.Save,{})," Simpan Perubahan ",(z=Y.find(f=>f.id===n))==null?void 0:z.label]})})]})]})},pa=({user:M,language:n,onLogout:N,activeTab:x="overview",setAdminTab:P,setHideNav:p})=>{const[U,J]=r.useState({transactions:0,students:0,teachers:0,accounts:0}),[H,Q]=r.useState(!1);r.useEffect(()=>{x==="overview"&&W()},[x]);const W=async()=>{Q(!0);try{const[R,re,O,q]=await Promise.all([Ae(`${Ne}/api/data?type=all_transactions`),Ae(`${Ne}/api/data?type=siswa`),Ae(`${Ne}/api/data?type=pegawai`),Ae(`${Ne}/api/accounts`)]);let F=0;R&&Array.isArray(R)&&(F=R.length),J({transactions:F,students:Array.isArray(re)?re.length:0,teachers:Array.isArray(O)?O.length:0,accounts:Array.isArray(q)?q.length:0})}catch(R){console.error("Failed to fetch stats",R)}finally{Q(!1)}},Y=R=>{P&&(P(R),window.scrollTo(0,0))};return e.jsx("div",{className:"bg-transparent min-h-screen pt-24 pb-20 px-4",dir:n==="ar"?"rtl":"ltr",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[x==="overview"&&e.jsxs("div",{className:"animate-fade-in-up",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Ringkasan Dashboard"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Selamat datang kembali, Administrator."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 md:gap-6 mb-8",children:[e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-3 md:p-6 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 flex flex-col md:flex-row items-center gap-2 md:gap-4 text-center md:text-left",children:[e.jsx("div",{className:"p-3 md:p-4 bg-emerald-100 dark:bg-emerald-900/30 text-emerald-600 rounded-2xl flex-shrink-0",children:e.jsx(C.Money,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] md:text-xs font-bold text-slate-500 uppercase tracking-wider mb-0.5 md:mb-1",children:"Transaksi Aktif"}),e.jsx("h3",{className:"text-xl md:text-3xl font-bold text-slate-800 dark:text-slate-100",children:H?"...":U.transactions})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-3 md:p-6 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 flex flex-col md:flex-row items-center gap-2 md:gap-4 text-center md:text-left",children:[e.jsx("div",{className:"p-3 md:p-4 bg-amber-100 dark:bg-amber-900/30 text-amber-600 rounded-2xl flex-shrink-0",children:e.jsx(C.Key,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] md:text-xs font-bold text-slate-500 uppercase tracking-wider mb-0.5 md:mb-1",children:"Total Akun"}),e.jsx("h3",{className:"text-xl md:text-3xl font-bold text-slate-800 dark:text-slate-100",children:H?"...":U.accounts})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-3 md:p-6 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 flex flex-col md:flex-row items-center gap-2 md:gap-4 text-center md:text-left",children:[e.jsx("div",{className:"p-3 md:p-4 bg-blue-100 dark:bg-blue-900/30 text-blue-600 rounded-2xl flex-shrink-0",children:e.jsx(C.User,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] md:text-xs font-bold text-slate-500 uppercase tracking-wider mb-0.5 md:mb-1",children:"Total Siswa"}),e.jsx("h3",{className:"text-xl md:text-3xl font-bold text-slate-800 dark:text-slate-100",children:H?"...":U.students})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 p-3 md:p-6 rounded-3xl shadow-sm border border-slate-100 dark:border-slate-800 flex flex-col md:flex-row items-center gap-2 md:gap-4 text-center md:text-left",children:[e.jsx("div",{className:"p-3 md:p-4 bg-purple-100 dark:bg-purple-900/30 text-purple-600 rounded-2xl flex-shrink-0",children:e.jsx(C.Briefcase,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-[10px] md:text-xs font-bold text-slate-500 uppercase tracking-wider mb-0.5 md:mb-1",children:"Total Pegawai"}),e.jsx("h3",{className:"text-xl md:text-3xl font-bold text-slate-800 dark:text-slate-100",children:H?"...":U.teachers})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-emerald-600 to-teal-700 rounded-3xl p-8 text-white shadow-lg relative overflow-hidden flex flex-col justify-between group h-full",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-10 group-hover:opacity-20 transition-opacity",children:e.jsx("div",{className:"scale-150 transform",children:e.jsx(C.Database,{})})}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("div",{className:"w-12 h-12 bg-white/20 backdrop-blur-md rounded-2xl flex items-center justify-center mb-6",children:e.jsx(C.Database,{})}),e.jsx("h3",{className:"text-2xl font-bold mb-2",children:"Pusat Data"}),e.jsx("p",{className:"text-emerald-100 mb-6 text-sm max-w-xs",children:"Kelola data siswa, pegawai, dan akun pengguna secara terpusat dan aman."})]}),e.jsx("button",{onClick:()=>Y("database"),className:"w-full bg-white text-emerald-700 px-6 py-3 rounded-xl font-bold text-sm shadow-md hover:bg-emerald-50 transition-colors flex items-center justify-center gap-2",children:"Kelola Database"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl p-8 border border-slate-100 dark:border-slate-800 shadow-sm relative overflow-hidden flex flex-col justify-between group h-full hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5",children:e.jsx("div",{className:"scale-150 transform",children:e.jsx(C.Money,{})})}),e.jsxs("div",{children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-900/30 text-blue-600 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(C.Money,{})}),e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 mb-2",children:"Riwayat Transaksi"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-6 text-sm",children:"Verifikasi pembayaran masuk dan pantau arus kas keuangan sekolah."})]}),e.jsx("button",{onClick:()=>Y("finance"),className:"w-full bg-slate-50 dark:bg-slate-800 text-slate-700 dark:text-slate-200 px-6 py-3 rounded-xl font-bold text-sm border border-slate-200 dark:border-slate-700 hover:bg-blue-50 dark:hover:bg-slate-700 hover:text-blue-600 hover:border-blue-200 transition-all flex items-center justify-center gap-2",children:"Buka Keuangan"})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl p-8 border border-slate-100 dark:border-slate-800 shadow-sm relative overflow-hidden flex flex-col justify-between group h-full hover:shadow-md transition-shadow",children:[e.jsxs("div",{children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 dark:bg-purple-900/30 text-purple-600 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(C.Home,{})}),e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 mb-2",children:"Atur Tampilan"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-6 text-sm",children:"Sesuaikan konten beranda utama dan informasi setiap unit pendidikan."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsx("button",{onClick:()=>Y("content"),className:"bg-purple-50 dark:bg-slate-800 text-purple-700 dark:text-purple-400 px-4 py-3 rounded-xl font-bold text-xs md:text-sm border border-purple-100 dark:border-slate-700 hover:bg-purple-100 dark:hover:bg-slate-700 transition-colors",children:"Kelola Beranda"}),e.jsx("button",{onClick:()=>Y("unit"),className:"bg-slate-50 dark:bg-slate-800 text-slate-600 dark:text-slate-300 px-4 py-3 rounded-xl font-bold text-xs md:text-sm border border-slate-200 dark:border-slate-700 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors",children:"Kelola Unit"})]})]}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl p-8 border border-slate-100 dark:border-slate-800 shadow-sm relative overflow-hidden flex flex-col justify-between group h-full hover:shadow-md transition-shadow",children:[e.jsx("div",{className:"absolute top-0 right-0 p-8 opacity-5",children:e.jsx("div",{className:"scale-150 transform",children:e.jsx(C.Building,{})})}),e.jsxs("div",{children:[e.jsx("div",{className:"w-12 h-12 bg-amber-100 dark:bg-amber-900/30 text-amber-600 rounded-2xl flex items-center justify-center mb-6",children:e.jsx(C.Building,{})}),e.jsx("h3",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 mb-2",children:"Manajemen Biaya"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 mb-6 text-sm",children:"Atur komponen biaya pendidikan dan template tagihan siswa."})]}),e.jsx("button",{onClick:()=>Y("fees"),className:"w-full bg-slate-50 dark:bg-slate-800 text-slate-700 dark:text-slate-200 px-6 py-3 rounded-xl font-bold text-sm border border-slate-200 dark:border-slate-700 hover:bg-amber-50 dark:hover:bg-slate-700 hover:text-amber-600 hover:border-amber-200 transition-all flex items-center justify-center gap-2",children:"Kelola Biaya"})]})]})]}),x==="content"&&e.jsx(ma,{language:n}),x==="finance"&&e.jsx(xa,{language:n,setHideNav:p}),x==="unit"&&e.jsx(ua,{language:n}),x==="database"&&e.jsx(ha,{language:n,setHideNav:p}),x==="fees"&&e.jsx(ba,{language:n})]})})},Ye={Folder:()=>e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M5 19a2 2 0 01-2-2V7a2 2 0 012-2h4l2 2h4a2 2 0 012 2v1M5 19h14a2 2 0 002-2v-5a2 2 0 00-2-2H9a2 2 0 00-2 2v5a2 2 0 01-2 2z"})}),External:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})}),User:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})})},ga=({user:M,language:n,onLogout:N})=>e.jsx("div",{className:"bg-transparent min-h-screen pt-24 pb-20 px-4",dir:n==="ar"?"rtl":"ltr",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-8 gap-4 animate-fade-in-down",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Dashboard Pegawai"}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsxs("span",{className:"px-3 py-1 bg-blue-100 dark:bg-blue-900/30 text-blue-700 dark:text-blue-300 rounded-full text-xs font-bold uppercase tracking-wider border border-blue-200 dark:border-blue-800 flex items-center gap-1",children:[e.jsx(Ye.User,{}),M.role==="teacher"?"Guru / Pengajar":"Staff / Karyawan"]}),e.jsx("span",{className:"text-slate-400 dark:text-slate-600 text-xs",children:"•"}),e.jsxs("p",{className:"text-slate-500 dark:text-slate-400 text-sm font-medium",children:["Selamat bertugas, ",M.name]})]})]}),e.jsx("button",{onClick:N,className:"px-6 py-2.5 bg-white dark:bg-slate-800 hover:bg-red-50 dark:hover:bg-red-900/20 text-slate-600 dark:text-slate-300 hover:text-red-600 dark:hover:text-red-400 border border-slate-200 dark:border-slate-700 rounded-full font-bold text-sm transition-all shadow-sm flex items-center gap-2",children:e.jsx("span",{children:qe[n].nav.logout})})]}),e.jsx(la,{user:M,language:n}),e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-3xl shadow-lg border border-slate-100 dark:border-slate-800 overflow-hidden mt-8 animate-fade-in-up",children:[e.jsxs("div",{className:"p-6 border-b border-slate-100 dark:border-slate-800 flex flex-col md:flex-row justify-between items-start md:items-center gap-4 bg-slate-50/50 dark:bg-slate-800/30 backdrop-blur-sm",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"p-3 bg-white dark:bg-slate-800 rounded-2xl shadow-sm border border-slate-100 dark:border-slate-700 text-emerald-600",children:e.jsx(Ye.Folder,{})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Arsip Dokumen Digital"}),e.jsx("p",{className:"text-slate-500 dark:text-slate-400 text-sm",children:"Akses materi ajar, silabus, RPP, dan dokumen administrasi yayasan."})]})]}),e.jsxs("a",{href:"https://drive.google.com/drive/u/0/folders/1Cf6a2BiyFv9ycL_0xuxVFL--aH9UPa46",target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 px-5 py-2.5 bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-xl text-xs font-bold hover:bg-slate-50 dark:hover:bg-slate-700 text-slate-700 dark:text-slate-200 transition-all shadow-sm hover:shadow-md",children:["Buka Fullscreen ",e.jsx(Ye.External,{})]})]}),e.jsx("div",{className:"w-full relative bg-slate-100 dark:bg-slate-950 p-1",children:e.jsx("iframe",{src:"https://drive.google.com/embeddedfolderview?id=1Cf6a2BiyFv9ycL_0xuxVFL--aH9UPa46#grid",className:"w-full h-[600px] border-0 rounded-b-2xl bg-white shadow-inner",title:"Google Drive Folder",loading:"lazy",allowFullScreen:!0})})]})]})}),ze="https://api-sekolah-minnatulhuda.halo-minnatulhuda.workers.dev",Ze="service_yer158u",Xe="template_bq5blic",ea="mNgGPZEPoYywu9liZ",Ge="minnatul_history",aa="halo.minnatulhuda@gmail.com",ta={loginBackground:"https://images.pexels.com/photos/159752/pencil-office-design-creative-159752.jpeg",logo:"https://imgur.com/4hdcTD7.png"},sa=[{u:"minnatulhuda@admin",p:"admin",n:"Super Administrator",id:"MHAC-AD-SUPER-001"},{u:"@admin",p:"admin",n:"General Administrator",id:"MHAC-AD-GEN-002"},{u:"@miadmin",p:"miadmin",n:"Admin MI",id:"MHAC-AD-MI-003"},{u:"@mtsnadmin",p:"mtsnadmin",n:"Admin MTsN",id:"MHAC-AD-MTS-004"},{u:"@smksitadmin",p:"smksitadmin",n:"Admin SMKS IT",id:"MHAC-AD-SMK-005"},{u:"@maadmin",p:"maadmin",n:"Admin MA",id:"MHAC-AD-MA-006"},{u:"@keuangan",p:"keuangan",n:"Keuangan",id:"MHAC-AD-FIN-007"},{u:"@sekretaris",p:"sekretaris",n:"Sekretaris",id:"MHAC-AD-SEC-008"},{u:"@bendahara",p:"bendahara",n:"Bendahara",id:"MHAC-AD-TRE-009"}],pe={user:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"})}),lock:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 15v2m-6 4h12a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})}),key:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 7a2 2 0 012 2m4 0a6 6 0 01-7.743 5.743L11 17H9v2H7v2H4a1 1 0 01-1-1v-2.586a1 1 0 01.293-.707l5.964-5.964A6 6 0 1121 9z"})}),checkSmall:()=>e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"3",d:"M5 13l4 4L19 7"})}),spin:()=>e.jsxs("svg",{className:"animate-spin w-5 h-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),checkCircle:()=>e.jsx("svg",{className:"w-4 h-4 text-emerald-500",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),eye:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"})}),eyeOff:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.88 9.88l-3.29-3.29m7.532 7.532l3.29 3.29M3 3l3.59 3.59m0 0A9.953 9.953 0 0112 5c4.478 0 8.268 2.943 9.543 7a10.025 10.025 0 01-4.132 5.411m0 0L21 21"})}),trash:()=>e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),plus:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 4v16m8-8H4"})}),arrowLeft:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),rocket:()=>e.jsx("svg",{className:"w-12 h-12 text-emerald-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 10V3L4 14h7v7l9-11h-7z"})}),school:()=>e.jsx("svg",{className:"w-6 h-6 text-emerald-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"})}),bill:()=>e.jsx("svg",{className:"w-6 h-6 text-amber-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"})}),info:()=>e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})},va=({language:M="id",user:n,setUser:N,onLogout:x,adminTab:P="finance",setAdminTab:p,setHideNav:U})=>{const[J,H]=r.useState(!0),[Q,W]=r.useState(!1),[Y,R]=r.useState(!0),[re,O]=r.useState([]),[q,F]=r.useState(!1),[oe,b]=r.useState(!1),[me,ne]=r.useState(null),[z,f]=r.useState(""),i=qe[M].auth,D=[{id:"user",label:i.role_visitor,code:"PG",uniqueField:null,disabled:!1},{id:"parrent",label:i.role_parent,code:"WS",uniqueField:"NISN",disabled:!1},{id:"employee",label:"Pegawai (Guru/Staff)",code:"PGW",uniqueField:"NIP",disabled:!1}],[g,$]=r.useState({role:"user",uniquecode:"",nama:"",telpon:"",email:"",otpInput:"",password:"",confirmPassword:""}),[v,ce]=r.useState({emailOrPhone:"",password:""}),[V,de]=r.useState(""),[u,ae]=r.useState(!1),[X,xe]=r.useState(!1),[we,k]=r.useState(null),[A,K]=r.useState(0),[te,he]=r.useState(!1),[se,le]=r.useState(!1),[be,E]=r.useState(""),[l,d]=r.useState(!1),[o,L]=r.useState(!1),[B,G]=r.useState({hasUpper:!1,hasLower:!1,hasNumber:!1,hasSpecial:!1,hasMinLength:!1}),[fe,ue]=r.useState(!0),[ke,Te]=r.useState("");r.useEffect(()=>{const c=localStorage.getItem(Ge);if(c)try{const S=JSON.parse(c);Array.isArray(S)&&S.length>0?(O(S),R(!0)):R(!1)}catch{O([]),R(!1)}else R(!1)},[]);const Ie=c=>{let S=[...re];S=S.filter(I=>I.id!==c.id);const Z={...c,lastLogin:new Date().toISOString()};S.unshift(Z),S.length>5&&S.pop(),O(S),localStorage.setItem(Ge,JSON.stringify(S))},Be=(c,S)=>{S.stopPropagation();const Z=re.filter(I=>I.id!==c);O(Z),localStorage.setItem(Ge,JSON.stringify(Z)),Z.length===0&&R(!1)},t=async c=>{le(!0),E("");try{const{ok:S,data:Z}=await Pe(ze+"/api/accounts",{method:"GET",mode:"cors",headers:{Accept:"application/json"}});if(!S)throw new Error("Gagal terhubung ke server.");if(Z.find(ye=>ye.idAccount===c.id&&ye.password===c.password))Ie(c),N(c),localStorage.setItem("user",JSON.stringify(c));else if(sa.find(Se=>Se.id===c.id&&Se.p===c.password))Ie(c),N(c),localStorage.setItem("user",JSON.stringify(c));else{E("Sesi telah kadaluarsa atau password berubah. Silakan login ulang.");const Se=re.filter(Ee=>Ee.id!==c.id);O(Se),localStorage.setItem(Ge,JSON.stringify(Se)),Se.length===0&&R(!1)}}catch(S){console.error("Auto login error",S),sa.find(I=>I.id===c.id&&I.p===c.password)?(Ie(c),N(c),localStorage.setItem("user",JSON.stringify(c))):E("Gagal login otomatis: "+S.message)}finally{le(!1)}},w=D.find(c=>c.id===g.role)||D[0];r.useEffect(()=>{let c;return A>0?c=setInterval(()=>K(S=>S-1),1e3):A===0&&(u&&!X&&!oe?(ae(!1),k(null),E("Waktu OTP habis. Silakan kirim ulang.")):oe&&E("Kode OTP kadaluarsa. Silakan login ulang.")),()=>clearInterval(c)},[A,u,X,oe]),r.useEffect(()=>{const c=g.password;G({hasUpper:/[A-Z]/.test(c),hasLower:/[a-z]/.test(c),hasNumber:/[0-9]/.test(c),hasSpecial:/[^A-Za-z0-9]/.test(c),hasMinLength:c.length>=8})},[g.password]);const ee=Object.values(B).every(Boolean),a=c=>{const{name:S,value:Z}=c.target;if(S==="telpon"){let I=Z.replace(/\D/g,"");I.startsWith("0")&&(I=I.substring(1)),$(ye=>({...ye,[S]:I})),I.length>0?I.startsWith("8")?I.length<9?(ue(!1),Te(i.validation.phone_length)):(ue(!0),Te("")):(ue(!1),Te(i.validation.phone_start)):(ue(!0),Te(""))}else $(I=>({...I,[S]:Z}));E("")},m=c=>{ce(S=>({...S,[c.target.name]:c.target.value}))},y=async()=>{if(!g.email||!g.nama){E(i.validation.error_incomplete);return}le(!0),E("");const c=Math.floor(1e5+Math.random()*9e5).toString();k(c);const S={title:"Verifikasi Akun",message:"Terima kasih telah mendaftar. Gunakan kode berikut untuk memverifikasi akun Anda:",otp:c,to_email:g.email,email:g.email,nama:g.nama,footer_note:"Kode ini bersifat rahasia dan berlaku selama 100 detik."};try{await Ve.send(Ze,Xe,S,ea),ae(!0),K(100),alert(`OTP terkirim ke ${g.email}.`)}catch(Z){console.error("EmailJS Error:",Z),E("Gagal mengirim OTP. Periksa koneksi/email.")}finally{le(!1)}},_=async c=>{le(!0),E("");const S=Math.floor(1e5+Math.random()*9e5).toString();k(S);const Z={title:"Verifikasi Login Administrator",message:`Seseorang mencoba login sebagai ${c.n} (${c.u}). Gunakan kode OTP Admin berikut:`,otp:S,to_email:aa,email:aa,nama:"Super Admin",footer_note:"Kode ini berlaku selama 60 detik."};try{await Ve.send(Ze,Xe,Z,ea),b(!0),K(60),alert("OTP Admin terkirim ke email pusat.")}catch(I){console.error("Admin EmailJS Error:",I),E("Gagal mengirim OTP Admin. Cek koneksi.")}finally{le(!1)}},ge=()=>{if(z===we){if(A===0){E("Kode OTP sudah kadaluarsa.");return}const c={name:me.n,email:me.u,telpon:"-",role:"admin",id:me.id,createdAt:new Date().toISOString(),password:me.p};Ie(c),N(c),localStorage.setItem("user",JSON.stringify(c)),b(!1),ne(null),f("")}else E("Kode OTP Salah!")},Ce=async c=>{if(c.preventDefault(),!V){E("Mohon isi email anda.");return}le(!0),E("");try{const{ok:S,data:Z}=await Pe(ze+"/api/accounts",{method:"GET",mode:"cors",headers:{Accept:"application/json"}});if(!S)throw new Error("Gagal terhubung ke server.");const I=Z.find(ye=>ye.email&&ye.email.toLowerCase()===V.toLowerCase());if(I){const ye={title:"Pemulihan Kata Sandi",message:"Berikut adalah kata sandi untuk akun Anda:",otp:I.password,to_email:I.email,nama:I.nama,email:I.email,footer_note:"Jaga kerahasiaan kata sandi Anda. Jangan berikan kepada siapapun."};await Ve.send(Ze,Xe,ye,ea),alert(`Kata sandi telah dikirim ke email ${V}. Silakan cek inbox/spam.`),W(!1),de("")}else E("Email tidak ditemukan dalam database.")}catch(S){console.error("Forgot Password Error:",S),E("Gagal memproses permintaan. "+S.message)}finally{le(!1)}},De=()=>{g.otpInput===we?(xe(!0),K(0)):E("Kode OTP salah!")};r.useEffect(()=>{u&&!X&&g.otpInput.length===6&&De()},[g.otpInput]),r.useEffect(()=>{oe&&z.length===6&&ge()},[z]);const Pe=async(c,S)=>{const Z=await fetch(c,S),I=await Z.text();try{return{ok:Z.ok,status:Z.status,data:JSON.parse(I)}}catch{throw new Error("Server Error: Respon tidak valid (Bukan JSON).")}},Fe=async c=>{if(c.preventDefault(),E(""),!fe||g.telpon.length<9)return E(ke||i.validation.phone_length);if(!ee)return E("Password belum memenuhi kriteria.");if(!X)return E(i.validation.error_otp);if(g.password!==g.confirmPassword)return E(i.validation.error_match);if(!te)return E("Anda harus menyetujui Syarat & Ketentuan.");const S=["parrent","teacher","staff","employee"].includes(g.role);if(S&&!g.uniquecode)return E(`${w.uniqueField||"Kode Unik"} wajib diisi.`);le(!0);try{const Z="+62"+g.telpon,I={sebagai:g.role,nama:g.nama,telpon:Z,email:g.email,password:g.password,uniquecode:S?g.uniquecode.trim():""},{ok:ye,data:Se}=await Pe(ze+"/api/register",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(I)});if(Se.error)throw new Error(Se.details||Se.error);if(!ye)throw new Error("Gagal menyimpan data.");F(!0)}catch(Z){let I=Z.message;I==="Failed to fetch"&&(I="Gagal terhubung ke Server."),E(I)}finally{le(!1)}},Ke=async c=>{c.preventDefault(),le(!0),E("");const S=sa.find(Z=>Z.u===v.emailOrPhone&&Z.p===v.password);if(S){ne(S),await _(S);return}try{const{ok:Z,data:I}=await Pe(ze+"/api/accounts",{method:"GET",mode:"cors",headers:{Accept:"application/json"}});if(!Z)throw new Error(I.details||I.error||"Koneksi Gagal.");const ye=v.emailOrPhone,Se=v.password;let Ee=ye.replace(/\D/g,"");Ee.startsWith("0")?Ee="62"+Ee.substring(1):Ee.startsWith("8")&&(Ee="62"+Ee);const s="+"+Ee,h=I.find(T=>{const je=T.email&&T.email.toLowerCase()===ye.toLowerCase(),ve=T.telpon===s;return(je||ve)&&T.password===Se});if(h){const T=h.idAccount?h.idAccount.split("-"):[],je=T.length>1?T[1]:"PG";let ve="student";je==="WS"?ve="student":je==="GR"?ve="teacher":je==="ST"?ve="internal":je==="AD"?ve="admin":h.sebagai==="staff"?ve="internal":h.sebagai==="teacher"?ve="teacher":ve="student";const Me={name:h.nama,email:h.email,telpon:h.telpon,role:ve,originalRole:h.sebagai,id:h.idAccount,uniquecode:h.uniquecode||"",password:h.password,createdAt:h.createdAt||new Date().toISOString()};Ie(Me),N(Me),localStorage.setItem("user",JSON.stringify(Me))}else throw new Error("Email/No.HP atau password salah.")}catch(Z){let I=Z.message;I==="Failed to fetch"&&(I="Gagal terhubung ke Server."),E(I)}finally{le(!1)}};if(n)return n.role==="admin"||n.role==="administrator"?e.jsx(pa,{user:n,language:M,onLogout:x,activeTab:P,setAdminTab:p,setHideNav:U}):["internal","staff","teacher","employee","guru","pengajar"].includes(n.role)?e.jsx(ga,{user:n,language:M,onLogout:x}):e.jsx(ca,{user:n,language:M,onLogout:x,setHideNav:U});const Re=c=>c?c.split(" ").slice(0,2).map(S=>S[0]).join("").toUpperCase():"??";return e.jsx("div",{className:"bg-transparent min-h-screen pt-24 pb-20 md:py-24 px-4 flex items-center justify-center",dir:M==="ar"?"rtl":"ltr",children:e.jsxs("div",{className:"bg-white/80 dark:bg-slate-900/80 backdrop-blur-md rounded-3xl shadow-2xl overflow-hidden w-full max-w-5xl flex flex-col md:flex-row md:min-h-[600px] border border-gray-100 dark:border-slate-800 animate-fade-in-up",children:[e.jsxs("div",{className:"w-full md:w-5/12 bg-emerald-800 relative hidden md:flex flex-col justify-center items-center p-12 text-center text-white overflow-hidden",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center opacity-20",style:{backgroundImage:`url('${ta.loginBackground}')`}}),e.jsxs("div",{className:"relative z-10",children:[e.jsx("img",{src:ta.logo,alt:"Logo",className:"w-24 h-24 mx-auto mb-6 drop-shadow-lg"}),e.jsx("h2",{className:"text-3xl font-bold font-lora mb-4",children:Q?"Pemulihan Akun":J?Y&&re.length>0?"Selamat Datang Kembali":i.login_title:i.register_title}),e.jsx("p",{className:"text-emerald-100 text-lg leading-relaxed",children:Q?"Jangan khawatir, kami akan membantu Anda mendapatkan kembali akses ke akun Anda.":J?i.login_desc:i.register_desc})]})]}),e.jsxs("div",{className:"w-full md:w-7/12 p-6 md:p-10 flex flex-col justify-center relative",children:[e.jsxs("div",{className:"md:hidden text-center mb-6",children:[e.jsx("img",{src:ta.logo,alt:"Logo",className:"w-16 h-16 mx-auto mb-3"}),e.jsx("h2",{className:"text-2xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:Q?"Pemulihan Akun":J?Y&&re.length>0?"Pilih Akun":i.login_title:i.register_title})]}),Q?e.jsxs("div",{className:"animate-fade-in-fast max-w-sm mx-auto w-full",children:[e.jsxs("button",{onClick:()=>{W(!1),E("")},className:"flex items-center text-slate-500 hover:text-emerald-600 font-bold text-sm mb-6 transition-colors",children:[e.jsx(pe.arrowLeft,{})," ",e.jsx("span",{className:"ml-2",children:"Kembali ke Login"})]}),e.jsxs("div",{className:"mb-6 p-4 bg-blue-50 dark:bg-blue-900/20 rounded-xl border border-blue-100 dark:border-blue-800 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 dark:bg-blue-800 rounded-full flex items-center justify-center mx-auto mb-3 text-blue-600 dark:text-blue-300",children:e.jsx(pe.key,{})}),e.jsx("h4",{className:"font-bold text-blue-700 dark:text-blue-300 text-sm",children:"Lupa Kata Sandi?"}),e.jsx("p",{className:"text-xs text-blue-600 dark:text-blue-400 mt-1",children:"Masukkan email yang terdaftar. Kami akan mengirimkan kata sandi Anda melalui email tersebut."})]}),e.jsxs("form",{onSubmit:Ce,className:"space-y-5",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"email",id:"forgotEmail",name:"forgotEmail",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:V,onChange:c=>de(c.target.value),required:!0}),e.jsx("label",{htmlFor:"forgotEmail",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:"Email Terdaftar"})]}),be&&e.jsx("div",{className:"p-3 bg-red-50 text-red-600 text-xs rounded-lg text-center font-bold",children:be}),e.jsx("button",{type:"submit",disabled:se,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3.5 rounded-xl shadow-lg transition-transform active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed flex justify-center items-center",children:se?e.jsx(pe.spin,{}):"Kirim Kata Sandi"})]})]}):e.jsx(e.Fragment,{children:q?e.jsxs("div",{className:"animate-fade-in-fast max-w-sm mx-auto w-full text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-emerald-100 rounded-full flex items-center justify-center mx-auto mb-6",children:e.jsx(pe.rocket,{})}),e.jsx("h3",{className:"text-2xl font-bold text-emerald-800 dark:text-emerald-400 mb-2 font-lora",children:i.reg_success_title}),e.jsx("p",{className:"text-slate-600 dark:text-slate-300 text-sm mb-8 leading-relaxed",children:i.reg_success_desc}),e.jsx("div",{className:"text-left space-y-4 mb-8",children:g.role==="employee"?e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-slate-50 dark:bg-slate-800 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-8 h-8 bg-purple-100 text-purple-600 rounded-full flex items-center justify-center shrink-0",children:e.jsx(pe.user,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:"Akun Pegawai"}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400",children:"Verifikasi NIP & Email berhasil. Silakan login untuk akses dashboard internal."})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-slate-50 dark:bg-slate-800 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-8 h-8 bg-emerald-100 text-emerald-600 rounded-full flex items-center justify-center shrink-0",children:e.jsx(pe.school,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:"Identifikasi Unit"}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400",children:"Sistem mendeteksi unit sekolah siswa berdasarkan NISN."})]})]}),e.jsxs("div",{className:"flex items-start gap-3 p-3 bg-slate-50 dark:bg-slate-800 rounded-xl border border-slate-100 dark:border-slate-700",children:[e.jsx("div",{className:"w-8 h-8 bg-amber-100 text-amber-600 rounded-full flex items-center justify-center shrink-0",children:e.jsx(pe.bill,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-slate-700 dark:text-slate-200",children:"Generate Tagihan"}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400",children:"Tagihan biaya (Tetap/Semester/Bulanan) otomatis dibuat."})]})]})]})}),e.jsx("button",{onClick:()=>{F(!1),H(!0)},className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3.5 rounded-xl shadow-lg transition-transform active:scale-95",children:i.btn_goto_login})]}):e.jsx(e.Fragment,{children:J&&Y&&re.length>0?e.jsxs("div",{className:"animate-fade-in-fast w-full max-w-sm mx-auto",children:[e.jsx("p",{className:"text-center text-slate-500 mb-6 text-sm",children:"Klik salah satu akun untuk login otomatis"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-6",children:[re.map(c=>e.jsxs("div",{onClick:()=>t(c),className:"bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 rounded-2xl p-4 flex flex-col items-center justify-center relative group cursor-pointer hover:shadow-lg hover:border-emerald-200 hover:bg-emerald-50/20 transition-all duration-300",children:[e.jsx("button",{onClick:S=>Be(c.id,S),className:"absolute top-2 right-2 text-slate-300 hover:text-red-500 transition-colors p-1",title:"Hapus akun ini",children:e.jsx(pe.trash,{})}),e.jsx("div",{className:"w-16 h-16 rounded-full bg-emerald-100 dark:bg-emerald-900/30 text-emerald-700 dark:text-emerald-400 flex items-center justify-center text-xl font-bold mb-3 overflow-hidden border-2 border-white dark:border-slate-700 shadow-sm group-hover:scale-110 transition-transform",children:Re(c.name)}),e.jsx("h4",{className:"font-bold text-slate-800 dark:text-slate-100 text-sm text-center line-clamp-1",children:c.name}),e.jsx("span",{className:"text-[10px] uppercase font-bold text-emerald-600 bg-emerald-50 px-2 py-0.5 rounded mt-1",children:c.role==="student"?"Wali Santri":c.role})]},c.id)),e.jsxs("button",{onClick:()=>R(!1),className:"bg-slate-50 dark:bg-slate-800/50 border-2 border-dashed border-slate-200 dark:border-slate-700 rounded-2xl p-4 flex flex-col items-center justify-center text-slate-400 hover:text-emerald-600 hover:border-emerald-300 hover:bg-emerald-50/10 transition-all duration-300",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center mb-2",children:e.jsx(pe.plus,{})}),e.jsx("span",{className:"text-xs font-bold",children:"Masuk Akun Lain"})]})]}),se&&e.jsx("div",{className:"text-center mb-4",children:e.jsxs("span",{className:"inline-flex items-center text-emerald-600 font-bold text-sm animate-pulse",children:[e.jsx(pe.spin,{}),e.jsx("span",{className:"ml-2",children:"Memverifikasi Akun..."})]})}),be&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 text-red-600 text-xs rounded-lg text-center font-bold",children:be}),e.jsx("div",{className:"text-center",children:e.jsx("button",{onClick:()=>R(!1),className:"text-sm text-slate-500 hover:text-emerald-600 font-bold underline",children:"Gunakan Akun Lain"})})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex bg-slate-100 dark:bg-slate-800 p-1 rounded-xl mb-6 self-center w-full max-w-xs",children:[e.jsx("button",{onClick:()=>H(!0),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all duration-300 ${J?"bg-white dark:bg-slate-700 text-emerald-600 shadow-sm":"text-slate-500 dark:text-slate-400"}`,children:i.btn_login}),e.jsx("button",{onClick:()=>H(!1),className:`flex-1 py-2 rounded-lg text-sm font-bold transition-all duration-300 ${J?"text-slate-500 dark:text-slate-400":"bg-white dark:bg-slate-700 text-emerald-600 shadow-sm"}`,children:i.btn_register})]}),be&&e.jsx("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400 text-sm rounded-lg border border-red-200 dark:border-red-800 text-center animate-fade-in-fast flex flex-col items-center",children:e.jsx("span",{className:"text-xs font-bold",children:be})}),oe?e.jsxs("div",{className:"animate-fade-in-fast space-y-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-amber-100 text-amber-600 rounded-full flex items-center justify-center mx-auto mb-2",children:e.jsx(pe.lock,{})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-slate-800 dark:text-slate-100 font-lora",children:"Verifikasi Administrator"}),e.jsxs("p",{className:"text-xs text-slate-500 mt-2 max-w-xs mx-auto leading-relaxed",children:["Kode OTP telah dikirim ke email pusat ",e.jsx("strong",{children:aa}),"."]})]}),e.jsxs("div",{className:"space-y-4 max-w-xs mx-auto",children:[e.jsx("input",{type:"text",value:z,onChange:c=>f(c.target.value),placeholder:"- - - - - -",className:"w-full text-center tracking-[1em] font-mono text-2xl py-3 border-b-2 border-emerald-500 outline-none bg-transparent focus:border-emerald-700 transition-colors",maxLength:6,autoFocus:!0}),e.jsxs("div",{className:"flex justify-between items-center text-xs px-2",children:[e.jsx("span",{className:A>0?"text-emerald-600 font-bold":"text-red-500 font-bold",children:A>0?`Berlaku: ${A}s`:"Kadaluarsa"}),A===0&&e.jsx("button",{onClick:()=>me&&_(me),className:"text-slate-500 underline hover:text-emerald-600",children:"Kirim Ulang"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{b(!1),f(""),ne(null)},className:"flex-1 py-3 bg-slate-100 hover:bg-slate-200 text-slate-600 rounded-xl font-bold text-sm transition-colors",children:"Batal"}),e.jsx("button",{onClick:ge,disabled:se||z.length!==6||A===0,className:"flex-1 py-3 bg-emerald-600 hover:bg-emerald-700 text-white rounded-xl font-bold text-sm shadow-lg transition-transform active:scale-95 disabled:opacity-50 disabled:cursor-not-allowed",children:"Verifikasi"})]})]}):J?e.jsx("div",{className:"space-y-5 animate-fade-in-fast",children:e.jsxs("form",{onSubmit:Ke,className:"space-y-5",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",id:"emailOrPhone",name:"emailOrPhone",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:v.emailOrPhone,onChange:m,required:!0}),e.jsx("label",{htmlFor:"emailOrPhone",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:"Email / Nomor Telepon"})]}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:l?"text":"password",id:"password",name:"password",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:v.password,onChange:m,required:!0}),e.jsx("label",{htmlFor:"password",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:i.password_label}),e.jsx("button",{type:"button",onClick:()=>d(!l),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-emerald-600 transition-colors",children:l?e.jsx(pe.eyeOff,{}):e.jsx(pe.eye,{})})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[re.length>0&&e.jsxs("button",{type:"button",onClick:()=>R(!0),className:"text-xs font-bold text-slate-500 hover:text-emerald-600 flex items-center gap-1",children:[e.jsx(pe.arrowLeft,{})," Pilih Akun Tersimpan"]}),e.jsx("button",{type:"button",onClick:()=>{W(!0),E("")},className:"text-xs font-bold text-emerald-600 hover:text-emerald-700 dark:text-emerald-400 ml-auto",children:i.forgot_password})]}),e.jsx("button",{type:"submit",disabled:se,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3.5 rounded-xl shadow-lg transition-transform active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed flex justify-center items-center",children:se?e.jsx(pe.spin,{}):i.btn_login})]})}):e.jsxs("form",{onSubmit:Fe,className:"space-y-4 animate-fade-in-fast",children:[e.jsx("div",{className:"relative w-full",children:e.jsxs("div",{className:"relative",children:[e.jsx("select",{name:"role",id:"role",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all appearance-none",value:g.role,onChange:a,children:D.map(c=>e.jsx("option",{value:c.id,disabled:c.disabled,children:c.label},c.id))}),e.jsx("label",{htmlFor:"role",className:"absolute left-4 top-2 text-xs font-bold text-emerald-600 dark:text-emerald-400 pointer-events-none",children:i.role_label})]})}),g.role==="employee"&&e.jsxs("div",{className:"bg-blue-50 dark:bg-blue-900/20 p-3 rounded-xl border border-blue-100 dark:border-blue-800 flex gap-3 items-start animate-fade-in-fast",children:[e.jsx("div",{className:"mt-0.5 text-blue-600 dark:text-blue-400",children:e.jsx(pe.info,{})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-bold text-blue-700 dark:text-blue-300",children:"Khusus Pegawai & Guru"}),e.jsxs("p",{className:"text-[10px] text-blue-600 dark:text-blue-400 leading-relaxed mt-0.5",children:["Pastikan data ",e.jsx("strong",{children:"NIP"})," dan ",e.jsx("strong",{children:"Email"})," Anda sudah didaftarkan oleh Administrator di database sekolah. Pendaftaran akan gagal jika data tidak cocok."]})]})]}),w.uniqueField&&e.jsxs("div",{className:"relative w-full animate-fade-in-fast",children:[e.jsx("input",{type:"text",id:"uniquecode",name:"uniquecode",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:g.uniquecode,onChange:a,required:!0}),e.jsxs("label",{htmlFor:"uniquecode",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:[w.uniqueField," ",e.jsx("span",{className:"text-red-500",children:"*"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",id:"regNama",name:"nama",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:g.nama,onChange:a,required:!0}),e.jsxs("label",{htmlFor:"regNama",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:[i.name_label," ",e.jsx("span",{className:"text-red-500",children:"*"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex relative",children:[e.jsx("div",{className:"flex items-center justify-center bg-slate-100 dark:bg-slate-800 border border-r-0 border-slate-300 dark:border-slate-700 rounded-l-xl px-3 text-slate-500 dark:text-slate-300 font-bold text-sm select-none pt-1",children:"+62"}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"tel",id:"telpon",name:"telpon",placeholder:" ",className:`peer w-full px-4 pt-6 pb-2 bg-slate-50 dark:bg-slate-800 border rounded-r-xl focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all ${fe?"border-slate-300 dark:border-slate-700 focus:border-emerald-500":"border-red-500 ring-red-200"} text-slate-900 dark:text-slate-100`,value:g.telpon,onChange:a,required:!0}),e.jsxs("label",{htmlFor:"telpon",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:[i.phone_label," ",e.jsx("span",{className:"text-red-500",children:"*"})]})]})]}),!fe&&e.jsx("p",{className:"text-xs text-red-500 mt-1 font-bold animate-fade-in-fast",children:ke||"Pastikan nomor anda benar!"})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex gap-2 relative items-start",children:[e.jsxs("div",{className:"relative flex-grow",children:[e.jsx("input",{type:"email",id:"regEmail",name:"email",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all disabled:opacity-70 disabled:cursor-not-allowed",value:g.email,onChange:a,disabled:u||X,required:!0}),e.jsxs("label",{htmlFor:"regEmail",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:[i.email_label," ",e.jsx("span",{className:"text-red-500",children:"*"})]})]}),e.jsx("div",{className:"flex-shrink-0 pt-1",children:X?e.jsx("div",{className:"h-10 w-10 bg-emerald-100 rounded-lg flex items-center justify-center text-emerald-600 animate-fade-in-zoom",children:e.jsx(pe.checkCircle,{})}):u?e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("span",{className:"text-xs font-bold text-red-500",children:[A,"s"]}),e.jsx("button",{type:"button",onClick:()=>{ae(!1),K(0),k(null),$(c=>({...c,otpInput:""}))},className:"text-[10px] text-slate-400 underline",children:"Ubah"})]}):e.jsx("button",{type:"button",onClick:y,disabled:se||!g.email,className:"h-10 px-3 bg-slate-800 hover:bg-slate-700 text-white rounded-lg text-xs font-bold transition-all disabled:opacity-50",children:se?e.jsx(pe.spin,{}):i.btn_otp})})]}),u&&!X&&e.jsxs("div",{className:"mt-3 animate-slide-in-up",children:[e.jsx("p",{className:"text-[10px] text-emerald-600 mb-1 font-bold",children:i.otp_sent_info}),e.jsx("input",{type:"text",name:"otpInput",value:g.otpInput,onChange:a,placeholder:"- - - - - -",className:"w-full text-center tracking-[1em] font-mono text-xl py-2 border-b-2 border-emerald-500 outline-none bg-transparent",maxLength:6})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",id:"regPassword",name:"password",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:g.password,onChange:a,required:!0}),e.jsxs("label",{htmlFor:"regPassword",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:[i.password_label," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("button",{type:"button",onClick:()=>d(!l),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-emerald-600 transition-colors",children:l?e.jsx(pe.eyeOff,{}):e.jsx(pe.eye,{})})]}),e.jsxs("div",{className:"relative w-full",children:[e.jsx("input",{type:"text",id:"confirmPassword",name:"confirmPassword",placeholder:" ",className:"peer w-full px-4 pt-6 pb-2 rounded-xl border border-slate-300 dark:border-slate-700 bg-slate-50 dark:bg-slate-800 text-slate-900 dark:text-slate-100 focus:border-emerald-500 focus:ring-2 focus:ring-emerald-400/40 outline-none transition-all",value:g.confirmPassword,onChange:a,required:!0}),e.jsxs("label",{htmlFor:"confirmPassword",className:"absolute left-4 top-2 text-slate-500 dark:text-slate-400 text-xs font-bold pointer-events-none transition-all duration-200 peer-placeholder-shown:top-4 peer-placeholder-shown:text-base peer-placeholder-shown:font-normal peer-focus:top-2 peer-focus:text-xs peer-focus:text-emerald-500 peer-focus:font-bold",children:[i.confirm_password," ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("button",{type:"button",onClick:()=>L(!o),className:"absolute right-4 top-1/2 -translate-y-1/2 text-slate-400 hover:text-emerald-600 transition-colors",children:o?e.jsx(pe.eyeOff,{}):e.jsx(pe.eye,{})})]})]}),e.jsxs("div",{className:"bg-slate-50 dark:bg-slate-800/50 p-3 rounded-xl border border-slate-100 dark:border-slate-700 animate-fade-in-fast",children:[e.jsx("p",{className:"text-[10px] font-bold text-slate-400 uppercase tracking-wider mb-2",children:"Ketentuan Password:"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-y-1.5 gap-x-4",children:[{valid:B.hasMinLength,label:"Minimal 8 Karakter"},{valid:B.hasUpper,label:"Huruf Besar (A-Z)"},{valid:B.hasLower,label:"Huruf Kecil (a-z)"},{valid:B.hasNumber,label:"Harus ada Angka (0-9)"},{valid:B.hasSpecial,label:"Harus ada Karakter (!@#)"}].map((c,S)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:`w-4 h-4 rounded-full flex items-center justify-center border transition-colors ${c.valid?"bg-emerald-500 border-emerald-500 text-white":"bg-white dark:bg-slate-700 border-slate-300 dark:border-slate-600 text-slate-300"}`,children:c.valid&&e.jsx(pe.checkSmall,{})}),e.jsx("span",{className:`text-[10px] font-medium transition-colors ${c.valid?"text-emerald-700 dark:text-emerald-400":"text-slate-500 dark:text-slate-400"}`,children:c.label})]},S))})]}),e.jsxs("div",{className:"flex items-center gap-2 pt-2",children:[e.jsx("input",{type:"checkbox",id:"terms",checked:te,onChange:c=>he(c.target.checked),className:"w-4 h-4 text-emerald-600 rounded focus:ring-emerald-500 border-gray-300"}),e.jsxs("label",{htmlFor:"terms",className:"text-xs text-slate-600 dark:text-slate-300 select-none cursor-pointer",children:[i.agree_terms," ",e.jsx("a",{href:"#",className:"text-emerald-600 font-bold hover:underline",children:"Ketentuan Layanan"})]})]}),e.jsx("button",{type:"submit",disabled:se||!ee||!X||!te,className:"w-full bg-emerald-600 hover:bg-emerald-700 text-white font-bold py-3.5 rounded-xl shadow-lg transition-transform active:scale-95 disabled:opacity-70 disabled:cursor-not-allowed flex justify-center items-center",children:se?e.jsx(pe.spin,{}):i.btn_register})]})]})})})]})]})})};export{va as default};
